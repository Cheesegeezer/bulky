define(["loading", "dialogHelper", "mainTabsManager", "formDialogStyle", "emby-checkbox", "emby-select", "emby-toggle", "emby-collapse"],
    function (loading, dialogHelper, mainTabsManager) {

        const pluginId = "8A1C97CB-AF56-47FE-AC00-188D3776F9E4";




        //---------------------------------------------------------------------
        //
        //base64 Images
        //
        //const fnfLink = "data:image/png;base64,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sUbd008/Xd17SPGJ8QbfyZMnm9dff93cdttttba4JRe8DzjgAPXVacccc0zFf/PNNxfKV+bKtRJ9Ut/HA1Tyye6/KbgTf9CPmrgDtKd523Y+v7XWWsvsvvvu0X733XefOemkk/r90R4XcrqECdT9fZoCTJkypdEe9NRTT5mHHnoo2Cck63777We22WabqJy4rPPII49s8PH5W97LLLOMWXHFFc1SSy1llltuObPooovW2j377LPmpZdeqm7QBdnLRl2e66+/vjn00EOD8rzyyivVLb6WfP4p+eplmAv1v224n0m2CfVpyiPj4X4fH1bHUg3h8uD15QKACyp/8uEm2C233LJ6g84333xm3nnnrcovvfRS89BDD5vXX3+t1v+oo44ys8wyS63sX//1X/t9Tj75lJqcX/jCF6qbbX36+c9/XgGkK0/42dw/wLXXXlu9xQGs0047rdZun332MQ8//HCQT2hirLHGGuaII46oPcfbb79tnnnmmf53AAiT2morCxSXJ7TWZZddZhZYYIHqxeHSPPPMU31SzxSTLwQSY/Lb0GM3eTTl90HU/T4+0lypIfy+nH5yrcIFymGHHVb9+8tf/rLZdtttq39j8l511a8bcm200UZm00037YPC9CYXgIM7yU3/R+t2/N73vmcOPvjgGkjOPffcflv32WLaBOUAAD7f/OY3q/Hcyb3BBhv0ABLm44LQB8fdd99tTjjhhEpbWEL/1Vdf3eyyyy4VUGK/36OPPlp9oEl8gHz729+u/Q0+97nP9bWIBiQarRGWW68leiUeiLrfW96TPlqddd44vkYZ8O0CDZrJpdlnn6Mqj/WJlUPLrbLKKuaqq66q1WPS++1Dz4JJ74IDZhlMJBcctj/8kP3337/SsDFK/ba/+93vqs91111nrrvudxWoU8Rx0jWRrRJ9ON+HuCdd0r7sGgg1jqWQybTFFlsE+2288cZ9s83SiiuuoArhfvazn63s+osuuqhWgzczwJN6HoDo3/7t3/rg+K//+q9K64XaumX/8R//EeUZKwvJjvG+853vZPMqE9nShHbTPIuciyXVFMNeA+H1hwaYvVG36qqrVra4T9Zkc9+gA40iC9XCtLv11lvNX/7yF3PXXXfV6qZNm5Z8HoRYLTiuueYac95555HPbsvgsKfahchvd/vtt1eahB4z/gwl25QAkUuMc7FE/Fo3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";
        const fnfImage = "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAMgAAAEsCAYAAACG+vy+AAAgAElEQVR4nO1dB7RkRdHufTwks8iSMyhhyVmWnDMIIhkkC0iS6JJ+EFGiCOoRE6BESR4UBCMKLIqCgggCElQUEFhQsgSZ/3x3pmf69u1QVd13Zh7cOufBTnd1dd2Z/m6FTuN22WWXliLSuHHjqKxkSpPZbssVwe2Typ+Pb1z0mWIyUurDbUO6+ev8Mn1tuLJ4cnz62OWjbhXc1GqFsSQZ7C6ZdDmtjoxS6+jgsvuM9Wfyh3j5fD5dW8YzuXlifVHruXU93Vx6+ev8MtttfOV+WXa5j98t36ePLXu03djxPQgoBCAOeFJBUydgJGBJAYLJ4+svPKDlYAg/a16gSAFELacCwpY9Wh1QLpK5Mi4FbaIOfDlo0gBDB0GIlweEuNVIsyp5LU4KUNIBxBv4cUDYvEQXy+XKmCQHUIq1kLXlASa/dTEsAr43kdVIsyr1uF9xoKS7UbKBz3O7yrysGMRPIQDF39g25QQNFzD9jEda+N6IAz3VqtTlfvEHPaeNrJzndoVljMYCb/cDccjnwvGAIwVNSkDOsS7JYGEE7hKrUlfQXgdQBhVvuHhJFqSO7FUO4PCtBbcN3bpwwZISr9RpVfoPlH7HITxrksXFypW96khzAIcGmlTA5LIuPItBjFdEsUgoLhgWoPQnDqGBqsobcLHkgbdLkYp0luBqYE3RLc294liX+sHS6iHBGdeHrQbN/eonUHLFIWnxRrs8BJ6ABYllrtTAslfDNkFYB1i8/bVaqguFobca7gEYbjOoeCMpzeuj4cleDcsEYS6wpAf21KDdHwO42kqAkrNN3YCopHnrc7H8QThHrhw0/ZkgzAkWuQvme+tS5MssTj1A6We8QUzzVjQ1GBXBxeIDyCdXnr1SJNDUM0FIt0L0yT0KT0oqlzvrHeo3L1Byxht9TPP6KbRMhQseefZKCeKLgU4QBgcqTQ7d6nDBMDxAGYo0b54sk4tyTBD2L+VLTeHavHXPecTkUN2vYQFKDgDlc7vivF4LEprbcClNp1Tg8GMLxQYMbeDacuud86BbDf6cCaUuD1DkAKp/WYmLV+xi5QeQ1FqkA4YOlpzuldwFy+V+SdKvIZ3yWYfBxBsuXoeLNa7TYeVZWQS52267rZowYUKaoChJEgUNvVfo7bffLp7knnvuUc8++1xW90q5XaxY9ooOoNlnn13NOOOMzWBsqDaafvrpC9FvvfVWdvdKyZa7xwGkhaPz9GC/oYYCo9G7VCRPsD6qGVQGt8oU3lBDg6W0RYqad1QzqKBVUB0QuQOxhhoaBvJbE/fgJy01oT+XBpEPRTmtUEMN8UiPS05Wi2JNRmLpWjq1OsJ7fw01NChqj0O7c/e49JUVaV4fg00FonrhSkMNjQGiB+bepSbUh+yCyOthuTfyNNRQvyh90rBaNpLPwyq7V42L1VA/yRxv7rHHd69UO0iPpWWb4LuhsUe5gnWCi5VvZp1C//vf/xrr8z4mDNJppplG9AX4UrecdV2EpSZstTrC0yWBPvCBDxRKNiB5/9HIyEjxgnz33XfFz86dC4kF69GD4/o1MYgvZnR0VJ133nkEbv4CRc5zUHlpfHFdY3LqrPfX+fWWyKOWL7TQQmrdddctrAjnNzOHMWdyMBasRy1IvwDkWy7t4WbtBlTWc+TaPMXd55F+EJxkK23+5e35N0X1+njyySeF3oM72E6dWU92sXLtSNRuFWdnn08HHgDybJ7KsykqddNUHUf+8IES78d/9tUss8zseC4a1bLUJLR0ZJySTwzmiSH6sXsw/gZ265PrsLg6DqUedqD4dwOmEh8Q4bmQ4KkmrYDOg1m0ODy7B3Md6ZNqVWhA4bflD+68229TKZc1qWfLbcKsOu9L699hcWHevEf6pLz5Y/W56qRxSKxc6nlo99yUn8Oa1LPl1jgeUy6iKiEOmvoOi6Py5uGRn4qoagCDigxuVxtpeSpR50Ko4Kl1y21u4sYWKYfFUcFCs0Dppyr2L9bIGXwPzr2yZXOtCSEG8XbfEeKqSz9AwfdF+3mN3lmAyXv2VZgv3QULg21YgCIL5MsDuaq/lFKsiS4bpbzl6JRru63jza/iGTV5+lZlSOHmiTNUZNDSDnsbdBwSDuTDcvLFID4dOdbEsCCURYuD2nJbzaj5L8A0WokBkxMsPlm55jz6AwblGUChNoOIQ0KuHte9Urm33ObATot4b7t5AaYi+rKydG/dk4P0oNsnoy4wuOrkAOLNyKcRfTFizMKM+h6KTzW6VzXEI4MAS2r2SvUZDEowuKXxSTfNW9FATi7ducE6b8vtQCgHYPJcdcCeHAy4gdTsVdqcCH8dlbuu/ln0rs7Ct2yru0yJfh4WMwaJK+Cj/oJHAhirTWQik+s6eQcx6x70/KnclAWH7rp8QOFkK3mUz71SefaD5AmufLJyz3V0OumZ8sxgkQOhvqC8LqBw4xCOnFTyu1e8AJ62H6QVT7HWRRxXqfNoPMCYl2JGMmP9SeOm1dcFlH5kr8YVK7odahOpmuChHczge8YWZbl7zzes1vUfPNVEANfCBFOzZmaMaFmSXDBidir3BGB/lrBLgSKPQVKP+XHpleRiRcGTIJPanmthyPyl9WS5Ur11TA7Kg/I4UDjyaFkqSnkqtTqmxIKJyJrUdsttalzias+PR/KkcPOleulWRZYGlrlQof0ZfHmSi25qiEM6Lzhp9qobgwR60P04KA08UuIH8LSYoMNZC1ikVoXqfg139oq/JivlxerNVFnWhONyCV2sMHhSgOM2jwFes2eytWjz7rDDDmrRRRft/jC6/YMPPqhuvvlmzUkCiy/A51iV3JODg89e8dyuVHB49XBaE5rLVcN+kAwz6tZ+Ekk84msz66yzqr333lu99tprxRFD77zzTpdfTzbNM8886qCDDip4LrvsMprFYMx51Dk5mB8o9U8O5navYlaKUzbiEN95IN9f1mchkUuXGLn4J06cqPbff3/16quvqtlmm03NNNNMxfEy+MOZTPg/jh7C1XEzzDBD0e64444rfTc9mX4Fun16eOLPEe4j1DYs2y9X3oYuK8RfB/l0sH8Xl166zAGQGPmBk+M5qTI4YAHNP//8ar311ivO3wIAguneVqsAzNxzz61efvlldfTRR7u4ov23KDwkoITBwJedEyhh/XxyfP2mjKGQXEsDB6+7bCTf4K5aHqkcG3jRFjZYHTy77767mm666Qq3ikOwMv/+97/VoYceSug/rmPMqkTbC9t6agQywwM8tTx1uWJID0nZSE+pkFs1GNdK68bWw9J9xx13VFOnTlXTTjutCLgf/OAHi3hk+eWXj7SP6xmzKrEXzCDqOHrkcru4VLESHEAEXC6GizUs4OH3vcgiixTBeQrNMsssaqONNmprQOq7XqsS0iE3iOJtKqVZ3K5UcrpXTJdrtEXcoBSmfCApK5q+9gqB+YsvvljEHSmkTxyHm/bmm286+o7vHIyu+vWkt/V3kjNDtfXWWxf1OAv3wgsvdLTr/+Rgmmse1lua0RqhuFZjyr2y3JylllqqGNSphC8OAf4qq6wS7Teum6/aH0MpckAfbzfvvPOqBRdcUC288MJFOT6nyKOVu+XkpwwxiFFMcLFC8UkNzxfRhdd/q3CtuIG5iwAQWA6kh2NAiOsXAVNCHEIZ2DvvvHPxLEhpv/XWW2rNNdcM6CuNT2hyUq2GTxeXDhKXK3E/iO9Llc+m+8wkpf86Fr6ZFJr5TZ0l79fk4BZbbFG4nBro008/fRFfhdqE+pK5XfQFjRyqyvDrQC0bqce1Sn0ryKyVi/+ll14q3pKpBJmwRP/5z3+Cfcd1iz1zuL3L/6JYFNVxrRZbbLFSwgLzPa+88ko3AWG3cfdF14FrTVIp2b2yKOBihV0r6oDNR2UdCL0XfE888YQRVMup1Zk8fOSRR4hAiLlAsvpumjjQt0+vXXfdtfgu8Bya9FtziSWWYMgLu3E+frd8SnsecfqKuVyCmXQVAE96QE9tT7Uu9913X+FOIMBOIVwLBp/9+eefL/VP0bGWeqZF2XbbbYu5IEx82jTjjDMWVpYf80iCdXc6NZUosYUkgK+6WEolTGaWgSOVwXWtYm2eeuqpwtVKISw5mTJlSrVnglWL8VDrPU8edXsmTJhQpHPHjx/vlKGtyG677UbS013O46fK4FBu96rwGhylpdle+8cb/syV3UapK664opgHefvtt0WBIBY3zjHHHAVA0twrqlWRtPW7XnvttVfFtbIJizPnmmsuUl8ca+Lj97/hvSqSKAWQLp1YLla7sR88/SEuYNp811xzTTHQARIOYYkJXJAzzjij8kWG+k4DCjFgd1eW6rbcckv1wgsvOF0rk/DiwPez8cYbk/rKWW4/eyq5dJO6XCO5Bncu0KS6Vz56/PHH1V133VUMBCw+pOiBgTXzzDOrc845J9p37Hlk9TTXzFeHrNWHPvQhr2tlEr4X/C299NJeeRwdQm4X5zlSKIfLRTpZse75BT/ZX3LaoQwI2BGP7LPPPsVcAGbYMQ9gPh/av/HGG91/m5aDth899QQT/pyHrw4Tgq+//nrUemiCmwV+n7yYDrmWoEhIgyzHJimzjDRRGFK8v+DhAsbkb/MiC3X22WcXJQAK3q5mhgvPCp6rr76aJC/Ek7qzMAUocK0wZ4OVyFTSMpEOvuqqqzrycu1Dr2dy0P0dxI/z8ZdZt9zmUahKqcf+8Bcq8sFyySWXROQT96PXMEseqw/VIWu1+OKLi34DWBG4lUZPrH3lPqtBtSZ5XC1/X/GyctvATHqaX5j+oLJgnMafly/OI48lYvWuuj333FP997//DWatfIQ2CNaxJMX1DFTdcsQmqZQjBol+g7mBI6e0VG9OvhQeymCXBuX422STTYs5H2rc4SK8PTGznmOAu8upGS06cQDJAUn2a6D7E5NYDx09JojqitH4KG6gzXPSSScVy14wYXfmmWcmuV++OszVLL30RJHlMAlpbaS3dV917v/IfcK7u6+qvtS4xOFipU0GploZkaVitclpWWg8O+20k3ruueeKPRhIMbtPSvE9Gt2iUCYEOQR5IR0k5a7vxyzP5Z3kcK8U/9ifNPBISAKYEn/f3atyKd7qCyywQHcuAuvC8HaePHkyqb39TL66rbbaqshapbhWJiFYx+oDcy9NjriCKyOF+hKDWM084OkfcLiAaQ04IMdpKlgIqLfsgpAlqloSu324f5Own2PJJZdM3ndvEqwQgGzPrCvPgJIE8S4ZKeSLN+y+OHHJSJ5B7gaOSFKKtSDo2eUn8qXwYI8Fsknw6W0+WBIE08cff3xwJx/FvTrwwAOLyU0ThDkIvjj29OewBHVbjZ58KiB9wCmXjZgNhsm1UkpgLTj8RL4Uq7LaaqsVb3df4gIgwYz+UUcdKXavNthgg6yulUkANjZTdXXw6OYoZYBqzMUgzu6C4OkXpQCGypcakGsenP8LNwpncYUIIMHyjhNOOIHtXiG+WWmllbK6VjYB3DiutaNAzdYk1cWi9cMpy5DuyAscTts6wJLDvcJJKhi8et93jMCHhZG9I05pQNljjz0KFy63a2US1qrZB19wBn7dhzXE+nLp6urbx1fbTHpawMUHW62WhSSrV4ZFggjMOXNCWDOFGWxqCnjzzTcvgug6XCuTEKzDhcszs16VX4dLRYk3/HzlkjEyky4HC8e9CjCRrQoGLuY8JAMXIEHgfvjhhztl6+4R1yy33HK1ulYmwXpgbRcXEFWK8w4+BinrKHaxBgec+qwLi8chCgN2xRVXTBq4AAkm+0Ip4IMPPriIW+p0rUxCsI5kgsoUV1DdnlTy9UPVXQ3/TDqpRXawkHgccQhmnmEBUgeutiRHHHFE5ZmQOobLU15xWz/BinSD9UxzHvUAgprOjevYcu5JH6p0L9da8KxZLhcMdTiSFPtKEHDnIIAEAfjkyZ/pPjsC/5VXXrlvrpVJOljvHTKXz5rkJokr5dMx20x6f4jXL2VwH3DAAd1rDVJcMBwGjbd6zsWaAAmsBVyq6ab7QBH81zEhSCEE67BqG264ocWdbk3M3zIl+0nph1s2QhkYBPWygKZtoTj6pIHl5JNPLt6I2H2HST0fX0zWvvvuW+xCjM15SAgggY7HHHNMEfj327UyCf2HZ9arbejg0WXysZiSzvXpPVJumDPwlrQrZzN4OvDAghW2mMjTM91YcwRLYvNRrArcKsrBCFKCxZAeWZST8ALAi2DZZZdlxRUtT6o8v3tFtVpJMYij2+zg4ROv3zgv3oQY1KjHiYkYfFgRu+aaawWf3yZkm1Bet9sD+YMGiOoE6+uss07x75AbVR2TYyUGKXMlz6TnBg21Oac/mxdXsiFtaQ5qDZJJk9boulshWaBNNtmke2pIP18WgyQE60j72sF6lbgxSOq4yRWDlEESPN09RdkU14yrBxcssB7mD6wJIMEAwG2466+/fjQOWX311Z1y3sukg/XNNtvM+Ru4fxv37+XmTYlB0uINo6Qagzi6C7hW4mcQUF6wIBOE2ANgcBGsCtwIpG3XWmstb98HHXRQYT3qCMyHnWAxQzPrVRqke0VL5ybFIA41nKCpHzjpaV6cHBgLqLUlmTRpUmFJ7L5VZ5C8n1wrk3SwjjkZjiUgxyuJJHWvnDFIvvihOkciklJjmheZK6yapQTU4AFIVl111cKSmHTaaad1j+p8vxKs7BprrBH8zeiAyJ/wyRaDuBr4/vpJfODGwYLYgzMLrUFiWhK4aFiMiED1/Uz4XrBvHbP75tjxjSfXb0XjpZEcEOIYpEqDBA6vzypYYrGHjzRI1l577eL+jGWWWSbbcpKxTAjWcWcKdjSWvnnPb9OPGMQXW6QE76Ot4mSidMVskh89Sru33ewz3Ff7y8DAfuedd0Q6ASTob7755ism7HIdqzPWCTEYjjm1Sf821KM/6zgbi3bEaPUM3+o96QGXKmfKjdGSnTGjZK6osYeP8MVhQDTg6BGCdVzrFgrWXWXDE4PEs1niDVP9C0l4gPVlrgaxAvb9QFgbppMYg41B3GuxXH3Eykw9El6HwxCLxHl32WUXUezREI30vJEO1n2/S/0xiM6iOvpIAE7WDVM5AJM7c4XYo86FhO930jPrm266aeV3sSm31XCTw20iuFK+MvaGqX5SKlhgPVJjj4biBDdr4YUXrv4iiZOIKUR3pcI87A1TgwIOzzq1eZrYoz+kg/WPfOQjrHVXlLIUogfqfp6RPEtE8oHG5TP6+EJgwTViTezRP4IVAUBcA04lTuRRKA2IbpCgbCTsUqVYh4QUMfkM3Q6/AyzY1NPEHv0juLGwJPPPP/9AYxCXPIor5daZtFhxwPEIM/DXmasm9ugv6Zn13uJO/lL3nMR1pXxlCf6HCyR5Z0SdvZY6dfeHzJV5c21D/SHsjanOrLc6qyOos+r5qNoHbfbcLBv1KSVbKpJuWXr6MG+57VzDhtgDuwVx+Uu/5mYaahMs9jPPPFNsyb3jjjvKv5RvIOJXc1zZLCGfPNJ1bNY1frqd14LkBY7ocUtgi/bbiVeuvPJKdeKJJzYWZACE3wiThrfffnvROWXdFX612A2TFNLjtZDXioHEUeZYBNiSXOI5KOBQXCtN9tsrRjLdue4kj5+qU04+miz6c7gA4XNzOM8S7RevSqYr5dNjVI+7VN1s4NS7mte0LtUfTL/BbMo1SGI84frwAPO39bfzteGW+/rgyXEBIn7rrKph6YnLlaLGQrqstjSv/GG5y1V4a7NiqWNK32n1YV0l7cLlnNRqiJ+q66DWYvEXIlLaDX2al9cnkdcEQYCPCoTQYJcP+HC7HPKC5cR+3X1y50HCPBzi9Evhybqat37Q5AdLdyFbAlAoVoE/4MPt/P2F25DLg6Ci9ZnankNm+5wgGdo0b7z/cBzi4/XJbQd2YXnmd+WWo/sJt3e1ldX5+3MHyH5ZLl/cL4c7t0Fvn4tc/VJiEPuz14IM0q1y9R/h5schQT6C5UmMM+RWgx47cK2JJDZxy5C3TyF3vzSdfZ8zrObN+oz+nnPHIY4LcCQ89QLF347TRhKbUPvN4XJR+qaRq980kIykD3J3EF8fySxLkIsSqwxl5qr/1qSOGCTHizYc6Ff1azniThfPiCkgp1slBQm370G5Vt4h3dfMVcyaUAc415rkcLloMukUt0QVAKg4SIRpXpe/VwdxwEK1LJl4MqR4ue0k4OK88VVwkOeOQer2NOggCblg4rN5q8CpGzRSyxJ3i0gWw8sjtyiyunxuV0iOT1+nDEZ/1L4k5Hp+Wp9+kGQ8tKEKGlbrDj+trQQsNHlxHm8nYouSAhRfG78smhyWy8W0MKEyHACRSjlBMjSHNiD3bF4lIHOtqHwpVqVui+Jvx2lTpzVJdblCZTg/WTIHF3KTQrpZJZWYhLma1/Ul5tkkpe/hO/fcc4svqG7/tKHhI+xKfPfdd4W/vRsA3MWK9vL7zkx6u0A20POCBvs4XA/S0HufcHYyfnfp8a4kAHQGawg4BU9nA1XHgmj/39WtZLDL3bHm7NuGUogCEtUZ68FlKHD5ANa4Lv2NRRpqKJUKCxCJSbyTh+WCvFewNdTQoKgytj0xSazM/lxZzSv3/RuQNDRIaomCchVxt8hXsDXU0Fgg+RyIux05zesDSZNtamjYKKclGUk1Do2laWgYKZclGfXHDrK5jAYkDQ2C9BKpUOqWaklMCmSx+r/cpKGG5NRyJopclqRiNwLWRpDmbUDT0DBTHCSKAZKRPPFDA5iGholoILHJBZJRu8BF/ExVA5KGBk2t6EnulJiE5GI18yINjQVyZ6WsEmZ2S7wysAFNQ8NEevzlBonn4LgmxdvQ2KWq60R0txx3i3gsiDtT1Yz/hsYKiSyJY4Ejw8VybcVtxktDw0PRzJXA3UpcahKeE2lcrob6S4T0LhMk2ZeaNCnehgZBvUEdjzfa3hDtEOvAat7cwGmooX4RHQBlHsdqXr7GTRzS0PCTZPegyyiMpA/0Zj6koeEgyRL3GEhGfRU94rtUDUgaGhRJXSlfjNKcatLQe4LMl7LElfKu5pV9OQ1gGhpuypXudS41SV+922S6Gho00dK9MR6nBUl3qZpgvaH+k8RKuM/07f2b6GI1RwE1NDYoz2reXpukg3AbwDQ0jJQLJKre5e5NENJQ/8g14OPLS+KnoLCWu/OosSgNDZZypHtZy92b+ZCGhplyLS8pBelpG6EawDQ0XOQMGdiZrN5YHvVfntPfi3MaaigXVWKJ4u5B7gkn7ZiFebJi8xs2NJyUc3mJ+ZmZ5m1A09DYIe6koHJvuc293L0ZQQ0NhuoI0iPL3SW33zYgaWhw5F7eTos3zM96jVbExWpOMmlo7BFlVQd1Jr3ZctvQe5Jy7C5stW+YMga76JtqANPQ4Mk19kggsT9bPKNWrRMkvP0hDUgaGhQRjxgtM7TjD6tIs4hOd2+WWTU0vCRwpQIz6aLl7i3LrWqooWGinEG6Y7l7+ikm2oQ98sgjauGFFx5zg6e52tpNw/i9vPnmm4Ve0003Xak8ntqN8xSfF198cYIJkO8x53+p1L4ofHGesH7h9qG2vrp8bdy6pfLSdXDJrJbR+qC0y8MT+2zLEG65pbVSol2HVF4KX1zfsIxwe0ldqD9euVuOu18/r1wHXz+SPmh7x2U8YblOGcanvh/7wwELVX6/gJKzLlTuAxZdDl0GHWRjByTcNhUZxufyPIg46JYBht4njS/efxpQ0uo48kLWoR6rQRno7vb9B0lMTo42+jPx2B8uaORgofKFWfMAJawDty6Xa1WP1XDrNxiQxHgocihtKDLILpYcMDyw5LUqaUCpw+3iWhOey5VqNaiDv+rb+0BC1SUHD1cuRYb4hikZYGRgSeejAUWiR3+sCX3g+8rrcaMkLpIcJJI23PjD/jySaxNUnWChyk4FSqy9v15uTVLLQ5bHrQulzAeSXHFETgDE44+qPnQZtRz7w7cudN6cQJG2D1sT/qDnulxU+XSrwXPN4mUykMh5Yn3J45yEY38YLWtM7QZhILYIZj2/Ld8d48kKgcotm9bf2AVJvC+JC6fSbrmVBe30NkQ+gry0+hRrwpPHK091rXIDQpaRcpXlsRJ8kLg+1xKDUNvXZVXS6vmy/XXSbJa73CeHxtsPq0EZyLL4QzTh55Qb+1wuIMYg0X4D7Qncma1KDosRBoq/jteGByyf3jl45WVx3clWow9WgjvTLr7+gE4ysOTgowEl/MzcuvpdK95buR9uFMXikUAinCSstuHK8MvMNA9CbsV2l1JBEOdJsxg5wZDqcnF585XRX37VMr5elAHPBYnvc6YYRGJd+JmtHDwxfXLWhVwiP7Do5X73jMZbN0hytov1z7EKvTaxz+TrD6J9VQRL3CqqVUnh6dYHrQJvwKvgoOcFzZK4xM0b12PVVVfNApL111/f2y8VJDEeifXhg6jax7hFF11U4GRJN1DR21E3WsX40ur9+ubcLIXyOeecU6244oqVuieffFL95S9/icrxyYbcFVZYQb388svq7rvvLvH++Mc/LmQffvjhZJl22Re+8IVC/tZbb83UT7a5Kr7hid8m9Hm0Zd2yQyP7TUEd+L12sYHbQ3tYtuaz5a255ppqv/3287Z74IEH1Pnnn99tD/7x48eXeDCA2t9PVYE11lijwg/6+9//rh5++GFnG5euhx56qPrYxz7m1fPOO+9Up5xySkWOa/soaIklllDLLrus+vCHP6wmTpyoFlhggRLfP//5TzV16lT1t7/9rfj8+uuvV2RuuOGG6thjj3Xq8+KLL6oXXnih+9mWH9KPe8Os6lgJ3qnsVeLKMD+Pus0x10KYMmhtqQCggsoefL/+9a/VtttuW7xB55hjDjVhwoSi/Prrr1cPP/yIevnll0rtTz31VDXDDDOUyk444YRumwsu+HJJz3322UctueSSFT2+//3vFwBp6+N+NvMH+NnPfla8xQGsCy+8sAp94BIAAB4ZSURBVMT3qU99qtjX75LjGhirr766Oumkk0rP8cYbb6h//OMf3c8AEAa1tlYaKKZMWK0bbrhBzTXXXMWLw6TZZ5+9+As9k08/F0iq16LxeeJ9V2VU9bdB1P486mEXWgi7LaUd36pQgTJ58uTi30ceeaTaYYcdin9j8N5yy48rem266aZqiy226IJCdQYXgPOb3/ymI7vX93nnnaeOOuqoEki++93vdnnNZ/NZE5QDAPj73Oc+V/RnDu6NN964AxC3HBOENjjuu+8+dfbZZxfWQhPar7baauoTn/hEARTf9/fYY48Vf7AkNkDOOeec0m+wyy67dK2IBCQSq+HWW24lOiWV83kj94OUuhcG7cMarNP6sS1KT24baLBMJs088yxFua+NrxxWbuWVV1a33HJLqR6D3uZ3PQsGvQkOuGVwkUxw6PaIQw477LDCwvoo9N3+8pe/LP5uvfVWdeutvyxAHSJKkC7JbOVoQ/ncxz3pHP68cyCxfjS5XKZtttnG2W6zzTbrum2all12GVEKd+eddy78+quvvrpUgzczwBN6HoDo5JNP7oLjsssuK6yei9cs++xnP+uV6Stz6Y7+zj333GRZeTJbktRuWKZjT3q0D1e3YrBEOTOlduPtYQFmrtStssoqhS9uk3bZzDdoz6LwUrVw7X73u9+p559/Xt17772lui233DL4PEixanD89Kc/VZdeemn02XUZAvYQn4tsvnvuuaewJPE+/c+QkycHiExyWJCck4YEbvbMepwnRC4rofVeZJFFin/95Cc/6ZZi8MGKmHInTZrUlXPzzTd3y2FRTDD5dDHLEeyjDwTrKP/Tn/5U4l1uueWCg3zppZfuls0000zkNzjKkOUzEwPVweVUv8uHl8fuu+9OetvT5khoPDHK6WoRXKwUwOR3qyjxgy3Htgy+fjDoYRGQtTIJwarZTrtdeNvjzW/SSiut5OjLp6NSW221VfEm17HLj370o4o8uFm+QW6mWbU7xgFJuKxa/+Uvf7n4u+CCC4qExqKLLsqQL+UJy60TRMn3g0jaRTlJoKICRXV/RFe9Jp2tQYrzz3/+cyd71KYFF1ywW4+5hbXXXrv499e//nUra+WzUO7n3nHHjxdWByleZNHwh/SrPTEIENn6gjbZZJPgs+cs07T44ot3/2D5nnvuOVafMp78ATgVRMln85bb1zUHEuKL8dCCeIAAhDgAhIFvDnZYDWR+kCIFTZkypQCSnX6ce+65C5mh1K4mPcDx5tcxjamLJrhZPhmxZ9O8SOsibfzqq6+qp59+usPR+87wYnj00Ucr34tJqMesO2Ktgw8+uHhpvPbaa8FndJW5eWKp3RZhLoOX2o3r1XLNgwzjHAgdKNIDluedd97i/88++2zx/29/+9tFdkkHwPC3YT3wf7hhOhi2B5I+rLtd7p/gQxYMgxbu1Sc/+cmiztQdsY3uW7tZGrwSkMw222yFJQXo7fQ1LBZSwmZmyycLjwXe+++/vwBID2zVPil6GSWOCcHBzqKremMQnhuW162iWQ2T9FvanMe47bbbuv/GoNLpVAzehx56qFtnLr0ov/398cfmm29e/NuMYUy9/vCHP5TaaDfL5EVgbxL6dk0Aghf9YG4EqwtswnIXpIZpv1X7mWBBDzvs8GI+xO02VXXg86S7VtyslU2JMQixBStm6Q9Q7PYLLbRQ8f+XXnqp29YO1jEAYT2uvPLKUrk9IYcsl62rSUsttVQ3mEdq1qUXZsJNMt0sk9cEJ8D76U9/mhx/qI71oPBZ0tTUqS+oxx4LuWTUrBV/gOeOR0KfrXmQii4R4gfs9L4ocmlAibVHqtSchdZkB+uq4/rADQuJNVOvLj323HPP4v9YI2VaIlOva6+9rjTHot0sm771rW+VSmBBYBE4IJHxtXkOPPDAIqvlbifTQZTqjYImVk/KYqXNgcgsBT2rFZfFUrdLev7DfBtrMrNUqP/Sl75U6tNF88wzj/c5ME+is2DavXLLaTndLJsXFsi2Qttvv30R9FNBQnF/fM+DPSXlBY/8/rJYjagrJRscnsWKRrfCgJ2eqerxpi9WlAXqOltlu0qq84bWwfqNN97o1AkDxMx4AXA+XbG4T5M5sF0BJ9ystdZaq/tZu1k270UXXVRMEpq8WAmMxIO2gOCfZZZZuskI13NUg+YyIXt10EEHGW7ZuGIeBrPpZjvKMvZY/3UE8ZLPEYBUHoO9rJ3ThgqqGFBo9e0+sCJ3gw02KMoRh1x88cXFwP3e977X5UewjgWBAIstE4sE8RY1CXLgdjzxxBPFnhPdBlkwvXQE7pW9sNHOfJnL1FXHzfr4xz+ubr/99mL+QctFdgsJhL333lvtuOOOXXcRliRGDz74YKl/yEQKFxkvezEmlrlvt912UZmSJepKMOCdqV+rKBUko9S3d5XSwJKe1vWnUjUhfYq3pvlDAwx4E2NJBzZE4d+wHKb1QBvzi0Kw/vvf/97os60/1lBhINntQTPOOGOxcQmgQJyB4Nme69h3330LQFaffZyaOHEpdeaZZ1ae6ZBDDinmT+D72z/md77znaIvgNmkxRZbrNDHJAADcyJ33XVX5TuFhcBfbEwALDprFp/HkM11sAe4amFEBPXm0LgFFljA65zJ5hS4m63y3DXo4llmmWWcs+jIIr3yyivqm9/8JkE+f9ttrFyneBFjmJaA0i91ayz1DkH5vYLtZMMee+xR7DtBuldyRyCFp9om/S5C6ucgQMJKkloxwFIfUEq1gUpJnb8N55JNXvkwgWSjjTYqJg21BZUAgMLDBU28j9gzt+vJAAl3lpN/0LfX9tea5OQdBEhoekgsS/+sROjzCDU3btNYmP/w14fkx+r8/aWW+3ROSde605u0MlmKNk/alrZhiqeb5POIsgZ72vwHiTv7/Ee8r5B8bp2/zzzl+UGSv4wiP8YjA19cBk+PWBekg+PoxAMZlTemRxqQZHXvb5DQeLhveBfxZcR1DdXb8khrsWTWJff6q5jblFYfq+O08T03x4UadpDU5VoNm6s1ZIsVcyxUpNVz6/K5XGMXJHl4coCmIoEgMyLBU185tIFHcrBEuLIBJayHv44rMxtIKuWDBAm/nYyHLzfV1Yrx6/qKBZG5U8oCC+3tkxMo4X74baUuF73c44Z5Mkz9AUm8XzmQwjz8l3Mdrla1fcTFkme3+g2UeqyJzGLQXSj/4KUMVmx//dWvfqW+8Y1vkGRWy+ztvu5+47JyxSNhGRJXK9ZnrH3tixV7D0VdqJiyWje8hqvdh3/vuk92K7DH3C2vVVnRGpNTLW9VF+J55GIlMU5lxL5yUw4WMeotxJrKe9JVsVQEB1j3NodV+3XpZ5f5ni0sx+7L1XfeFbt2HzH+UeoAdjyucP85bfl76MvWOsuAFAaZ3Tf2dpirdbGO6/LLLzcGnnvQckGCfSK77bZbceiD3teO007QD/aN9PaluOViBa99oorv/F2bXLsKY4BwEQU03AHvflGUqSoz8tmGZUWHHv+o2axsfmSHNcSXlNB44yCIWYRwPaXu0ku/6zzGB4P4uOOOqzwTdPWdeYt9GVi9qxw/CPabABz2UaZ6fztcINzDgdXHvf7GFauFVWdZPFbr2u2ppA+DsL8D/mpcCk9+KxG3RNZnu8Pq03f5Ay6WDDAci0QHQbrbxbcmreKIn3XWWad09iwIZUcffbT64he/WNEV+0Dmm2++Yt+GJoDjr3/9a4UX/WKzkwYhBjqsBfaJ4MIbHFgH64WBjxPq9epfrZ8muEk9an/viE1sOuOMM7qbtHCqCp4Dm6zaW4jjg53mfsV58liJ/JujXFaEEYNIXar81xrI6+P3ddh0xx13OMsBgLvu+q26884ppfKrrrqqkGUCBMeLunTDHhHTQuEKBOyD17zaGulrGT7/+c+rAw44wPsddZ4mOthU53hV2wVzDVzaJTfp8UgOEMUo5mpZGha1wltuB7OkhMJTR1pXk73D7/jjJxfulkuWrw9NeHObIEKQrMFh8yIAhxUCmJZaamK3HJud7JNXQv1TSJbFCj8rvQ1PBvdz5VkI7R233Eafo9IpNaXLW1ISB0qsH37bcDucR2ueNALX56yzzmKnv0H2+VRXXHEFSc/NNtu0+2+4Z9CJCgjzUG7Vud0KOyy/+tWvmr2S9Khn7kMCvFifvM82ZT3dnd4m59ormTWJ1bkI7pYdj+CtfswxR3tl2VZHy9eZKk12OtanC647cA9G2g9l8uk98bTBnmfuI9aGb3liffI+2/0xT1aMc9ttaHxpssL18rVXLrrpppvUJZdcUqqBq7T11tUjeVTnkszY16CtEkUXWC3sc08DSaWEJIsCpJgcmavFk5nzM3Ox4iDXXsW/3BRr4ivHvnZN+qpjnOpuB+/IaoHXLavat75dVnUOjqY8gyZ9jpccJDJASNZMueTwXS15TJVKpcWKPOK1owGLuqQkxZqE2lXLfVcnHHPMMSX3CRN1oavPQn27dAmRmfmiDWxaHzI3imJZ8rta/fo8Yndab+yhmG5VrM9wfUg2v65KOOLTPrhag8Qvnyab/8Iq92OTLxaqlvF5cgDA3YanG78+qkLIxaoz9lAsoEjrQ7pIXC6b/vWvfxWTb2ZmC0f64MwqTeYFM71novVplpkTje4D53qkjxUyqR0L5XGjhtfVSgvoXfoIroEmtsiY0aK5VeH2/r55bexyxCL2AdLm8aLu7FT5LkLtMoVAYl5UY5/ZG9I3zlf9DnJZFpmrxf3Mdb3C8m1qn2rCsublNDCdn8YX5Ehc0s5tZ5fPOuusTj0wh3Httdd2P9sX1FC+J30ifMySwFXSS0Ni+vqoLquRx9VKtSJRDYKfbX3ap5qID2mgZqkUGShxealzHzQwuAhrrMp69D5hfsS3LMUlHyc7mmS6RS5d9Iz9L37xiyAf9begtKvHbXJoM/CA3Nan92+niyUBS06XSkUGerxeZk24yQkXSFzBsKtfHHtqxi642kBfxaasHwnLUnD1GxICuBqO8iw22St2afGI6xkqJVEeCWjiMtkiQtK9n8fNNddc5K54pylSl8sP33Giuj+cco7bXLHqVXXcGyzPuOGGG4oA3aUf9o/gZHjtZmFS0d7xp/sFKDB/Yrpk9oU9WMaub7Y65ZRTigt+fKcQImGg7zLUd5CYpGXjugYsn3d9B/06OnRYTk706zOOu5q3jHz6vo98N9lKV+ryV/G2+8MlldggBWDoIBllOP39nHPOsfjbfQA4uIoAK3Mx8HFJp69f3ImOwYq7PFZeeeWizt5/AquBoPz000/3LkfRK081KNxXUbvLW6Q9HmNkI1Tkc5hsfTrjZs455+yMeu6Owk4rRiMKb5xnOA6njp2Di4tmsMwdQLnpph9FD7LG4B4/fnypHte9+fqSl9V3Bu/wWwnm53ElgIQfjEJUsOQASn63Kj9I4Jr1Ave06wz6D5KxcpUB7ZR2X320LzdAwgpHaRzlCpMcp7gP5yntvKsPcgNHepVBHsuSo80wfWYePUrhbjuD8fmVumfS5Wuy0svps+V+Xlp7+cSfZJ4jrmeeDFV9aVuujswdhbwZ9RZh8i/XuivugJcsdeeVp4KEDhyXPEq/NCDFeHKkeflAjHCz5IcAVtlRyFGCDBTGkvc66iUAGgRIpGXUCcNcs+OSAZ9qJSjrptLku/sKHj1KIzo/hS/GQ7EmnpqawZAOkvxlrn5pz8LnibXhu17xPpJFGrLcViQYg3DBkhsogVoxiAYFEipv3jKaLsPiavEtU97YxCWbvKOQFXtkAkqaNRkukPh55e2pv0W8rH+uVlxfXn3O2MQFqBHqoDeF5rQULsV49bJMFjdeqQ8knCxWvC0HnHXwxHROjTVyW5EwdfeDSDZH0a1KvtgjXM+tCwOLzp8DJDnLZC6SND6JtakDVGH+iHSWbMdaLHNwUGfUaeuutDKpJyjmrEP58ccfr2aeeWZ10kknWc+UekK7UpdeemmlbKaZZuqeu9teinKTsz3KsPhxjjnmUA8++KC3n9B3Yj6P7NjQYThrN/Ys5c/x/kJrtMqyIosVe2ChzaZzgBLnSVmcuP3226ull57oal4QrgB46aWXin/jMnzXAc4mSOadd1611157Ffsy9EEO2AaLBYQ4ef32228P6oxFjybplbVaB637b3/720rb6667rgsQ1Vn+rtdt6f9fddX32IsOlTFYcAAddLQ3e2mCvviO/vjHP6prr72ODRqb4iDi1ssXJoZkj5swYQLTBnLWaaVe+B/n8dXhcpn99tsvrmKHsM971113c+qLQ6z33HPP4Onpp512mvrhD3/o1enuu+8ufV599dW9uh977LHdY0kBDuiGlb9YHl+2cm3CUvj/+7//c54sf9RRRxkX5JQJS95xrCn0mDRpUgG2ddddt7RU/t577y2W3JsrgbHCGEv6oZumsbdQsayfj3eaGWaY4dT6V/KmA4ULEryJcX4VBrV5thUOL3j88cfV1KlTu39wYfD/66+/rqLrlVdeWZyHhUGCZe84vhPn4f7gBz9Q7777rpp99tmLutVWW624ngAX1Lh0MjdDqQ4gcf+HS3dYCL0FF1cm4P4O8D366KMFUOaff/7SyYzTTjttsaHq1ltvLe1dVx0L9fbbb6tpppmmeE7VGeB4Fpztqzd4YVn+Y489VlypoPsGAXQAJZbxw3Ji2zGeFwDHXhn06fsd0hcqcutpg572ubQfpByUUgc+JaYw5cdjj/BdH5LYwyYc0tY7VKHdH96SZV3b5ZMnTy65RtjnYR62cNtttxX//+hHP1q8wbFHRF9FEDP5s802m1f35ZZbzvuMGKiufSF4EWAgH3roYaV+cSD2Qw89VFyfoK0ArkY4//zzSd+XJoAf+1KOOOKIroUBkPEdnXnmmc5nzh9rxOrprlOc2rIiW26JorKlfeWZLH66utcf3uZPPPFEqXy99dZTO+20U7fkmmuuUffff79TCqwJZABMvcFd1sc+qsfWnaStxWdv78Wmq6OOOlIkn8Lz3HPPFyA0b6TCPSM990uS9Qrrwa2P9M7qS8UnCuucSU+rD+nLJViUE088sdQKQb5JOhsVk7/llluW9KES/WXU+zfcSPugCMQuZR18chxp3nir4r8Aibmf3vyu+JOHsV559VyAxWQNcCY93Zr4vjsOSPRJJXYbff6tJvPiy5B83Aol08VnGcN8uArO3seOwNy+t8TUQz9LdezSXm44DA/BvSbf8ax+GbHPOa1IbP4tLDthJp3ASZ4gDNcHNPE+vq8dDjVAuna77bYv3nwI5HF7U6iNedB0TD5iATuGkLpQndJoO8QB9jnBOMDBR7jejSrbR7gqTpPrpqrwcw3WinBkJ8ykc5ecxGWJ2jMXJur7/k499ZTilJCFFlpIPfXUU5U2vtPXY/IV441KnWm3y7R10EBE4I67EU23B3EBkgoSHao81TbIgKVQqhWJ6WjVimUHL9ChvmDyuFQxIEl3D5YJwTICbvzpg6d7b1Sth1s3n8424f6OGCFV6+tLk+k6mXy4MtqmKVOmVI5AxWF05jGoPop/dTIQhT6nWpGYvBgAqbKDM+mFA1Pwcm64TZ1Fjx/xw6mzvxhkonAZpuqcYYWJserstR8M7mUmPD1BODqo11dYZx+fTbhA1L5hd//99/dm3ziyXSlbTe2sVlxGVWbs2J70NK3vM1UW+/BqOm+cJ8gRC9DJdX5eTLzBkjz11NNeHlrfrdLp65h3iOkZltn+bA9st/tV/oyrqc3MFuIRzNFgrZkmnMUVkxMj04rpyclBW5GU2MMna4Q+8HsNOUCJy5LVx+ooBL+9bU2qsszBaa+jcsk3z9o1A1jNak4wUnXWs/JlvkpJhQeZLTNox8JIzOtowuQh50Xi0lHftqVKVzPwg36eK8SWbsnmxTXKtCDcIJ0XoIf4UuojIGF92eFnX3755avyHYSB+cwzz5TkKuMQuKAGlkjXqYzmQ2HJh08XrEUzL/fxLUIs90//wtZYY43uv10vBJ9MrhWJWwn+oPf3VeUIB+mULjSwSHxp9Z4afwDt0AquRkiWJvv0dSwUrOrU+zfiGdW5WtmlOyyIOXdgujxm/5CDVDTcpBtvvDH4O+gl87YuqpPZwhIQM7Pl0otLaIP1YXr2HCAsZ7TSTUCaFcnpdpH3pFP0ovBlmBwU1Jm02GKLBWXp8q985SulVC9cCly5ZusLgvuy6qqrFoMFd477gvavfe1r3bf6FltsURxqvc022xRL6XFQNj5jRTD6Nc/+pT1alWnKlDvV1VdfTWlMJiy/MZfgtPey2M9afXbO53qtSMyilXmJh1fT9nnk2g8Sy1RRDqNGGhVugH6za0I8gRWouGcD8Udo8xMGKZaew5XBH5bPY4GeSSjHXAoG9emnf777PbgyOk8//UzRJ+Zh8PbH2il9aLUmuGiHHHKIdXp8Wx5W2iJ1q1flgnAn4s9//vMizVvNzLSKaxZgrXRmy3S7Yt+1yQNA42+llVYq6XrxxRd3PvH2g9RLsoyV6/sYN378+BZ/uTuNP/0MXtnxodgAhTcyNvf4CC4UgvSQDihfYYUVCn8ey8ldhAGHrBAyReXYI3wM52c+85liog+7C0EPPPBAkS69/PLLvW1hbTD5B7fJnrw8++yzi01Vvj7POuus4qxgzK3ARbIJy1MAQIDP3PeC53Ptg4EcrMnq3cEYXnqef39IvqXtwbo2QPyCwpTjfN16QOKV6Tk3OHb27gYbbNBdoq4J94TEdJGfsZv3/FzMvuOFAEuHU+dtHuwBsdef6ewd3FKdEEB7ZPguuuiiIT9jNwVAvbYVgPg6CBMBBBiWQZ781xrkKU8b+O728jIqIFw8AAmsAdK8Ejn8DVBpG57yboCSASgAEH/jFL7cOwdjdTnKOTLqL6OBiwqautuMVSui/8063T0HXywlnDuLxS9Pk5G/rFLi0iTajvr7cdtwKZZxyjtxKJ8j0bwjdcyiR1PDKUvcawcJV0beMoo+UiBJQBPrm5/CrUhkfa57YtDmHVHGwOfNoseVSZ3zkCwl6bfFoL7R6W9+WhlNFkWHcP91WJG8VO+ciOVicYDCOVUxXB/ug9+OAwb3fHs6oNLK4v0O0orYYlOtSt7lI2FluW6WJwbhr95N4akHJAxZLfe6LZ4LJi+j9ZEHEDmsSHxhUW5KdePK2pfbhnmjQTrVolCtSbi9r14CEl8bzwBnDfzBuFU0QMR8+kxWJCqz3s9hXVLcrHJt5v0gde5BDx/5429D50+3GDkHv7NXUTuJFanKiL21+/u5zvVXJnX3g+QM0OM8+bNYIZDw5FB501wtirxBWpHhD85tkusfYjUsSO4Avf8rd+tN86a0r9utcnQpkMOV0e/gPAWzHKth8gb2g5C6rdGlkgThEpBQeetwtZwio/3SLEScJ9ZGIiMvhftPyXZRLUwgBuGefxXkqAEk/MCdN/Bpg5wDHEpbKZAkPFncqMhbPvVzijI53CxCkE4FSvrZV/y6EEjo5RxApQBnbFiRsIx4yjfv55xzIhI3i7HUJF8WK2+dP53rK+fqRSFqcC4LsvtpRfrtRnEpp5sV52EvNaGke+uLO/wg4ZSnxiP9mAeRtaMAKx0A6cF6rH2SdkHZYd4qh3ipSao1CfUzVjNYOYPzfFYkv1uVDrL42Anrk9BzJAyw+w0uNYl3luZS5V9rVY/FyO92SMElsxD9cKsqEit9Jnfh7Y0HIB7YSKeaxGgwIOG14cUjNLl1WxGabjL3jNtP1KpEQZfmhvGI0zjcL2PDVBpPuF641srbl5ufLt+nDK2vnME5RYm4hYjrM3zBej4ApVgYxv0gObJYmUHCDNqTg/Psez+c6sT1EMUZNbhVUSsT5k/sPdg3p22IrPtBCKITV+3mBkmOuIPzhVHdpbFgRbgy+CAbnJvFmyT08zqzWASRtcUd9YOEzsuZI5KWSa0Irb9wX8M/B5LPIvEA0/t38JZbSqexuCNQGwSJX2Z6Oc/VorXvtxWRxBn1BOvcerYKZuvIZ4YkYhxCyGJFu+p/cM5yk1JdrbFjRSQWId2q1OtmcaiOdC95LVYaT36QcPjrcLVS0rk0K+JUj80T13HY3KoypcUlHGY3LzmLNXaCc58cuoy8JLUiFADG5eQJ1sMyB+lmpcQhYc+n/X9mFqve4DymLK2vdFdrMJOC0nZxOTG5cXDW7WbZ+sjf/PnSve06URar/zPnvGXteVwtjyqk1nGufJkpCYqGzc2KjacEySwLUy0LZLFiwtIyWPx26ZaB1ydxUCdktGh6SHj4beIywjLj44WtgtmapVuoLacfpZT6f1gtTYr+hWwAAAAAAElFTkSuQmCC";


        var loader;    // my spinner

        var dashboardTimerIndex;


        //----------------------------------------------------------------------------------------------
        function strToArray(str) {
            let tags_array = str.split(",");
            let tags_set = new Set(tags_array);
            let tagsArr = Array.from(tags_set);
            return tagsArr;
        };

        //----------------------------------------------------------------------------------------------
        // remove given tags
        function remove_tags(item, tntr, type) {   // 0 = tags,  1 = genre,  2 = studios
            let nta = [];   //  nta is the new tag array
            let tnii = [];  //  tnii are the item's tag names  (tag names in item)

            if (item.TagItems    && (type == 0)) { tnii = tagsToArray(item.TagItems,    "Name"); };   // tag names in the item
            if (item.GenreItems  && (type == 1)) { tnii = tagsToArray(item.GenreItems,  "Name"); };   // genre names in the item
            if (item.Studios     && (type == 2)) { tnii = tagsToArray(item.Studios,     "Name"); };   // studio names in the item

            tntr.forEach(function (rtn, pos) {   // rtn remove tag name

                rtn = rtn.toLowerCase();        // first tag to remove

                tnii.forEach(function (tn) {
                    tn = tn.toLowerCase();
                    if (rtn != tn) {
                        nta.push({ "Name": tn });
                    };
                });
            });
            //console.log("=== nta = ", nta);
            return nta;
        };
        //----------------------------------------------------------------------------------------------
        //
        //
        //
        //
        //
        //
        //
        //
        //
        //
        //
        //----------------------------------------------------------------------------------------------
        function editTvChannel(indexArray, currentItems, bulk) {
            console.log("=== Start:   indexArray = ", indexArray, ", current items = ", currentItems);

            hide_and_show_buttons(7);

            sideNode.style.display = "none";
            topPageTitleArea.style.display = "none";

            var index = 0;
            let count = indexArray.length;
            var channelData;

            if (count == 1) {
                prev_btn.style.display = "none";
                next_btn.style.display = "none";
            };

            //
            //   button event listeners
            //
            prev_btn.onclick = function (e) { prev(e) };
            next_btn.onclick = function (e) { next(e) };
            save_btn.onclick = function (e) { save(e) };
            return_btn.onclick = function (e) { finished() };
            //
            // button event listener functions
            //
            function prev(e) {
                e.preventDefault();
                //console.log("____________ prev Btn ______________");
                index--;
                if (index < 0) index = count - 1;
                edit_Ch(currentItems[indexArray[index]]);
                return;
            };
            function next(e) {
                e.preventDefault();
                //console.log("____________ next Btn ______________");
                index++;
                if (index >= count) index = 0;
                edit_Ch(currentItems[indexArray[index]]);
                return;
            };
            function save(e) {
                e.preventDefault();
                //console.log("___________ save Btn _____________");
                if (bulk) {
                    bulkSave(indexArray, currentItems);
                } else {
                    saveChannelInfo(channelData);
                };
                return;
            };

            //----------------------------------------------------------------------------------------

            if (bulk) {
                prev_btn.style.display = "none";
                next_btn.style.display = "none";
            };

            edit_Ch(currentItems[indexArray[0]]);


            //----------------------------------------------------------------------------------------
            //
            //----------------------------------------------------------------------------------------
            function edit_Ch(data) {
                console.log("=== Channel Data 1 = ", data);

                var pn = document.getElementById("page_node");
                while (pn.firstChild) { pn.firstChild.remove(); };

                let d1 = document.createElement("DIV");
                pn.appendChild(d1);

                let d4 = document.createElement("DIV");
                d4.innerHTML = (bulk) ? "<h1>Bulk Edit</h1>" : "<h1>Edit Channel " + data.ChannelNumber + "</h1>";
                d4.style.textAlign = "center";

                d1.appendChild(d4);

                if (!bulk) {
                    let d2 = document.createElement("DIV");
                    d2.innerHTML = "<h1>Info:</h1>";
                    d2.style.textAlign = "left";

                    d1.appendChild(d2);
                };

                getChannel(data.Id);

                //----------------------------------------------------------------------------------------
                async function getChannel(Id) {
                    // get object to edit
                    //
                    let url = "Users/" + currentUserId + "/Items/" + Id + "?Fields=ChannelMappingInfo";

                    channelData = await ApiClient.getJSON(ApiClient.getUrl(url));

                    console.log("=== Channel Data 2 = ", channelData);

                    processChannelData();
                };
                //----------------------------------------------------------------------------------------
                function processChannelData() {
                    if (!bulk) {
                        let xx = document.createElement("LABEL");
                        xx.innerText = "Channel Name";
                        xx.style.fontSize = "16px";
                        xx.style.marginRight = "5px";
                        xx.style.display = "inline-block";
                        xx.style.width = "130px";

                        d1.appendChild(xx);
                        d1.appendChild(add_text_input(channelData.Name, "Channel Name", "class_channel_name"));
                        d1.appendChild(document.createElement("BR"));

                        let yy = document.createElement("LABEL");
                        yy.innerText = "Channel Number";
                        yy.style.fontSize = "16px";
                        yy.style.marginRight = "5px";
                        yy.style.display = "inline-block";
                        yy.style.width = "130px";

                        d1.appendChild(yy);
                        d1.appendChild(add_text_input(channelData.ChannelNumber, "Channel Number", "class_channel_number"));
                        d1.appendChild(document.createElement("BR"));

                        let aa = document.createElement("LABEL");
                        aa.innerText = "Sort Title";
                        aa.style.fontSize = "16px";
                        aa.style.marginRight = "5px";
                        aa.style.display = "inline-block";
                        aa.style.width = "130px";

                        d1.appendChild(aa);
                        d1.appendChild(add_text_input(channelData.SortName, "Sort Title", "class_sort_title"));
                        d1.appendChild(document.createElement("BR"));

                        let bb = document.createElement("LABEL");
                        bb.innerText = "If you change the Sort Title you must also LOCK the Sort Name or the server will reset the Sort Title back to its original value.";
                        bb.style.fontSize = "20px";

                        d1.appendChild(bb);
                        d1.appendChild(document.createElement("BR"));
                    };
                    //----------------------------------------------------------------------------------------
                    function add_text_input(value, placeholder, class_name) {
                        let x = document.createElement("INPUT");
                        x.setAttribute("type", "text");
                        x.setAttribute("value", value);
                        x.setAttribute("size", "40");
                        x.setAttribute("maxlength", "80");
                        if (placeholder) x.setAttribute("placeholder", placeholder);
                        x.style.marginBottom = "5px";
                        x.className = class_name;

                        return x;
                    };

                    //----------------------------------------------------------------------------------------
                    //
                    //   add channel tags
                    //
                    let ttt = document.createElement("DIV");
                    ttt.innerHTML = "<h1>Tags: <h1>";

                    d1.appendChild(ttt);

                    let tag_array = [];
                    if (channelData.TagItems) { tag_array = tagsToArray(channelData.TagItems, "Name"); };

                    //console.log("=== Tags = ", tag_array);

                    let tt = document.createElement("TEXTAREA");
                    tt.setAttribute("rows", "5");
                    tt.setAttribute("cols", "30");
                    tt.id = "tagTextArea";
                    tt.style.fontSize = "18px";
                    tt.value = (bulk) ? "" : tag_array.toString();

                    d1.appendChild(tt);



                    if (bulk) {
                        d1.appendChild(document.createElement("BR"));
                        d1.appendChild(savePulldown("No save", 100));
                    };

                    //----------------------------------------------------------------------------------------
                    //
                    // add channel locks
                    //
                    let zz = document.createElement("DIV");
                    zz.innerHTML = "<h1>Locks:<h1>";

                    d1.appendChild(zz);

                    let lock_array = (channelData.LockedFields) ? channelData.LockedFields : []; // ['Name', 'OfficialRating', 'Genres', 'Cast', 'Studios', 'Tags', 'Overview']
                    d1.appendChild(manage_locks(lock_array));

                    function manage_locks(lock_array) {
                        //console.log("=== Locks = ",lock_array); // ['Name','OfficialRating','Genres','Cast','Studios','Tags','Overview']
                        let tb = document.createElement("TABLE");
                        tb.appendChild(add_row("Name", lock_array.indexOf("Name")));
                        tb.appendChild(add_row("SortName", lock_array.indexOf("SortName")));
                        tb.appendChild(add_row("ChannelNumber", lock_array.indexOf("ChannelNumber")));
                        tb.appendChild(add_row("Tags", lock_array.indexOf("Tags")));

                        return tb;
                    };

                    function add_row(A, B) {
                        let x = document.createElement("SELECT");
                        //x.setAttribute("name", "Lock");
                        // x.id = "";
                        // x.className = "";
                        if (bulk) x.appendChild(addOption(""));
                        x.appendChild(addOption("Locked"));
                        x.appendChild(addOption("Unlocked"));
                        x.value = (bulk) ? "" : (B >= 0) ? "Locked" : "Unlocked";
                        x.id = "Lock_" + A

                        let tr = document.createElement("TR");
                        let td_1 = document.createElement("TD");
                        let td_2 = document.createElement("TD");
                        tr.appendChild(td_1);
                        tr.appendChild(td_2);
                        td_1.innerHTML = A;
                        td_2.appendChild(x);

                        return tr;
                    };

                    function addOption(value) {
                        let y = document.createElement("option");
                        y.setAttribute("value", value);
                        y.innerText = value;
                        return y;
                    };


                    if (bulk) return;
                    //----------------------------------------------------------------------------------------
                    //
                    //
                    //
                    //----------------------------------------------------------------------------------------
                    //d1.appendChild(document.createElement("HR"));

                    let d3 = document.createElement("DIV");
                    d3.innerHTML = "<h1>Channel Logo Images:</h1>";
                    d3.style.textAlign = "left";

                    d1.appendChild(d3);

                    let tbl_1 = document.createElement("TABLE");
                    let tr_1 = document.createElement("TR");
                    let tr_2 = document.createElement("TR");
                    let td_1 = document.createElement("TD");
                    let td_2 = document.createElement("TD");
                    let td_3 = document.createElement("TD");
                    let td_4 = document.createElement("TD");
                    let td_5 = document.createElement("TD");
                    let td_6 = document.createElement("TD");

                    d1.appendChild(tbl_1);
                    tbl_1.appendChild(tr_1);
                    tbl_1.appendChild(tr_2);

                    //
                    //  add the channel images
                    //
                    if (channelData.ImageTags.Primary) {
                        let img_url1 = server_url + "Items/" + channelData.Id +
                            "/Images/Primary?" +
                            "maxHeight=300" +
                            "&maxWidth=200" +
                            "&tag=" + channelData.ImageTags.Primary +
                            "&quality=90";

                        let iNode1 = document.createElement("img");
                        iNode1.src = img_url1;
                        iNode1.loading = "lazy";
                        iNode1.style.width = "200px";

                        td_1.appendChild(iNode1);
                    } else {
                        let yyy1 = document.createElement("LABEL");
                        yyy1.innerHTML = "No Dark Logo";
                        yyy1.style.display = "inline-block";
                        yyy1.style.width = "210px";
                        yyy1.style.textAlign = "center";
                        yyy1.style.fontSize = "20px";
                        yyy1.style.marginBottom = "20px";

                        td_1.appendChild(yyy1);
                    };

                    tr_1.appendChild(td_1);

                    if (channelData.ImageTags.LogoLight) {
                        let img_url2 = server_url + "Items/" + channelData.Id +
                            "/Images/LogoLight?" +
                            "maxHeight=300" +
                            "&maxWidth=200" +
                            "&tag=" + channelData.ImageTags.LogoLight +
                            "&quality=90";

                        let iNode2 = document.createElement("img");
                        iNode2.src = img_url2;
                        iNode2.loading = "lazy";
                        iNode2.style.width = "200px";

                        td_2.appendChild(iNode2);
                    } else {
                        let yyy2 = document.createElement("LABEL");
                        yyy2.innerHTML = "No Light Logo";
                        yyy2.style.display = "inline-block";
                        yyy2.style.width = "210px";
                        yyy2.style.textAlign = "center";
                        yyy2.style.fontSize = "20px";
                        yyy2.style.marginBottom = "20px";

                        td_2.appendChild(yyy2);
                    };

                    tr_1.appendChild(td_2);

                    if (channelData.ImageTags.LogoLightColor) {
                        let img_url3 = server_url + "Items/" + channelData.Id +
                            "/Images/LogoLightColor?" +
                            "maxHeight=300" +
                            "&maxWidth=200" +
                            "&tag=" + channelData.ImageTags.LogoLightColor +
                            "&quality=90";


                        let iNode3 = document.createElement("img");
                        iNode3.src = img_url3;
                        iNode3.loading = "lazy";
                        iNode3.style.width = "200px";


                        td_3.appendChild(iNode3);
                    } else {
                        let yyy3 = document.createElement("LABEL");
                        yyy3.innerHTML = "No Light Color Logo";
                        yyy3.style.display = "inline-block";
                        yyy3.style.width = "210px";
                        yyy3.style.textAlign = "center";
                        yyy3.style.fontSize = "20px";
                        yyy3.style.marginBottom = "20px";

                        td_3.appendChild(yyy3);
                    };

                    tr_1.appendChild(td_3);

                    //
                    // add buttons to change the channel images
                    //
                    let yy1 = document.createElement("Button");
                    yy1.classList.add('page_button2');
                    yy1.innerHTML = "Change Logo\nDark";
                    yy1.id = "changeLogoBtn_1";
                    yy1.style.marginLeft = "15px";

                    td_4.appendChild(yy1);

                    tr_2.appendChild(td_4);

                    let yy2 = document.createElement("Button");
                    yy2.classList.add('page_button2');
                    yy2.innerHTML = "Change Logo\nLight";
                    yy2.id = "changeLogoBtn_2";
                    yy2.style.marginLeft = "15px";

                    td_5.appendChild(yy2);

                    tr_2.appendChild(td_5);

                    let yy3 = document.createElement("Button");
                    yy3.classList.add('page_button2');
                    yy3.innerHTML = "Change Logo\nLight Color";
                    yy3.id = "changeLogoBtn_3";
                    yy3.style.marginLeft = "15px";

                    td_6.appendChild(yy3);

                    tr_2.appendChild(td_6);

                    //............................................
                    // image picker
                    //............................................
                    document.getElementById("changeLogoBtn_1").onclick = function (event) {
                        event.preventDefault();   // stop the event from propagating further
                        console.log("=== logo picker - LogoDark === ");
                        openImageFile(channelData.Id, "Primary", imageCallback);
                    };
                    //............................................
                    // image picker
                    //............................................
                    document.getElementById("changeLogoBtn_2").onclick = function (event) {
                        event.preventDefault();   // stop the event from propagating further
                        console.log("=== logo picker - LogoLight === ");
                        openImageFile(channelData.Id, "LogoLight", imageCallback);
                    };
                    //............................................
                    // image picker
                    //............................................
                    document.getElementById("changeLogoBtn_3").onclick = function (event) {
                        event.preventDefault();   // stop the event from propagating further
                        console.log("=== logo picker - LogoLightColor === ");
                        openImageFile(channelData.Id, "LogoLightColor", imageCallback);
                    };
                    //............................................
                    //
                    // callback
                    //
                    //............................................
                    function imageCallback() {
                        console.log("=== Save Done ===");

                        edit_Ch(currentItems[indexArray[index]]);
                    };
                };
            };

            //-------------------------------------------------------------------------------
            //
            //  Save channel info
            //
            //-------------------------------------------------------------------------------
            function saveChannelInfo(data) {
                console.log("_______ Save Channel Info ======", data);
                if (!data) return;

                //-------------------------------------------------------------------------------
                data.ChannelName = document.querySelector(".class_channel_name").value;
                data.Name = data.ChannelName;
                data.ChannelNumber = document.querySelector(".class_channel_number").value;
                data.SortName = document.querySelector(".class_sort_title").value;
                data.ForcedSortName = data.SortName;

                //console.log("_______ Sort Name _______ = ", data.SortName);
                //-------------------------------------------------------------------------------
                //
                // get tags
                //
                let tags_array = [];
                let tag_area = document.getElementById("tagTextArea");
                let tag_str = tag_area.value;

                let tt = tag_str.split(",");
                tt.forEach(function (item, pos) { tags_array.push({ "Name": item }); });
                let tags_set = new Set(tags_array);
                let tagsArr = Array.from(tags_set);

                data.TagItems = (tagsArr.length > 0) ? tagsArr : [];
                //console.log("_______ Sort Name _______ = ", data.SortName);

                //-------------------------------------------------------------------------------
                //
                // get lockss
                //
                let lock_Name = document.getElementById("Lock_Name").value;
                let lock_SortName = document.getElementById("Lock_SortName").value;
                let lock_ChannelNumber = document.getElementById("Lock_ChannelNumber").value;
                let lock_Tags = document.getElementById("Lock_Tags").value;

                let LockedFields = [];

                if (lock_Name == "Locked") LockedFields.push("Name");
                if (lock_SortName == "Locked") LockedFields.push("SortName");
                //
                // to change the SortName you must also include SortName in the LockedFields, otherwise it will be reset
                //
                //LockedFields.push("SortName");

                if (lock_ChannelNumber == "Locked") LockedFields.push("ChannelNumber");
                if (lock_Tags == "Locked") LockedFields.push("Tags");

                data.LockedFields = LockedFields;

                //-------------------------------------------------------------------------------
                //
                //  save data
                //
                console.log("========== Data = ", data);

                saveChInfo(data, saveInfoFinished);
            };
            //-------------------------------------------------------------------------------
            async function saveChInfo(item, callback) {
                await ApiClient.updateItem(item);
                if (callback) callback();
            };
            //-------------------------------------------------------------------------------
            function saveInfoFinished() {
                console.log("=== Save Channel Info finished ===");
                finished();
            };
            //-------------------------------------------------------------------------------
            function bulkSave(indexArray, currentItems) {
                console.log("=== Bulk Save Started ===");
                //
                // show spinner
                //
                loader.classList.remove("loader-hidden");  // show the spinner

                var max = indexArray.length;

                getBaseItem(0);

                async function getBaseItem(index) {
                    let base_item = currentItems[indexArray[index]];
                    let url = "Users/" + currentUserId + "/Items/" + base_item.Id + "?Fields=ChannelMappingInfo";
                    let item = await ApiClient.getJSON(ApiClient.getUrl(url));

                    //-------------------------------------------------------------------------------
                    //
                    // get tags
                    //
                    let tags_array = [];
                    let tag_area = document.getElementById("tagTextArea");
                    let tag_str = tag_area.value;

                    let tt = tag_str.split(",");
                    tt.forEach(function (item, pos) { tags_array.push({ "Name": item }); });

                    let tags_set = new Set(tags_array);
                    let tagsArr = Array.from(tags_set);

                    let temp  = document.getElementById("P_100");
                    let tagAction = temp.value;
                    console.log("=== tagAction = ", tagAction);


                    if (tagAction != "No save") { 
                        if (tagAction == "Add to") {
                            item.TagItems = item.TagItems.concat(tagsArr);
                        } else
                        if (tagAction == "Replace All") {
                            item.TagItems = tagsArr;
                        } else
                        if (tagAction == "Remove Tags") {
                            item.TagItems = remove_tags(item, tt, 0);
                        } else
                        if (tagAction == "Delete All") { item.TagItems = []; };
                    };


                    //-------------------------------------------------------------------------------
                    //
                    // get lockss
                    //
                    let lock_Name = document.getElementById("Lock_Name").value;
                    let lock_SortName = document.getElementById("Lock_SortName").value;
                    let lock_ChannelNumber = document.getElementById("Lock_ChannelNumber").value;
                    let lock_Tags = document.getElementById("Lock_Tags").value;

                    let LockedFields = [];

                    if (lock_Name == "Locked") LockedFields.push("Name");
                    if (lock_SortName == "Locked") LockedFields.push("SortName");
                    //
                    // to change the SortName you must also include SortName in the LockedFields, otherwise it will be reset
                    //
                    //LockedFields.push("SortName");

                    if (lock_ChannelNumber == "Locked") LockedFields.push("ChannelNumber");
                    if (lock_Tags == "Locked") LockedFields.push("Tags");

                    item.LockedFields = LockedFields;

                    saveChInfo(item, itemSavedFinished);

                    function itemSavedFinished() {
                        index++;
                        if (index < max) {
                            getBaseItem(index);
                        } else {
                            loader.classList.add("loader-hidden");  // hide the spinner

                            finished();
                            return;
                        };
                    };
                };
            };
        };

        //............................................

        const opt2 = {
            types: [{
                description: "Image file",
                accept: { 'image/*': ['.png', '.gif', '.jpeg', '.jpg'] }
            }],
            excludeAcceptAllOption: true,
            startIn: 'pictures'
        };

        //............................................
        async function openImageFile(originalId, imageType, callback) {   // imageType is "Primary", "LogoLight", "Thumb"  etc.
            //console.log("=== Select an Image with the file picker");

            [fileHandle3] = await window.showOpenFilePicker(opt2);
            var file = await fileHandle3.getFile();

            process_picked_file(file, originalId, callback, imageType);
        };

        async function process_picked_file(file, itemId, callback, imageType) {
            console.log("=== file = ", file, ", id = ", itemId, ", type = ", imageType);
            await ApiClient.uploadItemImage(itemId, imageType, file);
            if(typeof callback == "function") callback();
        };





        //----------------------------------------------------------------------------------------------
        //
        //
        //
        //
        //
        //
        //
        //
        //
        //
        //
        //----------------------------------------------------------------------------------------------

        async function cast_to_tv(indexArray, currentItems) {

            console.log("=== indexArray = ", indexArray, ", current items = ", currentItems);

            hide_and_show_buttons(6);

            sideNode.style.display = "none";
            topPageTitleArea.style.display = "none";

            var pn = document.getElementById("page_node");
            while (pn.firstChild) { pn.firstChild.remove(); };


            let d1 = document.createElement("DIV");
            d1.innerHTML = "<h1>Cast to TV or Monitor</h1>";
            d1.style.textAlign = "center";
            pn.appendChild(d1);


            let len = indexArray.length;
            if (len > 30) len = 30;          // limit the length of the playlist

            let items = [];

            for (let i = 0; i < len; i++) {
                let item = currentItems[indexArray[i]];
                if(item.MediaType == "Video") items.push(item);    // include only videos in the playlist
            };

            if (items.length == 0) { finished(); return };

            let y1 = document.createElement("LABEL");
            y1.innerHTML = "<h1>Playlist to Cast</h1>";
            y1.style.display = "inline-block";
            pn.appendChild(y1);


            listImages(pn, items);


            var idStr = "";
            for (let i = 0; i < len; i++) {
                let item = items[i];
                idStr += item.Id + ",";
            };
            idStr = idStr.slice(0, -1);  // remove last comma
            console.log("=== idStr = ", idStr);

            let y3 = document.createElement("LABEL");
            y3.innerHTML = "<h1>Select a Device on Your Network to Cast To</h1>";
            pn.appendChild(y3);
            //
            // get available device sessions
            //
            let sessions = await ApiClient.getSessions( { "ActiveWithinSeconds": "300", "IncludeAllSessionsIfAdmin":"true" } );
            console.log("=== sessions = ", sessions);
            //
            // build device id pull down
            //
            let x = document.createElement("SELECT");
            x.id = "tvDeviceId";
            x.style.fontSize = "25px";
            x.style.margineLeft  = "10px";
            x.style.margineRight = "10px";
            x.appendChild( addOption("Select a Remote Device", "") );
            pn.appendChild(x);
            //
            //  add options to a select in a pull down
            //
            function addOption(name, value) {
                let y = document.createElement("option");
                y.setAttribute("value", value);
                y.innerText = name;
                return y;
            };

            let currentSessionData = [];
            //
            //  add the devices to the pull down list
            //
            sessions.map((session) => {
                if (session.SupportsRemoteControl) {
                    currentSessionData[session.DeviceId] = session;
                    x.appendChild(addOption(session.DeviceName, session.DeviceId));
                };
            });

            console.log("=== currentSessionData = ", currentSessionData);

            let y2 = document.createElement("LABEL");
            y2.innerHTML = "<h1>Device Controls</h1>";
            pn.appendChild(y2);


            let x1 = document.createElement("Button");
            x1.classList.add('page_button');
            x1.innerHTML = "Play";
            x1.style.marginRight = "5px";
            x1.id = "playBtn";
            pn.appendChild(x1);


            let x2 = document.createElement("Button");
            x2.classList.add('page_button');
            x2.innerHTML = "Pause";
            x2.style.marginRight = "5px";
            x2.id = "pauseBtn";
            pn.appendChild(x2);


            let x3 = document.createElement("Button");
            x3.classList.add('page_button');
            x3.innerHTML = "Previous";
            x3.style.marginRight = "5px";
            x3.id = "prevBtn";
            pn.appendChild(x3);


            let x4 = document.createElement("Button");
            x4.classList.add('page_button');
            x4.innerHTML = "Next";
            x4.style.marginRight = "5px";
            x4.id = "nextBtn";
            pn.appendChild(x4);


            //let x6 = document.createElement("Button");
            //x6.classList.add('page_button');
            //x6.innerHTML = "Skip";
            //x6.style.marginRight = "5px";
            //x6.id = "skipBtn";
            //pn.appendChild(x6);


            let x5 = document.createElement("Button");
            x5.classList.add('page_button');
            x5.innerHTML = "Return";
            x5.id = "stopBtn";
            pn.appendChild(x5);


            pn.appendChild(document.createElement("BR"));
            pn.appendChild(document.createElement("BR"));

            //------------------------------------------------
            //
            // display item data in a table
            //
            let div1 = document.createElement("DIV");

            let tb1 = document.createElement("TABLE");

            div1.appendChild(tb1);

            pn.appendChild(div1);

            let tr1 = document.createElement("TR");

            tb1.appendChild(tr1);

            let td1 = document.createElement("TD");
            tr1.appendChild(td1);

            let td2 = document.createElement("TD");
            td2.style.width = "100%";
            td2.setAttribute("valign", "top");

            tr1.appendChild(td2);

            let div2 = document.createElement("DIV");
            td2.appendChild(div2);

            //------------------------------------------------

            var deviceId;
            var deviceSession;
            var currentPosition = 0;
            
            //
            // play the video
            //
            document.getElementById("playBtn").onclick = function (event) {
                event.preventDefault();
                console.log("=== event = ", event);

                deviceId = document.getElementById("tvDeviceId").value;

                if (deviceId == "") return;

                console.log("=== deviceId = ", deviceId,", idStr",idStr);

                deviceSession = currentSessionData[deviceId];

                console.log("=== device session = ", deviceSession);

                ApiClient.sendPlayStateCommand(deviceSession.Id, "stop");

                ApiClient.sendPlayCommand(deviceSession.Id, { "ItemIds": idStr, "PlayCommand": "PlayNow", "StartPositionTicks": "0", "StartIndex": "0" });

                //getLanguages();

                //async function getLanguages() {
                //    let t = await ApiClient.getStreamLanguages(currentUserId);
                //    console.log("=== Languages = ", t);
                //};

                var done = 0;

                timerCallback();

                async function timerCallback() {
                    done += 1;

                    if (dashboardTimerIndex) clearTimeout(dashboardTimerIndex); // needed to guarantee only one timer
                    //
                    // get available device sessions again
                    //
                    let sessions = await ApiClient.getSessions({ "ActiveWithinSeconds": "300", "IncludeAllSessionsIfAdmin": "true" });
                    console.log("=== sessions 2 = ", sessions);
                    //
                    // loop through each session
                    //
                    sessions.map( (session) => {
                        if (session.NowPlayingItem) {
                            currentPosition = session.PlayState.PositionTicks;

                            console.log("=== deviceSession.Id = ", deviceSession.Id, ", session.Id = ", session.Id, ", currentPosition = ",currentPosition);

                            if (deviceSession.Id == session.Id) {

                                done = 0;

                                let npi = session.NowPlayingItem;
                                console.log("=== npi = ", npi);
                                //
                                // get the npi image tag
                                //
                                if (npi.ImageTags["Primary"]) {
                                    var image_url = server_url + "Items/" + npi.Id + "/Images/Primary?maxHeight=300&maxWidth=200&tag=" + npi.ImageTags.Primary + "&quality=90";
                                } else if (npi.SeriesPrimaryImageTag) {
                                    var image_url = server_url + "Items/" + npi.SeriesId + "/Images/Primary?tag=" + npi.SeriesPrimaryImageTag + "&maxWidth=200&maxHeight=300&quality=90";
                                } else if (npi.ImageTags["Thumb"]) {
                                    var image_url = server_url + "Items/" + npi.Id + "/Images/Thumb?maxWidth=200&maxHeight=300";
                                } else {
                                    var image_url = getDefaultImage();
                                };
                                let iNode = document.createElement("img");
                                iNode.src = image_url;
                                iNode.loading = "lazy";
                                iNode.style.width = "200px";

                                while (td1.firstChild) { td1.firstChild.remove(); };  // remove any previous images
                                td1.appendChild(iNode);

                                let temp = "";

                                var timePlayed = convertTime(session.PlayState.PositionTicks);
                                if (npi.Name) {
                                    var timeLength = convertTime(npi.RunTimeTicks);    // minutes

                                    if (npi.Type == "Episode") {
                                        temp += "<div style='font-size:25px; text-align:center;'>" + npi.SeriesName + " - " + npi.SeasonName +
                                            "<br>" + npi.Name + "</div>" +
                                            "<div style='font-size:15px; text-align:left;'>" + npi.Overview +
                                            "<br><br>Length " + timeLength +
                                            " (Now Playing " + timePlayed + ")</div>";
                                    } else {
                                        temp += "<div style='font-size:25px; text-align:center;'>" + npi.Name + "</div>" +
                                            "<div style='font-size:15px; text-align:left;'>" + npi.Overview +
                                            "<br><br>Length " + timeLength +
                                            " (Now Playing " + timePlayed + ")</div>";
                                    };
                                };

                                div2.innerHTML = temp;
                            };
                        };
                    });

                    console.log("=== done = ",done);
                    if (done < 2) {
                        dashboardTimerIndex = setTimeout(timerCallback, 5000);
                    } else {
                        while (td1.firstChild)  { td1.firstChild.remove(); };   // remove previous image
                        div2.innerHTML = "";
                    };
                };

                function convertTime(timeTicks) {
                    if (timeTicks) {
                        //var s = (timeTicks / 10000000);     // time in seconds
                        var ms = (timeTicks / 10000);         // miliseconds
                        var result = new Date(ms).toISOString().slice(11, 19);     //    <-----------------<<<<<
                        //console.log("*** time = "+result);                       // "00:10:00" (hh:mm:ss)

                        return result;
                    } else return false;
                };
            };
            //
            // skip ahead button
            //
            //document.getElementById("skipBtn").onclick = function (event) {
            //    event.preventDefault();
            //    console.log("=== skip === ");
            //    //Sessions/ { Id } /Playing/Seek ? SeekPositionTicks = xxx
            //    if (deviceSession) ApiClient.sendPlayStateCommand(deviceSession.Id, "Seek", { "SeekPositionTicks": (currentPosition + 500000) });
            //};
            //
            // stop the video
            //
            document.getElementById("stopBtn").onclick = function (event) {
                event.preventDefault();
                console.log("=== stop === ");

                if (deviceSession) ApiClient.sendPlayStateCommand(deviceSession.Id, "Stop");

                if (dashboardTimerIndex) clearTimeout(dashboardTimerIndex); // needed to guarantee only one timer
                finished();
            };
            //
            // pause the video
            //
            document.getElementById("pauseBtn").onclick = function (event) {
                event.preventDefault();
                console.log("=== pause === ");

                if (deviceSession) ApiClient.sendPlayStateCommand(deviceSession.Id, "PlayPause");
            };
            //
            // play next video in the playlist
            //
            document.getElementById("nextBtn").onclick = function (event) {
                event.preventDefault();
                console.log("=== play next === ");

                if (deviceSession) ApiClient.sendPlayStateCommand(deviceSession.Id, "NextTrack");
            };
            //
            // play previous video in the playlist
            //
            document.getElementById("prevBtn").onclick = function (event) {
                event.preventDefault();
                console.log("=== play previous === ");

                if (deviceSession) ApiClient.sendPlayStateCommand(deviceSession.Id, "PreviousTrack");
            };
        };

        //---------------------------------------------------------------------------------------------------------
        //
        //
        //
        //---------------------------------------------------------------------------------------------------------
        function listImages(pn, items) {

            let displayedItemsIdStr = "";
            let len = items.length;

            let y7 = document.createElement("LABEL");
            y7.innerHTML = "<h3 style='display:inline-block; margin-left:10px'>(Count = " + len + ")</h3>";
            //y7.style.fontSize = "20px";
            if (len > 100) {
                y7.innerHTML = "<h3>Selected Item Count = " + len + ", the first 100 are shown below</h3>";
                len = 100;
            };
            pn.appendChild(y7);
            pn.appendChild(document.createElement("BR"));

            for (let i = 0; i < len; i++) {
                let item = items[i];

                displayedItemsIdStr += item.Id + ",";
                //
                // get the item's image tag
                //
                if (item.ImageTags["Primary"]) {
                    var image_url = server_url + "Items/" + item.Id + "/Images/Primary?maxHeight=300&maxWidth=200&tag=" + item.ImageTags.Primary + "&quality=90";
                } else if (item.SeriesPrimaryImageTag) {
                    var image_url = server_url + "Items/" + item.SeriesId + "/Images/Primary?tag=" + item.SeriesPrimaryImageTag + "&maxWidth=200&maxHeight=300&quality=90";
                } else if (item.ImageTags["Thumb"]) {
                    var image_url = server_url + "Items/" + item.Id + "/Images/Thumb?maxWidth=200&maxHeight=300";
                } else {
                    var image_url = getDefaultImage();
                };

                var iNode = document.createElement("img");
                iNode.src = image_url;    // add the image URL to the DOM
                iNode.loading = "lazy";   // only load images if they are visable on the screen
                iNode.style.marginLeft = "5px";
                iNode.style.width = "100px";
                iNode.id = "C_" + item.Id;
                iNode.style.cursor = "pointer";

                pn.appendChild(iNode);
            };
            return displayedItemsIdStr.slice(0, -1);
        };
        //----------------------------------------------------------------------------------------------
        //
        //
        //
        //
        //
        //
        //
        //
        //
        //
        //
        //----------------------------------------------------------------------------------------------

        function collections_and_playlists(indexArray, currentItems, type) {  // type=true for collections

            console.log("=== indexArray = ", indexArray, ", current items = ", currentItems);

            hide_and_show_buttons(5);

            sideNode.style.display = "none";
            topPageTitleArea.style.display = "none";

            var pn = document.getElementById("page_node");
            while (pn.firstChild) { pn.firstChild.remove(); };

            let y1 = document.createElement("DIV");
            y1.innerHTML = (type) ? "<h1>Manage Collections</h1>" : "<h1>Manage Playlists</h1>";
            y1.style.textAlign = "center";
            pn.appendChild(y1);

            var x1x = document.createElement("Button");
            x1x.classList.add('page_button');
            x1x.innerHTML = "Cancel";
            x1x.id = "cancelBtn";
            pn.appendChild(x1x);
            pn.appendChild(document.createElement("BR"));

            let y2 = document.createElement("LABEL");
            y2.innerHTML = "<h2 style='display:inline-block'>Selected Items</h2>";
            pn.appendChild(y2);
    
            let len = indexArray.length;
            let items = [];

            for (let i = 0; i < len; i++) {
                let item = currentItems[indexArray[i]];
                items.push(item);
            };

            var selectedItemsIdStr = listImages(pn, items);

            

            //---------------------------------------------------------------------------------------------------------
            pn.appendChild(document.createElement("HR"));

            let y9 = document.createElement("LABEL");
            y9.innerHTML = (type) ? "<h2 style='display:inline-block'>Clicked item is in these Collections:</h2>" : "<h2 style='display:inline-block'>Clicked item is in these Playlists:</h2>";
            y9.style.display = "none";
            pn.appendChild(y9);

            let imagesInCollectionsDiv = document.createElement("DIV")
            pn.appendChild(imagesInCollectionsDiv); 

            console.log("=== ids string = ", selectedItemsIdStr);



            //----------------------------------------------------------------------------------------------
            //
            // event listener for selecting an image to get the collections it's in
            //
            pn.onclick = function (event) {
                event.preventDefault();

                console.log("=== event = ", event);

                let target = event.target;
                let id = target.id;

                let temp = id.split("_");

                if (temp[0] != "C") return;

                console.log("=== id = ", temp[1]);

                getCollectionsItemIsIn(temp[1], getCollections);
            };
            //----------------------------------------------------------------------------------------------





            //---------------------------------------------------------------------------------------------------------
            //
            //
            //
            //---------------------------------------------------------------------------------------------------------
            async function getCollectionsItemIsIn(item_ids_str, callback) {
                let url = (type) ? "Users/" + currentUserId + "/Items?Fields=MediaStreams,UserData&IncludeItemTypes=BoxSet&Recursive=true&ListItemIds="   + item_ids_str :
                                   "Users/" + currentUserId + "/Items?Fields=MediaStreams,UserData&IncludeItemTypes=Playlist&Recursive=true&ListItemIds=" + item_ids_str;
                console.log("=== url = ",url);
                let item_data = await ApiClient.getJSON(ApiClient.getUrl(url));
                callback(item_data);
            };
            //---------------------------------------------------------------------------------------------------------
            function getCollections(itemInCollections) {
                console.log("=== item is in these collections ", itemInCollections);
                let itemsArray = itemInCollections.Items;

                if (itemsArray.length > 0) y9.style.display = "block";

                while (imagesInCollectionsDiv.firstChild) { imagesInCollectionsDiv.firstChild.remove(); };

                itemsArray.forEach((item) => {
                    let name = item.Name;
                    let imageTag = item.ImageTags["Primary"];
                    let id = item.Id;
                    console.log("=== item name = ", name, ", imageTag = ", imageTag);

                    var image_url = server_url + "Items/" + id + "/Images/Primary?" + "maxHeight=300" + "&maxWidth=200" + "&tag=" + imageTag + "&quality=90";
                    let iNode = document.createElement("img");
                    iNode.src = image_url;    // add the image URL to the DOM
                    //iNode.loading = "lazy";   // only load images if they are visable on the screen
                    iNode.style.marginLeft = "5px";
                    iNode.style.width = "100px";
                    //iNode.style.height = "100px"; 
                    imagesInCollectionsDiv.appendChild(iNode);
                });
            };
            //---------------------------------------------------------------------------------------------------------

            pn.appendChild(document.createElement("HR"));

            let y3 = document.createElement("Div");
            y3.innerHTML = (type) ? "<h2>Select a Collection</h2>" : "<h2>Select a Playlist</h2>";
            y3.style.marginRight = "5px";
            pn.appendChild(y3);

            //-----------------------------------------------------------------------------------------------
            //
            // get all collections
            //
            //-----------------------------------------------------------------------------------------------

            getAllCollections( allCollections );

            //----------------------------------------------------------------------------------------------
            async function getAllCollections(callback) {
                let url = (type) ? "users/" + currentUserId + "/items?Fields=Genres%2CChildCount%2CRecursiveItemCount%2COverview&Recursive=true%2CTags&SortBy=SortName&SortOrder=Ascending&IncludeItemTypes=boxset" :
                                   "users/" + currentUserId + "/items?Fields=Genres%2CChildCount%2CRecursiveItemCount%2COverview&Recursive=true%2CTags&SortBy=SortName&SortOrder=Ascending&IncludeItemTypes=Playlist";

                console.log("=== url = ", url);
                let item_data = await ApiClient.getJSON(ApiClient.getUrl(url));
                callback(item_data);
            };
            //----------------------------------------------------------------------------------------------
            function allCollections(data) {
                console.log("=== All Collections = ", data);

                let x = document.createElement("SELECT");
                x.id = "allCollections";
                x.style.fontSize = "20px";

                let y = document.createElement("option");
                y.setAttribute("value", "*");
                y.innerText = (type) ? "Select a Collection" : "Select a Playlist"; 
                x.append(y);
                //
                // map to pulldown list
                //
                data.Items.map((item) => {
                    let z = document.createElement("option");
                    z.setAttribute("value", item.Id);
                    z.innerText = item.Name;
                    x.append(z);
                });
                pn.appendChild(x);
                //pn.appendChild( document.createElement("BR") );

                let dd2 = document.createElement("DIV");
                dd2.id = "collectionsArea";
                pn.appendChild(dd2);

                //pn.appendChild(document.createElement("BR"));
                //
                // add and remove buttons
                //
                let dd = document.createElement("DIV");
                dd.id = "addRemoveButtons";

                var xx = document.createElement("Button");
                xx.classList.add('page_button');
                xx.innerHTML = "Add";
                xx.id = "addItemToCollection";
                dd.appendChild(xx);
                //dd.appendChild( document.createElement("BR") );

                let y4 = document.createElement("LABEL");
                y4.innerHTML = (type) ? "<h2 style='display:inline-block; margin-left:10px'>the selected items to this Collection</h2>" : "<h2 style='display:inline-block; margin-left:10px'>the selected items to this Playlist</h2>";
                dd.appendChild(y4);

                pn.appendChild(dd);

                document.getElementById("addRemoveButtons").style.display = "none";

                let y8 = document.createElement("LABEL");
                y8.innerHTML = "<h2 style='display:inline-block; margin-right:10px'>Or</h2>";
                y8.id = "Or";
                pn.appendChild(y8);
                //
                // add create collection button
                //
                var zz = document.createElement("Button");
                zz.classList.add('page_button');
                zz.innerHTML = "Create";
                zz.id = "createNewCollection";
                zz.marginRight = "10px";
                pn.appendChild(zz);

                let y6 = document.createElement("LABEL");
                y6.innerHTML = (type) ? "<h2 style='display:inline-block; margin-left:10px'>a New Collection</h2>" : "<h2 style='display:inline-block; margin-left:10px'>a New Playlist</h2>";
                y6.id = "createNew";
                pn.appendChild(y6);
                //
                // add input area for create collection name
                //
                pn.appendChild(document.createElement("BR"));
                let x1 = document.createElement("INPUT");
                x1.style.fontSize = "20px";
                x1.setAttribute("type", "text");
                x1.setAttribute("value", "");
                x1.setAttribute("size", "30");
                x1.setAttribute("maxlength", "50");
                x1.setAttribute("placeholder", (type) ? "Enter New Collection Name" : "Enter New Playlist Name");
                x1.id = "createCollectionName";
                pn.appendChild(x1);

                pn.appendChild(document.createElement("BR"));
                pn.appendChild(document.createElement("BR"));
                //-----------------------------------------------------------------------------------------------
                //
                //-----------------------------------------------------------------------------------------------
                document.getElementById("allCollections").onchange = function (event) {
                    event.preventDefault();
                    selectedCollectionId = this.value;

                    console.log("=== On Change Collection === ", this.value);

                    if (selectedCollectionId == "*") {
                        document.getElementById("addRemoveButtons").style.display = "none";
                        document.getElementById("createNewCollection").style.display = "inline-block";
                        document.getElementById("Or").style.display = "inline-block";
                        document.getElementById("createNew").style.display = "inline-block";
                        document.getElementById("createCollectionName").style.display = "block";
                        return;
                    };

                    document.getElementById("addRemoveButtons").style.display = "block";
                    document.getElementById("createNewCollection").style.display = "none";
                    document.getElementById("Or").style.display = "none";
                    document.getElementById("createNew").style.display = "none";
                    document.getElementById("createCollectionName").style.display = "none";
                };
                //----------------------------------------------------------------------------------------------
                //
                // event listeners for the buttons
                //
                document.getElementById("addItemToCollection").onclick = function (event) {
                    event.preventDefault();

                    var url = (type) ? "Collections/" + selectedCollectionId + "/Items?Ids=" + selectedItemsIdStr + "&api_key=" + accessToken :
                                       "Playlists/"   + selectedCollectionId + "/Items?Ids=" + selectedItemsIdStr + "&api_key=" + accessToken;

                    var Http = new XMLHttpRequest();
                    Http.open('POST', ApiClient.getUrl(url));
                    Http.send();

                    finished();
                };
                //----------------------------------------------------------------------------------------------
                document.getElementById("createNewCollection").onclick = function (event) {
                    event.preventDefault();

                    let name = document.getElementById("createCollectionName").value;
                    if (!name) return;

                    url = (type) ? "Collections?Name=" + name + "&Ids=" + selectedItemsIdStr + "&api_key=" + accessToken :
                                   "Playlists?Name="   + name + "&Ids=" + selectedItemsIdStr + "&api_key=" + accessToken;

                    var Http = new XMLHttpRequest();
                    Http.open('POST', ApiClient.getUrl(url));
                    Http.send();

                    finished();
                };
                //----------------------------------------------------------------------------------------------
                document.getElementById("cancelBtn").onclick = function (event) {
                    event.preventDefault();
                    finished();
                };

            };
            
            //----------------------------------------------------------------------------------------------
        };



        //----------------------------------------------------------------------------------------------
        //
        //
        //
        //
        //
        //
        //
        //
        //
        //
        //
        //----------------------------------------------------------------------------------------------

        var showWithTag = 0;
        var showWithGenre = 0;
        var filter_selectedIndex = [];  // used to save and restore filter selections
        var filter_string = "";

        function emby_filters() {

            //console.log("=== Emby Filters ===");

            hide_and_show_buttons(2);

            sideNode.style.display = "none";
            topPageTitleArea.style.display = "none";

            apply_btn.style.display = "inline-block";
            reset_btn.style.display = "inline-block";

            var pn = document.getElementById("page_node");
            while (pn.firstChild) { pn.firstChild.remove(); };

            //
            //   capture clicks on the page node
            //
            pn.onclick = function (data) { filter_click(data) };

            //
            //   button event listeners
            //
            apply_btn.onclick = function (event) { apply(event) };
            reset_btn.onclick = function (event) { reset(event) };

            //----------------------------------------------------------------------------------------------
            function apply(event) {
                event.preventDefault();
                //console.log("___________ apply Btn _____________");

                filter_string = getFilterString();
                //console.log("=== Filter String = ", filter_string);

                sideNode.style.display = "inline-block";
                topPageTitleArea.style.display = "inline-block";
                //apply_btn.style.display = "none";
                //reset_btn.style.display = "none";

                if (pageStack.length > 0) {
                    hide_and_show_buttons(3);

                    let temp = pageStack[pageStack.length - 1];
                    let url            = temp[0];
                    let dimensions     = temp[1];
                    let name           = temp[2].Name;
                    let scrollPosition = temp[3];
                    let pageType       = getType(temp[2]);

                    //console.log("=== Start Filtering");

                    loader.classList.remove("loader-hidden");   //   show spinner

                    getPage(url, dimensions, name, scrollPosition, pageType);

                } else {
                    goHome();
                };

                return;
            };
            //----------------------------------------------------------------------------------------------
            function reset(event) {
                event.preventDefault();
                //console.log("___________ reset Btn _____________");

                filter_string = "";
                resetFilters(false);

                return;
            };
            //----------------------------------------------------------------------------------------------
            //
            // add all of the filters
            //
            add_emby_filters(pn);
            //
            //
            //
            function add_emby_filters(pn) {

                let aa = [["", "Sort By ?"],
                ["SortBy=Album", "Sort By Album"],
                ["SortBy=AlbumArtist", "Sort By Album Artist"],
                ["SortBy=Artist", "Sort By Artist"],
                ["SortBy=Budget", "Sort By Budget"],
                ["SortBy=CommunityRating", "Sort By Community Rating"],
                ["SortBy=CriticRating", "Sort By Critic Rating"],
                ["SortBy=DateCreated", "Sort By Date Added"],
                ["SortBy=DatePlayed", "Sort By Date Played"],
                ["SortBy=PlayCount", "Sort By Play Count"],
                ["SortBy=PremiereDate", "Sort By Premiere Date"],
                ["SortBy=ProductionYear", "Sort By Production Year"],
                ["SortBy=SortName", "Sort By Name"],
                ["SortBy=Revenue", "Sort By Revenue"],
                ["SortBy=Runtime", "Sort By Runtime"],
                ["SortBy=Random", "Sort By Random"]];

                let bb = [["", "Sort By Direction ?"],
                ["SortOrder=Ascending", "Ascending"],
                ["SortOrder=Descending", "Descending"]];

                let cc = [["", "Has Theme Video ?"],
                ["HasThemeVideo=false", "Has Theme Video = false"],
                ["HasThemeVideo=true", "Has Theme Video = true"]];

                let dd = [["", "Filters ?"],
                ["Filters=IsFolder", "Is Folder"],
                ["Filters=IsNotFolder", "Is Not Folder"],
                ["Filters=IsUnplayed", "Is Unplayed"],
                ["Filters=IsPlayed", "Is Played"],
                ["Filters=IsFavorite", "Is Favorite"],
                ["Filters=IsResumable", "Is Resumable"],
                ["Filters=Likes", "Has Likes"],
                ["Filters=Dislikes", "Has Dislikes"]];

                let ee = [["", "Is Locked ?"],
                ["IsLocked=false", "Is Locked = false"],
                ["IsLocked=true", "Is Locked = true"]];

                let ff = [["", "Is Played ?"],
                ["IsPlayed=false", "Is Played = false"],
                ["IsPlayed=true", "Is Played = true"]];

                let gg = [["", "Is Sports ?"],
                ["IsSports=false", "Is Sports = false"],
                ["IsSports=true", "Is Sports = true"]];

                let hh = [["", "Not Implemented"],
                ["", ""],
                ["", ""]];

                let ii = [["", "Is Kids ?"],
                ["IsKids=false", "Is Kids = false"],
                ["IsKids=true", "Is Kids = true"]];

                let jj = [["", "Is News ?"],
                ["IsNews=false", "Is News = false"],
                ["IsNews=true", "Is News = true"]];

                let kk = [["", "Is Series ?"],
                ["IsSeries=false", "Is Series = false"],
                ["IsSeries=true", "Is Series = true"]];

                let mm = [["", "Is Movie ?"],
                ["IsMovie=false", "Is Movie = false"],
                ["IsMovie=true", "Is Movie = true"]];

                let nn = [["", "Is Favorite ?"],
                ["IsFavorite=false", "Is Favorite = false"],
                ["IsFavorite=true", "Is Favorite = true"]];

                let pp = [["", "Is Unaired ?"],
                ["IsUnaired=false", "Is Unaired = false"],
                ["IsUnaired=true", "Is Unaired = true"]];

                let qq = [["", "Is HD ?"],
                ["IsHD=false", "Is HD = false"],
                ["IsHD=true", "Is HD = true"]];

                let rr = [["", "Has Overview ?"],
                ["HasOverview=false", "Has Overview = false"],
                ["HasOverview=true", "Has Overview = true"]];

                let ss = [["", "Has Local Trailers ?"],
                ["HasTrailer=false", "Has Local Trailers = false"],
                ["HasTrailer=true", "Has Local Trailers = true"]];

                let tt = [["", "Has Theme Song ?"],
                ["HasThemeSong=false", "Has Theme Song = false"],
                ["HasThemeSong=true", "Has Theme Song = true"]];

                let uu = [["", "Has Subtitles ?"],
                ["HasSubtitles=false", "Has Subtitles = false"],
                ["HasSubtitles=true", "Has Subtitles = true"]];

                let vv = [["", "Include Item Types ?"],
                ["IncludeItemTypes=Movie", "Include Item Types, Movie"],
                ["IncludeItemTypes=Video", "Include Item Types, Video"],
                ["IncludeItemTypes=Series", "Include Item Types, Series"],
                ["IncludeItemTypes=Season", "Include Item Types, Season"],
                ["IncludeItemTypes=Episode", "Include Item Types, Episode"],
                ["IncludeItemTypes=MusicVideo", "Include Item Types, Music Video"],
                ["IncludeItemTypes=Audio", "Include Item Types, Audio"],
                ["IncludeItemTypes=CollectionFolder", "Include Item Types, Collection Folder"],
                ["IncludeItemTypes=Folder", "Include Item Types, Folder"],
                ["IncludeItemTypes=BoxSet", "Include Item Types, BoxSet"],
                ["IncludeItemTypes=PhotoAlbum", "Include Item Types, Photo Album"],
                ["IncludeItemTypes=Photo", "Include Item Types, Photo"],
                ["IncludeItemTypes=Playlist", "Include Item Types, Playlist"],
                ["IncludeItemTypes=UserView", "Include Item Types, User View"]];

                let ww = [["", "Exclude Item Types ?"],
                ["ExcludeItemTypes=Movie", "Exclude Item Types, Movie"],
                ["ExcludeItemTypes=Video", "Exclude Item Types, Video"],
                ["ExcludeItemTypes=Series", "Exclude Item Types, Series"],
                ["ExcludeItemTypes=Season", "Exclude Item Types, Season"],
                ["ExcludeItemTypes=Series,Season", "Exclude Types, Series & Season"],
                ["ExcludeItemTypes=Episode", "Exclude Item Types, Episode"],
                ["ExcludeItemTypes=MusicVideo", "Exclude Item Types, Music Video"],
                ["ExcludeItemTypes=Audio", "Exclude Item Types, Audio"],
                ["ExcludeItemTypes=CollectionFolder", "Exclude Item Types, Collection Folder"],
                ["ExcludeItemTypes=Folder", "Exclude Item Types, Folder"],
                ["ExcludeItemTypes=BoxSet", "Exclude Item Types, BoxSet"],
                ["ExcludeItemTypes=PhotoAlbum", "Exclude Item Types, Photo Album"],
                ["ExcludeItemTypes=Photo", "Exclude Item Types, Photo"],
                ["ExcludeItemTypes=Playlist", "Exclude Item Types, Playlist"],
                ["ExcludeItemTypes=UserView", "Exclude Item Types, User View"]];

                let xx = [["", "Media Types ?"],
                ["MediaTypes=Video", "Media Type, Video"],
                ["MediaTypes=Audio", "Media Type, Audio"],
                ["MediaTypes=Photo", "Media Type, Photo"],
                ["MediaTypes=Playlist", "Media Type, Playlist"]];

                let yy = [["", "Not Implemented"],
                ["", ""],
                ["", ""]];

                let zz = [["", "Min Parental Rating ?"],
                ["MinOfficialRating=TV-Y", "Min = TV-Y APPROVED (1)"],
                ["MinOfficialRating=TV-G", "Min = G E EC TV-G FSK-0 (1)"],
                ["MinOfficialRating=TV-Y7", "Min = TV-Y7 (3)"],
                ["MinOfficialRating=TV-Y7-FV", "Min = TV-Y7-FV (4)"],
                ["MinOfficialRating=PG", "Min = G TV-PG FSK-6 (5)"],
                ["MinOfficialRating=PG-13", "Min = PG-13 T FSK-12 (7)<"],
                ["MinOfficialRating=TV-14", "Min = TV-14 FSK-16 (8)"],
                ["MinOfficialRating=TV-MA", "Min = R M TV-MA FSK-18 (9)"],
                ["MinOfficialRating=NC-17", "Min = NC-17 (10)"],
                ["MinOfficialRating=NR", "Min = AO RP UR NR X (15)"],
                ["MinOfficialRating=XXX", "Min = XXX (100)"]];

                let a1 = [["", "Max Parental Rating ?"],
                ["MaxOfficialRating=TV-Y", "Max = TV-Y APPROVED (1)"],
                ["MaxOfficialRating=TV-G", "Max = G E EC TV-G FSK-0 (1)"],
                ["MaxOfficialRating=TV-Y7", "Max = TV-Y7 (3)"],
                ["MaxOfficialRating=TV-Y7-FV", "Max = TV-Y7-FV (4)"],
                ["MaxOfficialRating=PG", "Max = G TV-PG FSK-6 (5)"],
                ["MaxOfficialRating=PG-13", "Max = PG-13 T FSK-12 (7)<"],
                ["MaxOfficialRating=TV-14", "Max = TV-14 FSK-16 (8)"],
                ["MaxOfficialRating=TV-MA", "Max = R M TV-MA FSK-18 (9)"],
                ["MaxOfficialRating=NC-17", "Max = NC-17 (10)"],
                ["MaxOfficialRating=NR", "Max = AO RP UR NR X (15)"],
                ["MaxOfficialRating=XXX", "Max = XXX (100)"]];

                let b1 = [["", "Video Type ?"],
                ["Is4K=true", "4K"],
                ["IsHD=true", "HD"],
                ["IsHd=false", "SD"],
                ["Is3D=true", "3D"],
                ["VideoTypes=dvd", "DVD"],
                ["VideoTypes=bluray", "BluRay"],
                ["VideoTypes=iso", "ISO"]];

                let c1 = [[0, "Has a tag ?"],
                [1, "Has a tag = false"],
                [2, "Has a tag = true"]];

                let d1 = [[0, "Has a genre ?"],
                [1, "Has a genre = false"],
                [2, "Has a genre = true"]];

                let e1 = [["", "Min Community Rating ?"],
                ["MinCommunityRating=1.0", "MinCommunityRating=1.0"],
                ["MinCommunityRating=1.5", "MinCommunityRating=1.5"],
                ["MinCommunityRating=2.0", "MinCommunityRating=2.0"],
                ["MinCommunityRating=2.5", "MinCommunityRating=2.5"],
                ["MinCommunityRating=3.0", "MinCommunityRating=3.0"],
                ["MinCommunityRating=3.5", "MinCommunityRating=3.5"],
                ["MinCommunityRating=4.0", "MinCommunityRating=4.0"],
                ["MinCommunityRating=4.5", "MinCommunityRating=4.5"],
                ["MinCommunityRating=5.0", "MinCommunityRating=5.0"],
                ["MinCommunityRating=5.5", "MinCommunityRating=5.5"],
                ["MinCommunityRating=6.0", "MinCommunityRating=6.0"],
                ["MinCommunityRating=6.5", "MinCommunityRating=6.5"],
                ["MinCommunityRating=7.0", "MinCommunityRating=7.0"],
                ["MinCommunityRating=7.5", "MinCommunityRating=7.5"],
                ["MinCommunityRating=8.0", "MinCommunityRating=8.0"],
                ["MinCommunityRating=8.5", "MinCommunityRating=8.5"],
                ["MinCommunityRating=9.0", "MinCommunityRating=9.0"],
                ["MinCommunityRating=9.5", "MinCommunityRating=9.5"]];

                let f1 = [["", "Min Critic Rating ?"],
                ["MinCriticRating=10", "MinCriticRating=10"],
                ["MinCriticRating=15", "MinCriticRating=15"],
                ["MinCriticRating=20", "MinCriticRating=20"],
                ["MinCriticRating=25", "MinCriticRating=25"],
                ["MinCriticRating=30", "MinCriticRating=30"],
                ["MinCriticRating=35", "MinCriticRating=35"],
                ["MinCriticRating=40", "MinCriticRating=40"],
                ["MinCriticRating=45", "MinCriticRating=45"],
                ["MinCriticRating=50", "MinCriticRating=50"],
                ["MinCriticRating=55", "MinCriticRating=55"],
                ["MinCriticRating=60", "MinCriticRating=60"],
                ["MinCriticRating=65", "MinCriticRating=65"],
                ["MinCriticRating=70", "MinCriticRating=70"],
                ["MinCriticRating=75", "MinCriticRating=75"],
                ["MinCriticRating=80", "MinCriticRating=80"],
                ["MinCriticRating=85", "MinCriticRating=85"],
                ["MinCriticRating=90", "MinCriticRating=90"],
                ["MinCriticRating=95", "MinCriticRating=95"]];

                pn.appendChild(document.createElement("BR"));

                pn.appendChild(make_pulldown(aa, 0));
                pn.appendChild(make_pulldown(bb, 1));
                pn.appendChild(make_pulldown(cc, 2));
                pn.appendChild(make_pulldown(dd, 3));
                pn.appendChild(make_pulldown(ee, 4));
                pn.appendChild(make_pulldown(ff, 5));

                pn.appendChild(make_pulldown(gg, 6));
                pn.appendChild(make_pulldown(hh, 7));

                pn.appendChild(make_pulldown(ii, 8));
                pn.appendChild(make_pulldown(jj, 9));
                pn.appendChild(make_pulldown(kk, 10));
                pn.appendChild(make_pulldown(mm, 11));
                pn.appendChild(make_pulldown(nn, 12));
                pn.appendChild(make_pulldown(pp, 13));
                pn.appendChild(make_pulldown(qq, 14));
                pn.appendChild(make_pulldown(rr, 15));
                pn.appendChild(make_pulldown(ss, 16));
                pn.appendChild(make_pulldown(tt, 17));
                pn.appendChild(make_pulldown(uu, 18));
                pn.appendChild(make_pulldown(vv, 19));
                pn.appendChild(make_pulldown(ww, 20));
                pn.appendChild(make_pulldown(xx, 21));
                pn.appendChild(make_pulldown(yy, 22));
                pn.appendChild(make_pulldown(zz, 23));
                pn.appendChild(make_pulldown(a1, 24));
                pn.appendChild(make_pulldown(b1, 25));

                pn.appendChild(make_pulldown(e1, 32));
                pn.appendChild(make_pulldown(f1, 33));


                create_filter_input(pn, "tagFilter", "Search for Tags", "90", "Comma delimeted Tags");
                create_filter_input(pn, "genFilter", "Search for Genres", "90", "Comma delimeted Genres");
                create_filter_input(pn, "searchFilter", "Search for String", "90", "Search String");
                create_filter_input(pn, "videoCodecFilter", "Search for Video Codec", "90", "Comma delimeted Codec Names");
                create_filter_input(pn, "audioCodecFilter", "Search for Audio Codec", "90", "Comma delimeted Codec Names");
                create_filter_input(pn, "subtitlesCodecFilter", "Search for Subtitle Codec", "90", "Comma delimeted Codec Names");
                create_filter_input(pn, "albumsFilter", "Search for Albums", "90", "Comma delimeted Album names");
                create_filter_input(pn, "artistsFilter", "Search for Artists", "90", "Comma delimeted Artist names");
                create_filter_input(pn, "studiosFilter", "Search for Studios", "90", "Comma delimeted Studio names");
                create_filter_input(pn, "imdbFilter", "Search for imdb/tmdb/tvdb/omdb ids", "20000", "Example imdb.tt4513678,imdb.tt9032400, ..."); // (imdb,tmdb,tvdb,omdb)


                pn.appendChild(document.createElement("BR"));
                pn.appendChild(document.createElement("BR"));
                //
                // show with tag and show with genre buttons
                //
                pn.appendChild(make_pulldown(c1, 30, "showWithTag"));
                pn.appendChild(make_pulldown(d1, 31, "showWithGenre"));
                //
                //
                //
                let msgDiv = document.createElement("DIV");
                msgDiv.innerHTML = "<h3>Notes:<br>1) If your filter gives no or unexpected results then consider including in your filter 'include Item Type' for the item type that you are searching across<br>2) All searches are recursive</h3>";
                pn.appendChild(msgDiv);
                //
                //   restore the status of each emby button
                //
                setFilters();

                return pn;
            };
            //---------------------------------------------------------------------
            function make_pulldown(A, id, className) {
                let x = document.createElement("SELECT");
                x.name = "pulldown";
                x.id = "filter_" + id;
                x.className = (className) ? className : "filterPulldown";
                x.style.width = "200px";
                x.style.height = "30px";
                x.style.fontSize = "14px";
                x.style.textAlign = "center";
                x.style.marginLeft = "8px";
                x.style.marginBottom = "6px";
                x.style.background = "blue";
                x.style.color = "white";
                let cnt = A.length;
                for (let i = 0; i < cnt; i++) {
                    let y = document.createElement("option");
                    y.setAttribute("value", A[i][0]);
                    y.innerText = A[i][1];
                    x.appendChild(y);
                };
                return x;
            };
            //---------------------------------------------------------------------
            function setFilters() {
                let allFilters = document.querySelectorAll(".filterPulldown");
                let cnt = allFilters.length;
                //
                // restore the status of all emby filters
                //
                for (var i = 0; i < cnt; i++) {
                    let index = filter_selectedIndex[i];

                    allFilters[i].selectedIndex = index;

                    if (index > 0) {
                        allFilters[i].style.background = "purple";
                    };
                };
                //
                // make sure the button color for the showWithTag and showWithGenre are set correct
                //
                let swt = document.querySelector(".showWithTag");
                if (showWithTag == 0) { swt.value = 0; swt.style.background = "blue"; }
                else if (showWithTag == 1) { swt.value = 1; swt.style.background = "purple"; }
                else if (showWithTag == 2) { swt.value = 2; swt.style.background = "purple"; };

                let swg = document.querySelector(".showWithGenre");
                if (showWithGenre == 0) { swg.value = 0; swg.style.background = "blue"; }
                else if (showWithGenre == 1) { swg.value = 1; swg.style.background = "purple"; }
                else if (showWithGenre == 2) { swg.value = 2; swg.style.background = "purple"; };
            };


            //---------------------------------------------------------------------
            function filter_click(data) {
                let target = data.target;
                //console.log("=== Pulldown Clicked ===", target);

                if (target.name == "pulldown") {
                    let id = target.id.split("_")[1];
                    let value = target.value;
                    let pd = document.getElementById("filter_" + id);

                    if (value == "" || value == 0) pd.style.background = "blue"; else pd.style.background = "purple";
                    //console.log("=== id = " + id + ", value = " + value);
                };
            };

            //---------------------------------------------------------------------
            function create_filter_input(node, id, lblText, maxLength, placeholder) {
                node.appendChild(document.createElement("BR"));

                var lbl = document.createElement("LABEL");
                lbl.innerHTML = '<span style="font-size:16px; margin-left:10px; margin-right:10px;">' + lblText + '</span>';
                lbl.style.display = "inline-block";
                lbl.style.width = "290px";
                node.appendChild(lbl);

                x = document.createElement("INPUT");
                x.id = id;
                x.setAttribute("type", "text");
                x.setAttribute("value", "");
                x.setAttribute("size", "40");
                x.setAttribute("maxlength", maxLength);
                x.setAttribute("placeholder", placeholder);
                x.setAttribute("autocomplete", "off");
                x.className = "textFilter";
                node.appendChild(x);
            };
        };

        //---------------------------------------------------------------------
        function getFilterString() {
            let filter_str = "";
            let allFilters = document.querySelectorAll(".filterPulldown");
            let cnt = allFilters.length;
            //
            // collect and save the status of all emby filters
            //
            for (var i = 0; i < cnt; i++) {
                let a = allFilters[i];
                if (a.value != "") filter_str += "&" + a.value;
                filter_selectedIndex[i] = a.selectedIndex;
            };
            //
            //   create the emby filter string that will be added to the API urls
            //
            filter_str = filter_str + addTags() + addGens() + addSearch() + addVideoCodecs() + addAudioCodecs() + addProviderImdbPairs() + addAlbums() + addArtists() + addSubtitleCodecs() + addStudios();

            //console.log("=== Filter Str = ", filter_str);

            let swt = document.querySelector(".showWithTag");
            showWithTag = swt.value;

            let swg = document.querySelector(".showWithGenre");
            showWithGenre = swg.value;

            return filter_str;
        };
        //---------------------------------------------------------------------
        function resetFilters(skipInputs) {
            let allFilters = document.querySelectorAll(".filterPulldown");
            let cnt = allFilters.length;
            for (var i = 0; i < cnt; i++) {
                allFilters[i].selectedIndex = 0;
                allFilters[i].style.background = "blue";
            };
            filter_string = "";
            filter_selectedIndex = [];

            showWithTag = 0;
            showWithGenre = 0;

            if (skipInputs) return;

            document.getElementById("tagFilter").value = "";
            document.getElementById("genFilter").value = "";
            document.getElementById("searchFilter").value = "";
            document.getElementById("videoCodecFilter").value = "";
            document.getElementById("audioCodecFilter").value = "";
            document.getElementById("subtitlesCodecFilter").value = "";
            document.getElementById("artistsFilter").value = "";
            document.getElementById("albumsFilter").value = "";
            document.getElementById("studiosFilter").value = "";
            document.getElementById("imdbFilter").value = "";

            let swt = document.querySelector(".showWithTag");
            swt.value = 0;
            swt.style.background = "blue";

            let swg = document.querySelector(".showWithGenre");
            swg.value = 0;
            swg.style.background = "blue";
        };

        //---------------------------------------------------------------------
        function addTags() {
            var tagStr = document.getElementById("tagFilter").value;
            //console.log("=== tagStr = ",tagStr);

            var a1 = tagStr.split(",");
            //console.log("=== a1 = ",a1);
            var a2 = [];
            a1.map(g => { a2.push(g.trim().replace(/\s+/g, '%20')) });
            //console.log("=== a2 = ",a2);
            a2 = a2.join("|");
            //console.log("=== a2 = ",a2);

            if (a2 == "") {
                //console.log("=== Tag Str Empty");
                return "";
            } else {
                var k = "&Tags=" + a2;
                //console.log("=== Tag Str = ",k);
                return k;
            };
        };
        //---------------------------------------------------------------------
        function addGens() {
            var genStr = document.getElementById("genFilter").value;
            //console.log("=== genStr = ",genStr);

            var a1 = genStr.split(",");
            //console.log("=== a1 = ",a1);
            var a2 = [];
            a1.map(g => { a2.push(g.trim().replace(/\s+/g, '%20')) });
            //console.log("=== a2 = ",a2);
            a2 = a2.join("|");
            //console.log("=== a2 = ",a2);

            if (a2 == "") {
                return "";
            } else {
                return "&Genres=" + a2;
            };
        };
        //---------------------------------------------------------------------
        function addSearch() {
            var searchStr = document.getElementById("searchFilter").value;
            var s1 = searchStr.trim();
            if (s1 == "") return "";

            var s2 = s1.split(" ").join("%20");
            return "&SearchTerm=" + s2;
        };
        //---------------------------------------------------------------------
        function addVideoCodecs() {
            var codecStr = document.getElementById("videoCodecFilter").value;
            var s1 = codecStr.replace(/\s+/g, '');
            var s2 = s1.split(",").join("%2C").toLowerCase();

            if (s2 == "") {
                return "";
            } else {
                return "&VideoCodecs=" + s2;
            };
        };
        //---------------------------------------------------------------------
        function addAudioCodecs() {
            var codecStr = document.getElementById("audioCodecFilter").value;
            var s1 = codecStr.replace(/\s+/g, '');
            var s2 = s1.split(",").join("%2C").toLowerCase();

            if (s2 == "") {
                return "";
            } else {
                return "&AudioCodecs=" + s2;
            };
        };

        //---------------------------------------------------------------------
        function addSubtitleCodecs() {
            var codecStr = document.getElementById("subtitlesCodecFilter").value;
            var s1 = codecStr.replace(/\s+/g, '');
            var s2 = s1.split(",").join("%2C").toLowerCase();

            if (s2 == "") {
                return "";
            } else {
                return "&SubtitleCodecs=" + s2;
            };
        };
        //---------------------------------------------------------------------
        function addArtists() {
            var str = document.getElementById("artistsFilter").value;
            var s1 = str.replace(/\s+/g, '%20');
            var s2 = s1.split(",").join("%7C"); //.toLowerCase();

            if (s2 == "") {
                return "";
            } else {
                return "&Artists=" + s2;
            };
        };
        //---------------------------------------------------------------------
        function addAlbums() {
            var str = document.getElementById("albumsFilter").value;
            var s1 = str.replace(/\s+/g, '%20');
            var s2 = s1.split(",").join("%7C"); //.toLowerCase();

            if (s2 == "") {
                return "";
            } else {
                return "&Albums=" + s2;
            };
        };
        //---------------------------------------------------------------------
        function addStudios() {
            var str = document.getElementById("studiosFilter").value;
            var s1 = str.replace(/\s+/g, '%20');
            var s2 = s1.split(",").join("%7C"); //.toLowerCase();

            if (s2 == "") {
                return "";
            } else {
                return "&Studios=" + s2;
            };
        };

        //---------------------------------------------------------------------
        function addProviderImdbPairs() {
            var imdbStr = document.getElementById("imdbFilter").value;
            var s1 = imdbStr.replace(/\s+/g, '');
            var s2 = s1.split(",").join("%2C");

            if (s2 == "") {
                return "";
            } else {
                var k = "&AnyProviderIdEquals=" + s2;
                //myConsoleLog("=== Imdb Str = "+k);
                return k;
            };
        };




        // --------------------------------------------------
        //
        //
        //
        //
        //
        //
        //
        //
        //
        //
        //
        // --------------------------------------------------
        function create_master_obj() {
            let item_data = {};
            let temp;

            item_data.Path = "";
            item_data.OriginalTitle = "";
            item_data.Name = "";
            item_data.SortName = "";
            item_data.Taglines = [];
            item_data.Overview = "";

            temp = document.getElementById("V_6").value; if (temp != "") item_data.OfficialRating = temp;
            temp = document.getElementById("V_7").value; if (temp != "") item_data.CommunityRating = temp;
            temp = document.getElementById("V_8").value; if (temp != "") item_data.PremiereDate = temp;
            temp = document.getElementById("V_9").value; if (temp != "") item_data.ProductionYear = temp;
            //temp = document.getElementById("V_10").value; if (temp != "") item_data.ProviderIds["imdb"] = temp;         //   <--------------<<<<<<  not needed in the master obj
            //temp = document.getElementById("V_11").value; if (temp != "") item_data.ProviderIds["Tmdb"] = temp;         //   <--------------<<<<<<  not needed in the master obj
            temp = document.getElementById("V_12").value; if (temp != "") item_data.DateCreated = temp;

            item_data.LocalTrailerCount = "";
            item_data.RemoteTrailers = "";
            item_data.IsFolder = "";
            item_data.Width = "";
            item_data.Height = "";
            item_data.Container = "";

            temp = document.getElementById("V_19").value; if (temp != "") item_data.CustomRating = temp;

            item_data.RunTimeTicks = "";
            item_data.Size = "";
            //
            //   get tags, genres and studios
            //
            let obj_tag_value = document.getElementById("V_39").value;     // tags
            let obj_genre_value = document.getElementById("V_40").value;   // genres
            let obj_studio_value = document.getElementById("V_41").value;  // studios

            item_data["TagValue"] = obj_tag_value.trim();
            item_data["GenreValue"] = obj_genre_value.trim();
            item_data["StudioValue"] = obj_studio_value.trim();

            //console.log("=== tagValue = ", obj_tag_value);
            //console.log("=== p_39 ", document.getElementById("P_39"));

            item_data["TagAction"] = document.getElementById("P_39").value;     // action for tags
            item_data["GenreAction"] = document.getElementById("P_40").value;   // action for genres
            item_data["StudioAction"] = document.getElementById("P_41").value;  // action for studios

            // let tags_array = obj_tag_value.split(",");
            // let tags_set = new Set(tags_array);
            // let tagsArr = Array.from(tags_set);
            // item_data.TagItems = (tagsArr.length>0) ? tagsArr : [];

            // let genre_array = obj_genre_value.split(",");
            // let genre_set = new Set(genre_array);
            // let genreArr = Array.from(genre_set);
            // item_data.GenreItems = (genreArr.length>0) ? genreArr : [];

            // let studio_array = obj_studio_value.split(",");
            // let studio_set = new Set(studio_array);
            // let studioArr = Array.from(studio_set);
            // item_data.Studios = (studioArr.length>0) ? studioArr : [];

            //............................................
            let lock_Name = document.getElementById("V_22").value;
            let lock_OR = document.getElementById("V_23").value;
            let lock_Genres = document.getElementById("V_24").value;
            let lock_Cast = document.getElementById("V_25").value;
            let lock_Studios = document.getElementById("V_26").value;
            let lock_Tags = document.getElementById("V_27").value;
            let lock_Overview = document.getElementById("V_28").value;
            //............................................
            // save individual locks
            let LockedFields = [];

            if (lock_Name == "Locked") LockedFields.push("Name");
            if (lock_OR == "Locked") LockedFields.push("OfficialRating");
            if (lock_Genres == "Locked") LockedFields.push("Genres");
            if (lock_Cast == "Locked") LockedFields.push("Cast");
            if (lock_Studios == "Locked") LockedFields.push("Studios");
            if (lock_Tags == "Locked") LockedFields.push("Tags");
            if (lock_Overview == "Locked") LockedFields.push("Overview");

            item_data.LockedFields = LockedFields;
            //............................................
            //
            // save "lock all" locks
            //
            let lock_All = document.getElementById("V_29").value;
            if (lock_All != "") item_data.LockData = (lock_All == "true") ? true : false;


            //............................................
            //
            // "played" and "favorite" are stored separate in the DB from other item data
            //
            let temp1 = document.getElementById("V_30").value;
            let temp2 = document.getElementById("V_31").value;
            if ((temp1 != "") || (temp2 != "")) {
                item_data.UserData = {};
                if (temp1 != "") item_data.UserData.IsFavorite = (temp1 === "true") ? true : false;
                if (temp2 != "") item_data.UserData.Played = (temp2 === "true") ? true : false;
            };

            return item_data;
        };


        // --------------------------------------------------
        //   
        // --------------------------------------------------
        function update_values_from_master(item_data, master_obj) {
            let temp;
            //item_data.Path
            //item_data.OriginalTitle         = document.getElementById("V_1").value;
            //item_data.Name                  = document.getElementById("V_2").value;                 
            //item_data.SortName              = document.getElementById("V_3").value;
            //item_data.Taglines[0]           = document.getElementById("V_4").value;
            //item_data.Overview              = document.getElementById("V_5").value;
            temp = master_obj.OfficialRating; if (temp != "") item_data.OfficialRating = temp;
            temp = master_obj.CommunityRating; if (temp) item_data.CommunityRating = temp;
            temp = master_obj.PremiereDate; if (temp != "") item_data.PremiereDate = temp;
            temp = master_obj.ProductionYear; if (temp != "") item_data.ProductionYear = temp;


            if (typeof master_obj.ProviderIds != "undefined") {
                temp = master_obj.ProviderIds; if (temp != "") item_data.ProviderIds.Imdb = temp;
                temp = master_obj.ProviderIds; if (temp != "") item_data.ProviderIds.Tmdb = temp;
            };


            temp = master_obj.DateCreated; if (temp != "") item_data.DateCreated = temp;
            //item_data.LocalTrailerCount     = document.getElementById("V_13").value;
            //item_data.RemoteTrailers.length = document.getElementById("V_14").value;
            //item_data.IsFolder              = document.getElementById("V_15").value;
            //item_data.Width                 = document.getElementById("V_16").value;
            //item_data.Height                = document.getElementById("V_17").value;
            //item_data.Container             = document.getElementById("V_18").value;
            temp = master_obj.CustomRating; if (temp != "") item_data.CustomRating = temp;
            //((item_data.RunTimeTicks/10000000)/60).toFixed(0)
            //(item_data.Size/1000000).toFixed(0)
            //
            let tagStr = master_obj.TagValue;
            let genreStr = master_obj.GenreValue;
            let studioStr = master_obj.StudioValue;
            //
            //   get tag, genre and studio actions
            //
            let tagAction = item_data.TagAction;
            let genreAction = item_data.GenreAction;
            let studioAction = item_data.StudioAction;



            let tt = strToArray(master_obj.TagValue);
            let gg = strToArray(master_obj.GenreValue);
            let ss = strToArray(master_obj.StudioValue);

            let pulldown_39_value = master_obj.TagAction;
            let pulldown_40_value = master_obj.GenreAction;
            let pulldown_41_value = master_obj.StudioAction;

            console.log("=== Opp = ", pulldown_39_value);

            //console.log("=== save 1 item data = ", item_data);
            //console.log("=== save 1 master data = ", master_obj);
            //console.log("=== save 1 tt = ", tt);

            if (tagAction != "No save") {                  // tags
                if (pulldown_39_value == "Add to") {
                    tt.forEach(function (item, pos) { item_data.TagItems.push({ "Name": item }); });
                };
                if (pulldown_39_value == "Replace All") {
                    item_data.TagItems = [];
                    tt.forEach(function (item, pos) { item_data.TagItems.push({ "Name": item }); });
                    console.log("=== Replace All");
                };
                if (pulldown_39_value == "Remove Tags") {
                    item_data.TagItems = remove_tags(item_data, tt, 0);
                };
                if (pulldown_39_value == "Delete All") { item_data.TagItems = []; };
            };

            if (genreAction != "No save") {                // genres
                if (pulldown_40_value == "Add to") {
                    gg.forEach(function (item, pos) { item_data.GenreItems.push({ "Name": item }); });
                };
                if (pulldown_40_value == "Replace All") {
                    item_data.GenreItems = [];
                    gg.forEach(function (item, pos) { item_data.GenreItems.push({ "Name": item }); });
                };
                if (pulldown_40_value == "Remove Tags") {
                    item_data.GenreItems = remove_tags(item_data, gg, 1);
                };
                if (pulldown_40_value == "Delete All") { item_data.GenreItems = []; };
            };

            if (studioAction != "No save") {                // studios
                if (pulldown_41_value == "Add to") {
                    ss.forEach(function (item, pos) { item_data.Studios.push({ "Name": item }); });
                };
                if (pulldown_41_value == "Replace All") {
                    item_data.Studios = [];
                    ss.forEach(function (item, pos) { item_data.Studios.push({ "Name": item }); });
                };
                if (pulldown_41_value == "Remove Tags") {
                    item_data.Studios = remove_tags(item_data, ss, 2);
                };
                if (pulldown_41_value == "Delete All") { item_data.Studios = []; };
            };

            //console.log("=== save 3 item data = ", item_data);

            item_data.LockedFields = master_obj.LockedFields;
            //............................................
            //
            // save "lock all" locks
            //
            let lock_All = master_obj.LockData;
            if (lock_All != "") item_data.LockData = master_obj.lock_All;

            //............................................
            //
            // upload "played" and "favorite" (these are stored separate in the DB from other data)
            //
            // update item_data from the master
            //
            if (typeof master_obj.UserData != "undefined") {
                if (typeof item_data.UserData == "undefined") { item_data.UserData = {}; };

                if (typeof master_obj.UserData.IsFavorite != "undefined") item_data.UserData.IsFavorite = master_obj.UserData.IsFavorite;
                if (typeof master_obj.UserData.Played != "undefined") item_data.UserData.Played = master_obj.UserData.Played;
            };


            return item_data;
        };


        //===================================================================================================
        //
        //
        //
        //
        //
        //            Edit
        //
        //
        //
        //
        //
        //===================================================================================================
        var master_filter = [];
        var filterValueArray = [];
        var testResults = [];

        var applyCustomFilter = false;


        function customFilterTest(item) {

            //
            // get radio button checked  ("all" or "one")
            //
            var matchType = document.querySelector('input[name="matchType"]:checked').value;



            let item_value = getItemData(item);



            //console.log("=== item =",item,", item_value = ",item_value);
            //console.log("--------------------------------------------------------------");

            let false_found = false;
            let true_found = false;
            let max_values = item_value.length;

            for (let i = 0; i < max_values; i++) {

                var opp = opp_array[i];

                if (master_filter[i] || (opp=='N')) {
                    let temp;

                    //console.log("=== i="+i+", master = "+master_filter[i]+", item = "+item_value[i]+", type = "+(typeof item_value[i])+", opp "+opp_array[i]);

                    if ((typeof item_value[i] != "string")) {
                        item_value[i] = item_value[i].toString();
                    };

                    item_value[i] = item_value[i].toLowerCase().trim();
                    master_filter[i] = master_filter[i].toLowerCase();

                    //var opp = opp_array[i];

                    if (opp == "=") {
                        temp = (item_value[i] == master_filter[i]) ? true : false;
                    } else
                        if (opp == ">") {
                            temp = (item_value[i] > master_filter[i]) ? true : false;
                        } else
                            if (opp == "<") {
                                temp = (item_value[i] < master_filter[i]) ? true : false;
                            } else
                                if (opp == "S") {
                                    temp = (item_value[i].startsWith(master_filter[i])) ? true : false;
                                } else
                                    if (opp == "E") {
                                        temp = (item_value[i].endsWith(master_filter[i])) ? true : false;
                                    } else
                                        if (opp == "C") {
                                            temp = (item_value[i].includes(master_filter[i])) ? true : false;
                                            //console.log("=== i="+i+", item = "+item_value[i],", master = "+master_filter[i]+", found = ",!false_found);
                                        } else
                                            if (opp == "N") {
                                                temp = (item_value[i] == "") ? true : false;
                                            };




                    //console.log("]]]]]] i="+i+", item value = "+item_value[i],", master filter value = "+master_filter[i]+", match = ",temp);
                    if (temp) true_found = true; else false_found = true;
                };
            };

            //console.log("=== Found = "+!false_found);

            if (matchType == "all") {
                return !false_found;
            } else {
                return true_found;
            };
        };


        async function applyTest(currentItems) {

            applyCustomFilter = true;

            //let page = await ApiClient.getJSON(ApiClient.getUrl('Users/' + id + '/Views?IncludeExternalContent=false&Fields=Genres,Overview,Tags,Path'));
            //let page = await ApiClient.getJSON(ApiClient.getUrl(url));

            let cnt = currentItems.length;
            testResults = [];


            loader.classList.remove("loader-hidden");


            for (let i = 0; i < cnt; i++) {

                //console.log("===", i);

                let item = currentItems[i];

                let url = "Users/" + currentUserId + "/Items/" + item.Id + "?Fields=MediaStreams,UserData&EnableUserData=true";

                let item_data = await ApiClient.getJSON(ApiClient.getUrl(url));

                testResults[i] = customFilterTest(item_data);

                //console.log("=== i = ",i,", test result = ", testResults[i]);
            };
            //console.log("=== finished");


            loader.classList.add("loader-hidden");

            finished();
        };




        //.....................................................
        //
        // Test
        //
        function do_test(max_values, item_value) {

            var false_found = false;

            //console.log("=== Do Test === max values = ",max_values,", item_value = ", item_value);

            for (let i = 0; i < max_values; i++) {

                document.getElementById("filter_row_" + i).style.backgroundColor = "rgba(0, 0, 0, 0.0)";  // make background transparent

                var opp = opp_array[i];

                if (filterValueArray[i] || (opp=="N") ) {
                    //console.log("=== i="+i+", filter = "+filterValueArray[i]+", item = "+item_value[i]+", type = "+(typeof item_value[i]));
                    if ((typeof item_value[i] != "string")) {
                        item_value[i] = item_value[i].toString();
                    };

                    item_value[i] = item_value[i].toLowerCase().trim();

                    //console.log("=== i=" + i + ", filter value = " + filterValueArray[i] + ", item value = " + item_value[i] + ", type = " + (typeof item_value[i]),", opp = ",opp);

                    if (opp == "=") {                                                               // look at math opp pulldown            
                        if (item_value[i] == filterValueArray[i]) {
                            document.getElementById("filter_row_" + i).style.backgroundColor = "green";
                        } else {
                            false_found = true;
                            document.getElementById("filter_row_" + i).style.backgroundColor = "red";
                        };
                    } else
                        if (opp == ">") {
                            if (item_value[i] > filterValueArray[i]) {
                                document.getElementById("filter_row_" + i).style.backgroundColor = "green";
                            } else {
                                false_found = true;
                                document.getElementById("filter_row_" + i).style.backgroundColor = "red";
                            };
                        } else
                            if (opp == "<") {
                                if (item_value[i] < filterValueArray[i]) {
                                    document.getElementById("filter_row_" + i).style.backgroundColor = "green";
                                } else {
                                    false_found = true;
                                    document.getElementById("filter_row_" + i).style.backgroundColor = "red";
                                };
                            } else
                                if (opp == "S") {
                                    if (item_value[i].startsWith(filterValueArray[i])) {
                                        document.getElementById("filter_row_" + i).style.backgroundColor = "green";
                                    } else {
                                        false_found = true;
                                        document.getElementById("filter_row_" + i).style.backgroundColor = "red";
                                    };
                                } else
                                    if (opp == "E") {
                                        if (item_value[i].endsWith(filterValueArray[i])) {
                                            document.getElementById("filter_row_" + i).style.backgroundColor = "green";
                                        } else {
                                            false_found = true;
                                            document.getElementById("filter_row_" + i).style.backgroundColor = "red";
                                        };
                                    } else
                                        if (opp == "C") {
                                            if (item_value[i].includes(filterValueArray[i])) {
                                                document.getElementById("filter_row_" + i).style.backgroundColor = "green";
                                            } else {
                                                false_found = true;
                                                document.getElementById("filter_row_" + i).style.backgroundColor = "red";
                                            };
                                        } else
                                            if (opp == "N") {
                                                if (item_value[i] == "") {
                                                    document.getElementById("filter_row_" + i).style.backgroundColor = "green";
                                                } else {
                                                    false_found = true;
                                                    document.getElementById("filter_row_" + i).style.backgroundColor = "red";
                                                };
                                            };
                };
            };
        };


        var edit_HTML = `

            <div id="page_title"></div>

            <div id="edit_node"></div>

            <style>
                table, th, td {
                    border: 1px solid gray;
                    border-collapse: collapse;
                }
            </style>
        `;

        var current_item_data;
        var opp_array = [];


        function tagsToArray(t_obj, name) {
            if (!t_obj) return [];
            if (!name) return [];
            let tag_array = [];
            t_obj.forEach((n) => {
                if (n[name]) {
                    if (n[name].length > 50) { n[name] = n[name].slice(0, 50); };
                    tag_array.push(n[name]);
                };
            });
            return tag_array;
        };

        // --------------------------------------------------
        //   
        // --------------------------------------------------
        function metadataDate(d) {
            let t = d.split("T");
            return t[0];
        };

        // --------------------------------------------------
        //
        // --------------------------------------------------

        function getItemData(item_data) {
            var item_value = [];
            //
            // Collect Data from Emby object
            //
            item_value[0] = (item_data.Path) ? item_data.Path : "";
            item_value[1] = (item_data.OriginalTitle) ? item_data.OriginalTitle : "";
            item_value[2] = (item_data.Name) ? item_data.Name : "";
            item_value[3] = (item_data.SortName) ? item_data.SortName : "";
            item_value[4] = (item_data.Taglines && item_data.Taglines[0]) ? item_data.Taglines[0] : "";
            item_value[5] = (item_data.Overview) ? item_data.Overview : "";
            item_value[6] = (item_data.OfficialRating) ? item_data.OfficialRating : "";     // parental rating  
            item_value[7] = (item_data.CommunityRating) ? item_data.CommunityRating : "";
            item_value[8] = (item_data.PremiereDate) ? metadataDate(item_data.PremiereDate) : "";
            item_value[9] = (item_data.ProductionYear) ? item_data.ProductionYear : "";

            if (typeof item_data.ProviderIds != "undefined") {
                item_value[10] = (item_data.ProviderIds.Imdb) ? item_data.ProviderIds.Imdb : "";
                item_value[11] = (item_data.ProviderIds.Tmdb) ? item_data.ProviderIds.Tmdb : "";
            } else {
                item_value[10] = "";
                item_value[11] = "";
            };

            item_value[12] = (item_data.DateCreated) ? metadataDate(item_data.DateCreated) : "";
            item_value[13] = (item_data.LocalTrailerCount) ? item_data.LocalTrailerCount : "0";
            item_value[14] = (item_data.RemoteTrailers) ? item_data.RemoteTrailers.length : "0";
            item_value[15] = (item_data.IsFolder) ? item_data.IsFolder : "false";
            item_value[16] = (item_data.Width) ? item_data.Width : "0";
            item_value[17] = (item_data.Height) ? item_data.Height : "0";
            item_value[18] = (item_data.Container) ? item_data.Container : "";
            item_value[19] = (item_data.CustomRating) ? item_data.CustomRating : "";
            item_value[20] = (item_data.RunTimeTicks) ? ((item_data.RunTimeTicks / 10000000) / 60).toFixed(0) : "";    // one tick is 10 microseconds
            item_value[21] = (item_data.Size) ? (item_data.Size / 1000000).toFixed(0) : "";

            let lock_array = (item_data.LockedFields) ? item_data.LockedFields : []; // ['Name', 'OfficialRating', 'Genres', 'Cast', 'Studios', 'Tags', 'Overview']

            item_value[22] = (lock_array.indexOf("Name") < 0) ? "Unlocked" : "Locked";
            item_value[23] = (lock_array.indexOf("OfficialRating") < 0) ? "Unlocked" : "Locked";
            item_value[24] = (lock_array.indexOf("Genres") < 0) ? "Unlocked" : "Locked";
            item_value[25] = (lock_array.indexOf("Cast") < 0) ? "Unlocked" : "Locked";
            item_value[26] = (lock_array.indexOf("Studios") < 0) ? "Unlocked" : "Locked";
            item_value[27] = (lock_array.indexOf("Tags") < 0) ? "Unlocked" : "Locked";
            item_value[28] = (lock_array.indexOf("Overview") < 0) ? "Unlocked" : "Locked";

            item_value[29] = (item_data.LockData) ? item_data.LockData : false;

            item_value[30] = (item_data.UserData) ? ((item_data.UserData.IsFavorite) ? item_data.UserData.IsFavorite : false) : false;
            item_value[31] = (item_data.UserData) ? ((item_data.UserData.Played) ? item_data.UserData.Played : false) : false;

            if (item_data.MediaStreams) {
                let temp = "";
                if (item_data.MediaStreams[0] && item_data.MediaStreams[0].RealFrameRate) {
                    temp = "" + item_data.MediaStreams[0].RealFrameRate.toFixed(0);
                };
                item_value[32] = temp;

                let jj = 6; //item_data.MediaStreams.length;
                let kk = 33;
                for (let ii = 0; ii < jj; ii++) {
                    item_value[kk + ii] = (item_data.MediaStreams[ii]) ? item_data.MediaStreams[ii].DisplayTitle : "";
                };
            };
            // --------------------------------------------------
            //
            //   add tags
            //
            if (item_data.TagItems) {
                let tag_array = tagsToArray(item_data.TagItems, "Name");
                item_value[39] = tag_array.toString();
            } else item_value[39] = [];
            // --------------------------------------------------
            //
            //   add genres
            //
            if (item_data.Genres) {
                item_value[40] = item_data.Genres.toString();
            } else item_value[40] = [];
            // --------------------------------------------------
            //
            //   add studios
            //
            if (item_data.Studios) {
                let studio_array = tagsToArray(item_data.Studios, "Name");
                item_value[41] = studio_array.toString();
            } else item_value[41] = [];


            return item_value;
        };

        //===================================================================================================

        function finished() {
            //e.preventDefault();
            //console.log("_________ finished  (ie. return)  Btn ___________");
            var pn = document.getElementById("page_node");
            while (pn.firstChild) { pn.firstChild.remove(); };

            topPageTitleArea.style.display = "inline-block";

            sideNode.style.display = "inline-block";

            hide_and_show_buttons(3);

            if (pageStack.length > 0) {
                let temp = pageStack[pageStack.length - 1];
                let url            = temp[0];
                let dimensions     = temp[1];
                let name           = temp[2].Name;
                let scrollPosition = temp[3];
                let pageType       = getType(temp[2]);

                getPage(url, dimensions, name, scrollPosition, pageType);
            } else {
                goHome();
            };

            return;
        };



        //===================================================================================================
        //
        //
        //
        //===================================================================================================
        function edit(indexArray, currentItems, bulk, filter) {

            //console.log("=== EDIT: indexArray = ", indexArray, ", currentItems = ", currentItems);


            if (indexArray.length <= 0) {
                indexArray = [0];
            };


            var max_values = 0;

            var item_name = [];
            var item_width = [];
            var item_bulk = [];
            var item_value = [];

            // --------------------------------------------------
            //  
            // --------------------------------------------------
            item_name[0] = "Path";
            item_name[1] = "Original Title";
            item_name[2] = "title";
            item_name[3] = "Sort Title";
            item_name[4] = "Taglines";
            item_name[5] = "Overview";
            item_name[6] = "Parental Rating";
            item_name[7] = "Community Rating";
            item_name[8] = "Release Date";
            item_name[9] = "Year";
            item_name[10] = "imdb id";
            item_name[11] = "The Movie Db Id";
            item_name[12] = "Date Added";
            item_name[13] = "Local Trailers";
            item_name[14] = "Remote Trailers";
            item_name[15] = "Is Folder";
            item_name[16] = "Width";
            item_name[17] = "Height";
            item_name[18] = "Container";
            item_name[19] = "Custom Rating";
            item_name[20] = "Runtime Minutes";
            item_name[21] = "Size";
            item_name[22] = "Lock Name";
            item_name[23] = "Lock Official Rating";
            item_name[24] = "Lock Genres";
            item_name[25] = "Lock Cast";
            item_name[26] = "Lock Studios";
            item_name[27] = "Lock Tags";
            item_name[28] = "Lock Overview";
            item_name[29] = "Lock All";
            item_name[30] = "Favorite";
            item_name[31] = "Played";
            item_name[32] = "Frame Rate";
            item_name[33] = "Codec 0";
            item_name[34] = "Codec 1";
            item_name[35] = "Codec 2";
            item_name[36] = "Codec 3";
            item_name[37] = "Codec 4";
            item_name[38] = "Codec 5";
            item_name[39] = "Tags";
            item_name[40] = "Genres";
            item_name[41] = "Studios";
            // --------------------------------------------------
            // a = label
            // b = unlock / lock
            // c = true / false
            // d = type text input size 30 max 80
            // e = rating pulldown
            // f = type date
            // g = type text input size 12 max 20
            // h = type textarea 10 rows 40 cols
            // i = input type number start 1920 end 2040
            // j = inout type number start 1 end 10
            // k = type text area 4 rows 40 cols
            // --------------------------------------------------
            if (bulk) {
                item_width[0] = "a";
                item_width[1] = "a";
                item_width[2] = "a";
                item_width[3] = "a";
                item_width[4] = "a";
                item_width[5] = "a";
                item_width[6] = "e";
                item_width[7] = "j";
                item_width[8] = "f";
                item_width[9] = "i";
                item_width[10] = "a";
                item_width[11] = "a";
                item_width[12] = "f";
                item_width[13] = "a";
                item_width[14] = "a";
                item_width[15] = "a";
                item_width[16] = "a";
                item_width[17] = "a";
                item_width[18] = "a";
                item_width[19] = "e";
                item_width[20] = "a";
                item_width[21] = "a";
                item_width[22] = "n";
                item_width[23] = "n";
                item_width[24] = "n";
                item_width[25] = "n";
                item_width[26] = "n";
                item_width[27] = "n";
                item_width[28] = "n";
                item_width[29] = "m";
                item_width[30] = "m";
                item_width[31] = "m";
                item_width[32] = "a";
                item_width[33] = "a";
                item_width[34] = "a";
                item_width[35] = "a";
                item_width[36] = "a";
                item_width[37] = "a";
                item_width[38] = "a";
                item_width[39] = "k";
                item_width[40] = "k";
                item_width[41] = "k";


                item_bulk[0] = "n";
                item_bulk[1] = "n";
                item_bulk[2] = "n";
                item_bulk[3] = "n";
                item_bulk[4] = "n";
                item_bulk[5] = "n";
                item_bulk[6] = "y";
                item_bulk[7] = "y";
                item_bulk[8] = "y";
                item_bulk[9] = "y";
                item_bulk[10] = "n";
                item_bulk[11] = "n";
                item_bulk[12] = "y";
                item_bulk[13] = "n";
                item_bulk[14] = "n";
                item_bulk[15] = "n";
                item_bulk[16] = "n";
                item_bulk[17] = "n";
                item_bulk[18] = "n";
                item_bulk[19] = "y";
                item_bulk[20] = "n";
                item_bulk[21] = "n";
                item_bulk[22] = "y";
                item_bulk[23] = "y";
                item_bulk[24] = "y";
                item_bulk[25] = "y";
                item_bulk[26] = "y";
                item_bulk[27] = "y";
                item_bulk[28] = "y";
                item_bulk[29] = "y";
                item_bulk[30] = "y";
                item_bulk[31] = "y";
                item_bulk[32] = "n";
                item_bulk[33] = "n";
                item_bulk[34] = "n";
                item_bulk[35] = "n";
                item_bulk[36] = "n";
                item_bulk[37] = "n";
                item_bulk[38] = "n";
                item_bulk[39] = "y";
                item_bulk[40] = "y";
                item_bulk[41] = "y";
            } else if (filter) {
                item_width[0] = "g";
                item_width[1] = "d";
                item_width[2] = "d";
                item_width[3] = "d";
                item_width[4] = "d";
                item_width[5] = "d";
                item_width[6] = "e";
                item_width[7] = "j";
                item_width[8] = "f";
                item_width[9] = "i";
                item_width[10] = "g";
                item_width[11] = "g";
                item_width[12] = "f";
                item_width[13] = "g";
                item_width[14] = "g";
                item_width[15] = "c";
                item_width[16] = "g";
                item_width[17] = "g";
                item_width[18] = "g";
                item_width[19] = "e";
                item_width[20] = "g";
                item_width[21] = "g";
                item_width[22] = "b";
                item_width[23] = "b";
                item_width[24] = "b";
                item_width[25] = "b";
                item_width[26] = "b";
                item_width[27] = "b";
                item_width[28] = "b";
                item_width[29] = "c";
                item_width[30] = "c";
                item_width[31] = "c";
                item_width[32] = "g";
                item_width[33] = "g";
                item_width[34] = "g";
                item_width[35] = "g";
                item_width[36] = "g";
                item_width[37] = "g";
                item_width[38] = "g";
                item_width[39] = "d";
                item_width[40] = "d";
                item_width[41] = "d";
            } else {
                item_width[0] = "a";
                item_width[1] = "d";
                item_width[2] = "d";
                item_width[3] = "d";
                item_width[4] = "d";
                item_width[5] = "h";
                item_width[6] = "e";
                item_width[7] = "j";
                item_width[8] = "f";
                item_width[9] = "i";
                item_width[10] = "g";
                item_width[11] = "g";
                item_width[12] = "f";
                item_width[13] = "a";
                item_width[14] = "a";
                item_width[15] = "a";
                item_width[16] = "a";
                item_width[17] = "a";
                item_width[18] = "a";
                item_width[19] = "e";
                item_width[20] = "a";
                item_width[21] = "a";
                item_width[22] = "b";
                item_width[23] = "b";
                item_width[24] = "b";
                item_width[25] = "b";
                item_width[26] = "b";
                item_width[27] = "b";
                item_width[28] = "b";
                item_width[29] = "c";
                item_width[30] = "c";
                item_width[31] = "c";
                item_width[32] = "a";
                item_width[33] = "a";
                item_width[34] = "a";
                item_width[35] = "a";
                item_width[36] = "a";
                item_width[37] = "a";
                item_width[38] = "a";
                item_width[39] = "k";
                item_width[40] = "k";
                item_width[41] = "k";
            };


            max_values = item_name.length;


            for (let i = 0; i < max_values; i++) {
                master_filter[i] = "";
            }



            function getFilterData(max_values) {
                //console.log("=== Get Data === ");

                for (let i = 0; i < max_values; i++) {
                    let temp = document.getElementById("V_" + i);
                    master_filter[i] = (temp.value) ? temp.value : "";
                    if (temp) {
                        let val = temp.value;
                        //let name = item_name[i];
                        //console.log("=== "+name+" - "+val);
                        if (val) filterValueArray[i] = val.toLowerCase();
                        else filterValueArray[i] = val;
                    };
                    temp = document.getElementById("opp_" + i);
                    if (temp) opp_array[i] = temp.value;
                };
                //console.log("=== filter Value Array = ",filterValueArray);
                //console.log("=== item Value Array   = ",item_value);
            };


            //view_btn.style.display = "none";

            //
            //   Hide and show buttons
            //
            if (filter) {
                hide_and_show_buttons(4);
                view_btn.style.display = "none";   // hide the cast to tv button   <----------<<<<
            } else hide_and_show_buttons(1);

            //
            //   hide or show the radio button
            //
            if (filter) radio_buttons.style.display = "block";    // show the radio buttons if filter = true

            //
            //   hid or show the prev or next buttons
            //
            if (indexArray.length < 2) {
                prev_btn.style.display = "none";
                next_btn.style.display = "none";
            };


            //
            //   custom filter button event listeners
            //
            custom_test_btn.onclick = function () { test() };
            custom_apply_btn.onclick = function () { apply() };
            //
            // custom filter button event listener functions
            //
            function test() {
                //console.log("___________ test Btn _____________");

                getFilterData(max_values);
                do_test(max_values, item_value);

                return;
            };
            function apply() {
                //console.log("____________ apply Btn ______________");

                getFilterData(max_values);
                applyTest(currentItems);

                return;
            };
            //
            // set the radio buttons
            //
            document.getElementById("matchAll").checked = true;
            //
            //
            //
            sideNode.style.display = "none";
            topPageTitleArea.style.display = "none";

            var index = 0;
            var count = indexArray.length;

            var pn = document.getElementById("page_node");
            while (pn.firstChild) { pn.firstChild.remove(); };

            pn.innerHTML = edit_HTML;  // add the HTML for the editor to the DOM

            //
            //   add page title
            //
            //document.getElementById("page_title").innerHTML = "Edit Item (" + count + " items)";


            //
            //   button event listeners
            //
            prev_btn.onclick = function (e) { prev(e) };
            next_btn.onclick = function (e) { next(e) };
            save_btn.onclick = function (e) { save(e) };
            view_btn.onclick = function (e) { view(e) };
            return_btn.onclick = function (e) { finished() };
            //
            // button event listener functions
            //
            function view(e) {
                e.preventDefault();
                //console.log("____________ view Btn ______________");

                cast_to_tv(indexArray, currentItems);
            };

            function prev(e) {
                e.preventDefault();
                //console.log("____________ prev Btn ______________");
                index--;
                if (index < 0) index = count - 1;
                getFullPage(index, editFullPage);

                return;
            };
            function next(e) {
                e.preventDefault();
                //console.log("____________ next Btn ______________");
                index++;
                if (index >= count) index = 0;
                getFullPage(index, editFullPage);

                return;
            };
            function save(e) {
                e.preventDefault();
                console.log("___________ save Btn _____________");

                if (bulk) {
                    //
                    // bulk save
                    //
                    console.log("=====================================");
                    //
                    // show spinner
                    //
                    loader.classList.remove("loader-hidden");  // show the spinner

                    var master = create_master_obj();
                    //console.log("=== Master = ", master);
                    var count = 0;
                    var maxCount = indexArray.length;

                    getFullPage(count, save_bulk_item);    // save_bulk_item is a callback

                    function save_bulk_item(item) {
                        let revised_item = update_values_from_master(item, master);
                        console.log("=== Revised item from master = ", revised_item);

                        saveItemData(revised_item, saveItemFinished);   // saveItemFinished is a callback
                    };

                    function saveItemFinished() {
                        count++;
                        if (count < maxCount) {
                            getFullPage(count, save_bulk_item);    // save_bulk_item is a callback
                        } else {
                            //
                            // remove spinner
                            //
                            loader.classList.add("loader-hidden");   // hide the spinner
                            //
                            // show setting Saved Message
                            //
                            Dashboard.processPluginConfigurationUpdateResult();

                            finished();
                        };
                    };

                } else {
                    //
                    // edit save
                    //
                    var item = update_values(current_item_data);

                    saveItemData(item, saveFinished);

                    function saveFinished() {
                        //
                        // show 'settings Saved' Message
                        //
                        Dashboard.processPluginConfigurationUpdateResult();
                    };
                };




                async function saveItemData(item, callback) {
                    //console.log("-------------------------------------", item);
                    //
                    // UserData is saved separately from item data
                    //
                    if (typeof item.UserData != "undefined") {

                        //console.log("=== Save UserData for " + item.Name + " ===");

                        if (typeof item.UserData["IsFavorite"] != "undefined") {
                            //------------------------------------------------------------------------                          
                            await ApiClient.updateFavoriteStatus(currentUserId, item.Id, item.UserData["IsFavorite"]);
                            //------------------------------------------------------------------------
                            //console.log("=== IsFavorite = ", item.UserData["IsFavorite"], ", type = ", typeof item.UserData["IsFavorite"]);
                        }

                        if (typeof item.UserData["Played"] != "undefined") {
                            //------------------------------------------------------------------------
                            if (item.UserData["Played"]) await ApiClient.markPlayed(currentUserId, item.Id);
                            else await ApiClient.markUnplayed(currentUserId, item.Id);
                            //------------------------------------------------------------------------
                            //console.log("=== Played = ", item.UserData["Played"], ", type = ", typeof item.UserData["Played"]);
                        };
                    };
                    //
                    // update item
                    //
                    //console.log("=== Save Item === ", item);
                    //------------------------------------------------------------------------
                    await ApiClient.updateItem(item);
                    //------------------------------------------------------------------------
                    //console.log("=== item saved = ", item);
                    //console.log("------------------------------------");

                    if (callback) callback();
                };

                return;
            };

            // -----------------------------------------------------------------------------------------------
            function math_op(val, i, value) {
                let x = document.createElement("SELECT");
                x.appendChild(addOption(""));
                x.appendChild(addOption("="));
                x.appendChild(addOption(">"));
                x.appendChild(addOption("<"));
                x.appendChild(addOption("S"));
                x.appendChild(addOption("E"));
                x.appendChild(addOption("C"));
                x.appendChild(addOption("N"));
                x.id = "opp_" + i;
                x.value = val;

                return x;
            };


            //================================================================================================
            //================================================================================================
            //
            // This is where the html page is first displayed - I am not sure why I put it here
            //
            getFullPage(0, editFullPage);      // note that editFullPage is a callback
            //
            //================================================================================================
            //================================================================================================


            async function getFullPage(index, callback) {

                let item = currentItems[indexArray[index]];

                let url = "Users/" + currentUserId + "/Items/" + item.Id + "?Fields=MediaStreams,UserData&EnableUserData=true";

                let item_data = await ApiClient.getJSON(ApiClient.getUrl(url));
                if (typeof callback == "function") callback(item_data); // editFullPage(item_data);
            };


            function editFullPage(item_data) {


                if (item_data.MediaType != "Video") view_btn.style.display = "none";


                //
                pn = document.getElementById("edit_node");
                while (pn.firstChild) { pn.firstChild.remove(); };

                //console.log("=== Full Page = ", item_data);

                //console.log("=== edit item - item_data = ", item_data);

                //
                // display item data
                //
                current_item_data = item_data;

                let div1 = document.createElement("DIV");

                let tb1 = document.createElement("TABLE");

                div1.appendChild(tb1);

                pn.appendChild(div1);

                let tr1 = document.createElement("TR");

                tb1.appendChild(tr1);

                let td1 = document.createElement("TD");
                tr1.appendChild(td1);

                let td2 = document.createElement("TD");
                td2.style.width = "100%";

                tr1.appendChild(td2);
                //
                // get the item's image tag
                //
                if (item_data.ImageTags["Primary"]) {
                    var image_url = server_url + "Items/" + item_data.Id + "/Images/Primary?maxHeight=300&maxWidth=200&tag=" + item_data.ImageTags.Primary + "&quality=90";
                } else if (item_data.SeriesPrimaryImageTag) {
                    var image_url = server_url + "Items/" + item_data.SeriesId + "/Images/Primary?tag=" + item_data.SeriesPrimaryImageTag + "&maxWidth=200&maxHeight=300&quality=90";
                } else if (item_data.ImageTags["Thumb"]) {
                    var image_url = server_url + "Items/" + item_data.Id + "/Images/Thumb?maxWidth=200&maxHeight=300";
                } else {
                    var image_url = getDefaultImage();
                };
                let iNode = document.createElement("img");
                iNode.src = image_url;
                //iNode.id = "editorImage1";
                //iNode.loading = "lazy";
                //iNode.className = "notSelected";
                iNode.style.width = "200px";
                //iNode.style.height = "300px";

                td1.appendChild(iNode);

                td1.appendChild(document.createElement("BR"));

                 //.............................................
                //
                // add buttons to change the channel images
                //
                let yy1 = document.createElement("Button");
                yy1.classList.add('page_button');
                yy1.innerHTML = "Change Image";
                yy1.id = "changeItemImage";
                yy1.style.marginLeft = "15px";

                td1.appendChild(yy1);

                //............................................
                // image picker
                //............................................
                document.getElementById("changeItemImage").onclick = function (event) {
                    event.preventDefault();   // stop the event from propagating further
                    console.log("=== image picker - Primary === ");
                    openImageFile(item_data.Id, "Primary", imageCallback);
                };
                //.............................................
                // callback
                function imageCallback() {
                    console.log("=== image Done === ");
                    getFullPage(index, editFullPage);
                };
                //.............................................




                let div2 = document.createElement("DIV");

                let s = "";
                if (bulk) {
                    s = "bulk Edit";
                } else if (filter) {
                    s = "Custom Filter";
                } else {
                    s = "Edit Item";
                };

                let ss = (indexArray.length > 1) ? " <h3>(" + (index + 1) + " of " + indexArray.length + " selected items)</h3>" : "";

                div2.innerHTML = "<h1 style='text-align: center'>" + s + "</h1>" + ss + ((filter) ? "<h4>The custom filter is applied to all items in a folder, not just the selected ones. The selected items are used only for filter testing.</h4>" : "");

                td2.appendChild(div2);
                td2.setAttribute("valign", "top");

                let div3 = document.createElement("DIV");
                div3.innerHTML = "<h1>" + item_data.Name + "</h1><h3>" + ((item_data.Overview) ? item_data.Overview : "No Overview") + "</h3>";

                td2.appendChild(div3);

                item_value = getItemData(item_data);

                // --------------------------------------------------
                //
                //   build the HTML page
                //
                // --------------------------------------------------
                let df_1 = new DocumentFragment();

                let max_values = item_name.length;
                let rowCnt = 0;
                //df_1.appendChild( document.createElement("BR") );
                let tb = document.createElement("TABLE");
                tb.id = "table_1";
                //tb.style.clear = "both";

                for (let i = 0; i < max_values; i++) {
                    let tr = document.createElement("TR");
                    tr.id = "filter_row_" + rowCnt;
                    rowCnt++
                    tb.appendChild(tr);
                    //--------------------------------------------
                    //
                    //  Col 1
                    //
                    let td_1 = document.createElement("TD");
                    //td_1.style.width = "200px";
                    td_1.setAttribute("nowrap", "nowrap");

                    let y = document.createElement("LABEL");
                    y.innerText = item_name[i];
                    //y.style.color = "white";
                    y.style.fontSize = "20px";
                    td_1.appendChild(y);

                    tr.appendChild(td_1);
                    //--------------------------------------------
                    //
                    //  Col 2
                    //
                    let td_2 = document.createElement("TD");

                    td_2.style.width = "40%"; // "300px";
                    let key = "a";

                    let val = item_value[i];

                    td_2.appendChild(makeTD(key, val, i, false));

                    tr.appendChild(td_2);
                    //--------------------------------------------
                    //
                    //  Col 3
                    //
                    let td_3 = document.createElement("TD");

                    if (bulk) {
                        td_3.style.width = "100px";
                        td_3.style.textAlign = "center";

                        if (i > 38) td_3.appendChild(savePulldown("No save", i));
                    } else
                        if (filter) {
                            td_3.style.width = "30px";

                            if (item_name[i] != "") td_3.appendChild(math_op(opp_array[i], i));
                        } else {
                            td_3.style.width = "1px";
                        };

                    tr.appendChild(td_3);
                    //--------------------------------------------
                    //
                    //  Col 4
                    //
                    let td_4 = document.createElement("TD");
                    td_4.style.width = "300px";

                    if (bulk || filter) {
                        let key4 = item_width[i];

                        let val4;

                        val4 = (item_bulk[i] == "y") ? "" : item_value[i];

                        if (filter) val4 = master_filter[i];

                        td_4.appendChild(makeTD(key4, val4, i, true));
                    } else {
                        td_4.appendChild(makeTD(item_width[i], item_value[i], i, true));
                    };
                    tr.appendChild(td_4);
                    //----------------------------------------
                    df_1.appendChild(tb);
                };

                pn.appendChild(df_1);    // add the document fragment to the DOM


                //
                // add cast pictures
                //
                //cast(item_data, dn);
                //
                // add similar movies
                //
                //similarMovies(item_data, dn);  // found in the cast.js file


                //document.getElementById("editImageBtn").onclick = function (data) { change_image(data) };
                //function change_image(data) {
                //    var mn = document.getElementById("modal_node");
                //    while (mn.firstChild) { mn.firstChild.remove(); };

                //    let dn = myModal(mn);
                //    edit_images(dn, current_item_data.Id, callback);
                //    modal_1.style.display = "block";

                //    function callback() {
                //        console.log("=== image edit done ===");
                //        page_queue.pop();
                //        item_editor(editor_selected, editor_obj, index);
                //    };
                //};


                //document.getElementById("omdbImageBtn").onclick = function (data) { omdb_image(data) };
                //function omdb_image(data) {
                //    console.log("=== omdb image = ", data);

                //    var mn = document.getElementById("modal_node");
                //    while (mn.firstChild) { mn.firstChild.remove(); };

                //    let dn = myModal(mn);
                //    omdb(item_data.Name, item_data, callback, dn);
                //    modal_1.style.display = "block";

                //    function callback() {
                //        console.log("=== omdb done ===");
                //        page_queue.pop();
                //        item_editor(editor_selected, editor_obj, index);
                //    };
                //};



                // --------------------------------------------------
                //   make TD
                // --------------------------------------------------
                function makeTD(key, val, index, assignId) {

                    let x;
                    //console.log("=== key = ",key,", val = ",val);
                    if (key == "a") {
                        x = document.createElement("LABEL");
                        x.innerHTML = "" + val;
                        //x.style.color = "white";
                        x.style.fontSize = "20px";
                        x.className = "editor_data";
                        x.style.wordBreak = "break-all";
                        x.style.wordWrap = "break-word";
                    } else
                        if (key == "b") {
                            x = document.createElement("SELECT");
                            x.appendChild(addOption("Unlocked"));
                            x.appendChild(addOption("Locked"));
                            x.value = val;
                        } else
                            if (key == "c") {
                                x = document.createElement("SELECT");
                                x.appendChild(addOption("true"));
                                x.appendChild(addOption("false"));
                                x.value = val;
                            } else
                                if (key == "d") {
                                    x = document.createElement("INPUT");
                                    x.setAttribute("type", "text");
                                    x.setAttribute("value", val);
                                    x.setAttribute("size", "40");
                                    x.setAttribute("maxlength", "80");
                                    x.className = "editor_data";
                                } else
                                    if (key == "g") {
                                        x = document.createElement("INPUT");
                                        x.setAttribute("type", "text");
                                        x.setAttribute("value", val);
                                        x.setAttribute("size", "12");
                                        x.setAttribute("maxlength", "20");
                                        x.className = "editor_data";
                                    } else
                                        if (key == "f") {
                                            x = document.createElement("INPUT");
                                            x.setAttribute("type", "date");
                                            x.value = val;
                                        } else
                                            if (key == "e") {
                                                x = ratingPulldown(val);
                                            } else
                                                if (key == "h") {
                                                    x = document.createElement("TEXTAREA");
                                                    x.setAttribute("rows", "10");
                                                    x.setAttribute("cols", "30");
                                                    x.style.fontSize = "18px";
                                                    x.value = val;
                                                } else
                                                    if (key == "i") {
                                                        x = document.createElement("INPUT");
                                                        x.setAttribute("type", "number");
                                                        x.setAttribute("min", "1920");
                                                        x.setAttribute("max", "2040");
                                                        x.setAttribute("step", "1");
                                                        x.value = val;
                                                    } else
                                                        if (key == "j") {
                                                            x = document.createElement("INPUT");
                                                            x.setAttribute("type", "number");
                                                            x.setAttribute("min", "1");
                                                            x.setAttribute("max", "10");
                                                            x.setAttribute("step", ".1");
                                                            x.value = val;
                                                        } else
                                                            if (key == "k") {
                                                                x = document.createElement("TEXTAREA");
                                                                x.setAttribute("rows", "4");
                                                                x.setAttribute("cols", "30");
                                                                x.style.fontSize = "18px";
                                                                x.value = val;
                                                            } else
                                                                if (key == "m") {
                                                                    x = document.createElement("SELECT");
                                                                    x.appendChild(addOption(""));
                                                                    x.appendChild(addOption("true"));
                                                                    x.appendChild(addOption("false"));
                                                                    x.value = val;
                                                                } else
                                                                    if (key == "n") {
                                                                        x = document.createElement("SELECT");
                                                                        x.appendChild(addOption(""));
                                                                        x.appendChild(addOption("Unlocked"));
                                                                        x.appendChild(addOption("Locked"));
                                                                        x.value = val;
                                                                    };
                    //
                    // add id to all items so their values can be read
                    //
                    if (assignId) {
                        x.id = "V_" + index;
                        //console.log("======= x id = "+x.id+", x = ",x);
                    };

                    return x;
                };
                // --------------------------------------------------
                //   
                // --------------------------------------------------
                function addOption(value) {
                    let y = document.createElement("option");
                    y.setAttribute("value", value);
                    y.innerText = value;
                    return y;
                };
                // --------------------------------------------------
                //   
                // --------------------------------------------------
                function ratingPulldown(set_value) {

                    let x = document.createElement("SELECT");
                    x.setAttribute("name", "Type");

                    x.appendChild(addOption("APPROVED"));
                    x.appendChild(addOption("TV-Y"));
                    x.appendChild(addOption("G"));
                    x.appendChild(addOption("E"));
                    x.appendChild(addOption("EC"));
                    x.appendChild(addOption("TV-G"));
                    x.appendChild(addOption("FSK-0"));
                    x.appendChild(addOption("GB-U"));
                    x.appendChild(addOption("IT-T"));

                    x.appendChild(addOption("TV-Y7"));
                    x.appendChild(addOption("TV-Y7-FV"));
                    x.appendChild(addOption("TV-PG"));
                    x.appendChild(addOption("PG"));
                    x.appendChild(addOption("FSK-6"));
                    x.appendChild(addOption("GB-PG"));
                    x.appendChild(addOption("GB-12"));
                    x.appendChild(addOption("IT-6+"));

                    x.appendChild(addOption("PG-13"));
                    x.appendChild(addOption("FSK-12"));
                    x.appendChild(addOption("GB-12A"));
                    x.appendChild(addOption("IT-14+"));
                    x.appendChild(addOption("TV-14"));
                    x.appendChild(addOption("FSK-16"));
                    x.appendChild(addOption("GB-15"));
                    x.appendChild(addOption("R"));
                    x.appendChild(addOption("M"));
                    x.appendChild(addOption("TV-MA"));
                    x.appendChild(addOption("FSK-18"));
                    x.appendChild(addOption("GB-18"));
                    x.appendChild(addOption("NC-17"));

                    x.appendChild(addOption("GB-R18"));
                    x.appendChild(addOption("IT-18+"));
                    x.appendChild(addOption("AO"));
                    x.appendChild(addOption("RP"));
                    x.appendChild(addOption("UR"));
                    x.appendChild(addOption("NR"));
                    x.appendChild(addOption("X"));
                    x.appendChild(addOption("XXX"));

                    x.value = set_value;

                    return x;
                };
            };







            // --------------------------------------------------
            //   
            // --------------------------------------------------
            function restore_metadata_date(d) {
                var temp = d + "T00:00:00.0000000+00:00";
                return temp;
            };

            // --------------------------------------------------
            //   
            // --------------------------------------------------
            function update_values(item_data) {

                item_data.OriginalTitle = document.getElementById("V_1").value;
                item_data.Name = document.getElementById("V_2").value;
                item_data.SortName = document.getElementById("V_3").value;
                item_data.Taglines[0] = document.getElementById("V_4").value;
                item_data.Overview = document.getElementById("V_5").value;
                item_data.OfficialRating = document.getElementById("V_6").value;
                item_data.CommunityRating = document.getElementById("V_7").value;
                item_data.PremiereDate = restore_metadata_date(document.getElementById("V_8").value);
                item_data.ProductionYear = document.getElementById("V_9").value;
                item_data.ProviderIds.Imdb = document.getElementById("V_10").value;
                item_data.ProviderIds.Tmdb = document.getElementById("V_11").value;
                item_data.DateCreated = restore_metadata_date(document.getElementById("V_12").value);
                //item_data.LocalTrailerCount     = document.getElementById("V_13").value;
                //item_data.RemoteTrailers.length = document.getElementById("V_14").value;
                //item_data.IsFolder              = document.getElementById("V_15").value;
                //item_data.Width                 = document.getElementById("V_16").value;
                //item_data.Height                = document.getElementById("V_17").value;
                //item_data.Container             = document.getElementById("V_18").value;
                item_data.CustomRating = document.getElementById("V_19").value;
                //((item_data.RunTimeTicks/10000000)/60).toFixed(0)
                //(item_data.Size/1000000).toFixed(0)

                //............................................
                //
                // add tags, genres, and studios to item_data
                //
                // function make_array_of_objs(index, remove_spaces){
                //     //str = str.replace(/\s+/g, '');
                //     let temp1 = document.getElementById("V_"+index).value;
                //     if(remove_spaces) temp1 = temp1.replace(/\s+/g, '');  // remove all spaces in string
                //                  else temp1 = temp1.trim();
                //     temp1 = temp1.split(",");           // make an array from the string
                //     let temp2 = [];
                //     temp1.forEach( (item) => { 
                //         temp2.push({"name":item});
                //     });
                //     return temp2;
                // };

                //item_data.TagItems   = make_array_of_objs(39, true);  //document.getElementById("V_39").value;
                //item_data.GenreItems = make_array_of_objs(40, true);  //document.getElementById("V_40").value;
                //item_data.Studios    = make_array_of_objs(41, false); //document.getElementById("V_41").value;

                //............................................
                //
                //   get lock info
                //
                let lock_Name = document.getElementById("V_22").value;
                let lock_OR = document.getElementById("V_23").value;
                let lock_Genres = document.getElementById("V_24").value;
                let lock_Cast = document.getElementById("V_25").value;
                let lock_Studios = document.getElementById("V_26").value;
                let lock_Tags = document.getElementById("V_27").value;
                let lock_Overview = document.getElementById("V_28").value;
                //............................................
                //
                //   save individual locks
                //
                let LockedFields = [];

                if (lock_Name == "Locked") LockedFields.push("Name");
                if (lock_OR == "Locked") LockedFields.push("OfficialRating");
                if (lock_Genres == "Locked") LockedFields.push("Genres");
                if (lock_Cast == "Locked") LockedFields.push("Cast");
                if (lock_Studios == "Locked") LockedFields.push("Studios");
                if (lock_Tags == "Locked") LockedFields.push("Tags");
                if (lock_Overview == "Locked") LockedFields.push("Overview");

                item_data.LockedFields = LockedFields;
                //............................................
                //
                // save "lock all" locks
                //
                let lock_All = document.getElementById("V_29").value;
                item_data.LockData = (lock_All == "true") ? true : false;






                //............................................
                //
                // played and favorite are stored separate in the DB from other data
                //
                // update values
                //
                let temp1 = document.getElementById("V_30").value;
                let temp2 = document.getElementById("V_31").value;

                if ((temp1 != "") || (temp2 != "")) {

                    if (typeof item_data.UserData == "undefined") { item_data.UserData = {}; };

                    if (temp1 != "") item_data.UserData.IsFavorite = (temp1 === "true") ? true : false;
                    if (temp2 != "") item_data.UserData.Played = (temp2 === "true") ? true : false;

                    console.log(">>> UserData = ", item_data.UserData);
                };





                //
                //   get tags, genres and studios
                //
                let tags_array = [];
                let tag_area = document.getElementById("V_" + 39);
                let tag_str = tag_area.value;
                let tt = tag_str.split(",");
                tt.forEach(function (item, pos) { tags_array.push({ "Name": item }); });
                let tags_set = new Set(tags_array);
                let tagsArr = Array.from(tags_set);
                item_data.TagItems = (tagsArr.length > 0) ? tagsArr : [];

                let genres_array = [];
                let genres_area = document.getElementById("V_" + 40);
                let genres_str = genres_area.value;
                let gg = genres_str.split(",");
                gg.forEach(function (item, pos) { genres_array.push({ "Name": item }); });
                let genres_set = new Set(genres_array);
                let genresArr = Array.from(genres_set);
                item_data.GenreItems = (genresArr.length > 0) ? genresArr : [];

                let studios_array = [];
                let studios_area = document.getElementById("V_" + 41);
                let studios_str = studios_area.value;
                let ss = studios_str.split(",");
                ss.forEach(function (item, pos) { studios_array.push({ "Name": item }); });
                let studios_set = new Set(studios_array);
                let studiosArr = Array.from(studios_set);
                item_data.Studios = (studiosArr.length > 0) ? studiosArr : [];

                return item_data;
            };
        };




        // --------------------------------------------------
        //   
        // --------------------------------------------------
        function addOption(value) {
            let y = document.createElement("option");
            y.setAttribute("value", value);
            y.innerText = value;
            return y;
        };
        // --------------------------------------------------
        //   
        // --------------------------------------------------
        function savePulldown(set_value, index) {
            let x = document.createElement("SELECT");
            x.setAttribute("name", "Type");
            x.id = "P_" + index;

            x.appendChild(addOption("No save"));
            x.appendChild(addOption("Add to"));
            x.appendChild(addOption("Replace All"));
            x.appendChild(addOption("Remove Tags"));
            x.appendChild(addOption("Delete All"));

            x.value = set_value;

            //console.log("=== pulldown = ", x);
            return x;
        };

        //===================================================================================================
        //
        //
        //
        //===================================================================================================

        var accessToken;
        var currentUserId;
        var currentItems;
        var server_url;
        var topDiv;
        var server_data;
        var pageNode;
        var scrollNode;
        var sideNode;
        var pageStack = [];

        var custom_test_btn;
        var custom_apply_btn;

        var prev_btn;
        var next_btn;
        var save_btn;
        var view_btn;
        var return_btn;

        var apply_btn;
        var reset_btn;

        var edit_button;
        var bulk_button;
        var clear_button;
        var prev_button;
        var filter_button;
        var custom_button;

        var radio_buttons;
        var color_key;

        var collection_button;
        var playlist_button;

        var topPageTitleArea;
        var alphabet = ["A", "B", "C", "D", "E", "F", "G", "H", "I", "J", "K", "L", "M", "N", "O", "P", "Q", "R", "S", "T", "U", "V", "W", "X", "Y", "Z"];
        var sectionBreakObj = {};
        var selected_items = [];

        //----------------------------------------------------------------------------------------------
        function topHTML() {
            let HTML = `
            <div id="color_key">
            <span class='keys' style="margin-left: 10px; font-size: 16px;">Color Key</span>
            <span style='background-color:brown; color:white' class='keys'>Folder</span>
            <span style='background-color:lightgray; color:black' class='keys'>File</span>
            <span style='background-color:red; color:white' class='keys'>Tags</span>
            <span style='background-color:green; color:white' class='keys'>Genres</span>
            <span style='background-color:yellow; color:black' class='keys'>Played File</span>
            <span style='margin-left:5px; font-size: 16px;'>Favorite</span><span style='font-size: 18px; color:red; margin-left:5px'>♥</span>
            <br>
            <label style="margin-left: 10px; font-size: 16px;">Click to select a file, Ctl-Click to select a folder, Shift-Click to select all files in a folder</label>
            </div>
            <br>

            <div class="loader loader--hidden"></div>         <!--  Spinner -->

            <button id="prev_page_btn" class="page_button">Previous Page</button>

            <button id="filter_button" class="page_button">Filter</button>
            <button id="custom_button" class="page_button">Custom</button>

            <button id="apply_button"  class="page_button">Apply</button>
            <button id="reset_button"  class="page_button">Reset</button>

            <button id="edit_btn" class="page_button">Edit</button>
            <button id="bulk_btn" class="page_button">Bulk Edit</button>

            <button id="collection_button" class="page_button">Collection</button>
            <button id="playlist_button" class="page_button">Playlist</button>
            <button id="collection_remove_button" class="page_button">Remove</button>
            <button id="playlist_remove_button" class="page_button">Remove</button>

            <button id="clear_btn" class="page_button">Clear All</button>

            <button id="prev_btn"   class="page_button">Prev</button>
            <button id="next_btn"   class="page_button">Next</button>
            <button id="save_btn"   class="page_button">Save</button>
            <button id="view_btn"   class="page_button">Cast to TV</button>
            <button id="custom_test_btn"  class="page_button">Test</button>
            <button id="custom_apply_btn" class="page_button">Apply</button>
            
            <button id="return_btn" class="page_button">Return</button>

            <div id="topPageTitleArea">
                <label id="topPageTitle">Libraries</label>
                <label id="topPageCount"></label>
            </div>
            <div id="radio_buttons">
                
                <input type="radio" id="matchAll" value = "all" name="matchType" > <span style="margin-right:10px">All Must Match</span>
                <input type="radio" id="matchOne" value = "one" name="matchType" > <span style="margin-right:10px">One or More Must Match</span>
                (S = 'starts with', E = 'ends with', C = 'contains', N = 'No Value')

            </div>
            <div id="main_container" style="width:100%">
                <table>
                    <tr>
                        <td valign="top">
                            <div id="button_node"></div>
                            <div id="scroll_div">
                                <div id="page_node"></div>
                            </div
                        </td>
                        <td valign="top">
                            <div id="side_node"></div>
                        </td>
                    </tr>
                </table>
            </div>

            <!--
            <div id="modal_node"></div>
            -->

            <style>
                #topPageTitleArea {
                    display: inline-block;
                    margin-left: 20px;
                    font-size: 25px;
                }
                #main_container{
                    width:   100%;
                }
                #page_node{
                    width:  100%;
                    height: 100%;
                }  
                #scroll_div {
                    width:  100%;
                    height: 700px;
                    overflow-y: auto;
                }
                #side_node{
                    /*border: 1px solid green;*/
                    /*width: 30px;*/
                    height: 100%;
                }
                .side_item{
                    background-color: gray;
                    color: white;
                }
                .side_item:hover{
                    background-color: lightgray;
                    color: black;
                }
                .notSelected {
                    border: 4px solid white;
                    cursor: pointer;
                }
                .selected {
                    border: 4px solid red;
                    cursor: pointer;
                }
                .page_button {
                    width:        140px;
                    height:       30px;
                    margin-left:   5px;
                    margin-bottom: 5px;
                    margin-top:    5px;
                    border-radius: 4px;
                    font-size:    16px;
                    text-align: center;
                    background-color: blue;
                    color: white;
                    cursor: pointer;
                }
                .page_button:hover {
                    background-color: lightblue;
                    color: black;
                }

                .page_button2 {
                    width:        140px;
                    height:       50px;
                    margin-left:   5px;
                    margin-bottom: 5px;
                    margin-top:    5px;
                    border-radius: 4px;
                    font-size:    16px;
                    text-align: center;
                    background-color: blue;
                    color: white;
                    cursor: pointer;
                }
                .page_button2:hover {
                    background-color: lightblue;
                    color: black;
                }

                /*-------------------------SPINNER-----------------------*/
                .loader {
                    position: fixed;
                    top: 0;
                    left: 0;
                    width: 100%;
                    height: 100%;
                    display: flex;
                    align-items: center;
                    justify-content: center;
                    /*background: #333333;*/
                    background-color: rgba(0,0,0,0.6);
                    transition: opacity 0.75s, visibility 0.75s;
                }
                
                .loader-hidden {
                    opacity: 0;
                    visibility: hidden;
                }
                
                .loader::after {
                    content: "";
                    width: 75px;
                    height: 75px;
                    border: 15px solid #dddddd;
                    border-top-color: #009578;
                    border-radius: 50%;
                    animation: loading 0.75s ease infinite;
                }

                @keyframes loading {
                    from{
                        transform: rotate(0trrn);
                    }
                    to {
                        transform: rotate(1turn);
                    }
                }
                /*-----------------------END SPINNER----------------------*/
            </style>
            `;

            return HTML;
        };
        //----------------------------------------------------------------------------------------------
        function getDefaultImage() {
            //return "data:image/jpeg;base64,/9j/4AAQSkZJRgABAQEAYABgAAD/4QAiRXhpZgAATU0AKgAAAAgAAQESAAMAAAABAAEAAAAAAAD/2wBDAAIBAQIBAQICAgICAgICAwUDAwMDAwYEBAMFBwYHBwcGBwcICQsJCAgKCAcHCg0KCgsMDAwMBwkODw0MDgsMDAz/2wBDAQICAgMDAwYDAwYMCAcIDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAz/wAARCAC3ARMDASIAAhEBAxEB/8QAHwAAAQUBAQEBAQEAAAAAAAAAAAECAwQFBgcICQoL/8QAtRAAAgEDAwIEAwUFBAQAAAF9AQIDAAQRBRIhMUEGE1FhByJxFDKBkaEII0KxwRVS0fAkM2JyggkKFhcYGRolJicoKSo0NTY3ODk6Q0RFRkdISUpTVFVWV1hZWmNkZWZnaGlqc3R1dnd4eXqDhIWGh4iJipKTlJWWl5iZmqKjpKWmp6ipqrKztLW2t7i5usLDxMXGx8jJytLT1NXW19jZ2uHi4+Tl5ufo6erx8vP09fb3+Pn6/8QAHwEAAwEBAQEBAQEBAQAAAAAAAAECAwQFBgcICQoL/8QAtREAAgECBAQDBAcFBAQAAQJ3AAECAxEEBSExBhJBUQdhcRMiMoEIFEKRobHBCSMzUvAVYnLRChYkNOEl8RcYGRomJygpKjU2Nzg5OkNERUZHSElKU1RVVldYWVpjZGVmZ2hpanN0dXZ3eHl6goOEhYaHiImKkpOUlZaXmJmaoqOkpaanqKmqsrO0tba3uLm6wsPExcbHyMnK0tPU1dbX2Nna4uPk5ebn6Onq8vP09fb3+Pn6/9oADAMBAAIRAxEAPwD5Pooor/RA+DCiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooA//Z";
            //return "data:image/jpeg;base64,/9j/4AAQSkZJRgABAQAAAQABAAD/4gHYSUNDX1BST0ZJTEUAAQEAAAHIAAAAAAQwAABtbnRyUkdCIFhZWiAAAAAAAAAAAAAAAABhY3NwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAA9tYAAQAAAADTLQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAlkZXNjAAAA8AAAACRyWFlaAAABFAAAABRnWFlaAAABKAAAABRiWFlaAAABPAAAABR3dHB0AAABUAAAABRyVFJDAAABZAAAAChnVFJDAAABZAAAAChiVFJDAAABZAAAAChjcHJ0AAABjAAAADxtbHVjAAAAAAAAAAEAAAAMZW5VUwAAAAgAAAAcAHMAUgBHAEJYWVogAAAAAAAAb6IAADj1AAADkFhZWiAAAAAAAABimQAAt4UAABjaWFlaIAAAAAAAACSgAAAPhAAAts9YWVogAAAAAAAA9tYAAQAAAADTLXBhcmEAAAAAAAQAAAACZmYAAPKnAAANWQAAE9AAAApbAAAAAAAAAABtbHVjAAAAAAAAAAEAAAAMZW5VUwAAACAAAAAcAEcAbwBvAGcAbABlACAASQBuAGMALgAgADIAMAAxADb/2wBDAAEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQH/2wBDAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQH/wAARCAIiAZADAREAAhEBAxEB/8QAFQABAQAAAAAAAAAAAAAAAAAAAAv/xAAUEAEAAAAAAAAAAAAAAAAAAAAA/8QAFAEBAAAAAAAAAAAAAAAAAAAAAP/EABQRAQAAAAAAAAAAAAAAAAAAAAD/2gAMAwEAAhEDEQA/AJ/4AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAP/Z";
            //return fnfLink;
            return fnfImage;
        };
        //----------------------------------------------------------------------------------------------
        function get_dimensions(item) {
            if (!item) return { 'width': 200, 'height': 100 };

            options_1 = {
                "livetv": { 'width': 200, 'height': 100 },
                "movies": { 'width': 200, 'height': 300 },
                "tvshows": { 'width': 200, 'height': 300 },
                "music": { 'width': 200, 'height': 200 },
                "audiobooks": { 'width': 200, 'height': 250 },
                "homevideos": { 'width': 200, 'height': 160 },
                "books": { 'width': 200, 'height': 250 },
                "musicvideos": { 'width': 200, 'height': 160 },
                "boxsets": { 'width': 200, 'height': 300 },
                "playlists": { 'width': 200, 'height': 250 }
            };

            options_2 = {
                "Season": { 'width': 200, 'height': 150 },
                "Playlist": { 'width': 200, 'height': 200 },
                "UserView": { 'width': 200, 'height': 100 },
                "Series": { 'width': 200, 'height': 300 },
                "BoxSet": { 'width': 200, 'height': 300 },
                "PhotoAlbum": { 'width': 200, 'height': 200 },
                "CollectionFolder": { 'width': 200, 'height': 100 },
                "Channel": { 'width': 200, 'height': 250 },
                "Folder": { 'width': 200, 'height': 150 },
                "Trailer": { 'width': 200, 'height': 300 },
                "MusicVideo": { 'width': 200, 'height': 150 },
                "MusicAlbum": { 'width': 200, 'height': 200 },
                "Photo": { 'width': 200, 'height': 200 },
                "Movie": { 'width': 200, 'height': 300 },
                "Audio": { 'width': 200, 'height': 200 },
                "Video": { 'width': 200, 'height': 150 },
                "Episode": { 'width': 200, 'height': 200 }
            };

            if (item.CollectionType) return options_1[item.CollectionType];
            else if (item.Type) return options_2[item.Type];
            else return { 'width': 200, 'height': 100 };   // home page
        };


        //==============================================================================================
        // Collection                   CT = item.CollectionType  T = item.Type
        // CT = boxsets
        // T  = CollectionFolder
        //----------------------------------------------------------------------------------------------
        // Audiobooks
        // CT = audiobooks
        // T  = CollectionFolder
        //----------------------------------------------------------------------------------------------
        // Movies
        // CT = movies
        // T  = CollectionFolder
        //----------------------------------------------------------------------------------------------
        // Music
        // CT = music
        // T  = CollectionFolder
        //----------------------------------------------------------------------------------------------
        // Music Video
        // CT = musicvideos
        // T  = CollectionFolder
        //----------------------------------------------------------------------------------------------
        // Home Videos and Photos
        // CT = homevideos
        // T  = CollectionFolder
        //----------------------------------------------------------------------------------------------
        // TV shows (all series)
        // CT = tvshows
        // T  = CollectionFolder
        //----------------------------------------------------------------------------------------------
        // Playlists
        // CT = playlists
        // T  = CollectionFolder
        //----------------------------------------------------------------------------------------------
        // E-books
        // CT = books
        // T  = CollectionFolder
        //----------------------------------------------------------------------------------------------
        // Live TV
        // CT = livetv
        // T  = UserView
        //----------------------------------------------------------------------------------------------
        //----------------------------------------------------------------------------------------------
        // Mixed content
        // CT = undefined
        // T  = CollectionFolder
        //----------------------------------------------------------------------------------------------
        // Audio book folder, folder, music video folder, tv show folder (one series), tv shows folders (seasons)
        // CT = undefined
        // T  = Folder
        //----------------------------------------------------------------------------------------------
        // Playlist items
        // CT = undefined
        // T  = Playlist
        //----------------------------------------------------------------------------------------------
        // Trailers
        // CT = undefined
        // T  = Channel
        //----------------------------------------------------------------------------------------------
        // Music Album
        // CT = undefined
        // T  = MusicAlbum
        //----------------------------------------------------------------------------------------------

        function getType( item ) {

            let title = {
                "livetv": "Live TV",
                "tvshows": "Series",
                "movies": "Movies",
                "music": "Albums",
                "audiobooks": "Audiobooks",
                "homevideos": "Home Videos",
                "books": "Books",
                "musicvideos": "Music Videos",
                "boxsets": "Box Sets",
                "playlists": "Play Lists",
                                
                "Series": "Seasons",
                "Season": "Shows",
                "BoxSet": "collection_remove",
                "Audio":  "Audio File",
                "PhotoAlbum": "Photo Album",
                "CollectionFolder": "Collection Folder",
                "Channel": "Channels",
                "Folder": "Items",
                "Playlist": "playlist_remove",
                "MusicAlbum": "Songs"
            };

            if (typeof item.CollectionType == "undefined") {
                return title[item.Type];
            } else {
                return title[item.CollectionType];
            };
        };



        function get_next_url(item) {

            let Recursion = "Recursive=true";
            let more = "&Fields=Genres,Overview,Tags,Path,ParentId";
            let sort = ""; // "&SortBy=SortName&SortOrder=Ascending";

            let collection_type_url = {
                //"livetv": "Users/" + currentUserId + "/Views?Fields=" + more,
                "livetv": "LiveTv/Channels?Fields=Genres%2COverview%2CTags&MediaStreams,UserData&EnableUserData=true",

                //LiveTv/Channels?UserId=fb01ce97647f48a9ae4067b4c0adb172&IsAiring=true&ImageTypeLimit=1&EnableImageTypes=Primary,Thumb,Backdrop&Fields=ProgramPrimaryImageAspectRatio&EnableUserData=false&SortBy=DefaultChannelOrder&Limit=12&SortOrder=Ascending&X-Emby-Client=Emby Web&X-Emby-Device-Name=Chrome Windows&X-Emby-Device-Id=7551ce5e-dfbf-4947-bfcb-545d645961e4&X-Emby-Client-Version=4.7.11.0&X-Emby-Token=60c0529a71fd4d6a8e9031e9473f2a6d&X-Emby-Language=en-us


                "tvshows": "Users/" + currentUserId + "/Items?" + Recursion + "&ParentId=" + item.Id + more + sort + "&IncludeItemTypes=Series",
                "movies": "Users/" + currentUserId + "/Items?" + Recursion + "&ParentId=" + item.Id + more + sort + "&IncludeItemTypes=Movie",

                //"music": "Users/" + currentUserId + "/Items?" + Recursion + "&ParentId=" + item.Id + more + sort + "&IncludeItemTypes=Folders",

                "music": "Users/" + currentUserId + "/Items?" + "SortBy=SortName&SortOrder=Ascending&" + "IncludeItemTypes=MusicAlbum&Recursive=true&" +
                    "Fields=BasicSyncInfo,CanDelete,Container,PrimaryImageAspectRatio,Prefix&StartIndex=0&ParentId=" + item.Id +
                    "&EnableImageTypes=Primary,Backdrop,Thumb&ImageTypeLimit=1&Limit=50",

                //"music": "Artists?SortBy=SortName&SortOrder=Ascending&Recursive=true&Fields=BasicSyncInfo,CanDelete,Container,PrimaryImageAspectRatio,Prefix&StartIndex=0&ParentId="+ item.Id +"&EnableImageTypes=Primary,Backdrop,Thumb&ImageTypeLimit=1&ArtistType=Artist,AlbumArtist&Limit=50&userId=" + currentUserId,

                "audiobooks": "Users/" + currentUserId + "/Items?" + Recursion + "&ParentId=" + item.Id + more + sort + "&IncludeItemTypes=Folder",

                "homevideos": "Users/" + currentUserId + "/Items?" + Recursion + "&ParentId=" + item.Id + more + sort + "&IncludeItemTypes=Folder",
                "books": "Users/" + currentUserId + "/Items?" + Recursion + "&ParentId=" + item.Id + more + sort + "&IncludeItemTypes=Folder",

                "musicvideos": "Users/" + currentUserId + "/Items?" + Recursion + "&ParentId=" + item.Id + more + sort + "&IncludeItemTypes=Folder",
                "boxsets": "Users/" + currentUserId + "/items?" + Recursion + more + sort + "&IncludeItemTypes=boxset",
                "playlists": "Users/" + currentUserId + "/Items?" + Recursion + "&ParentId=" + item.Id + more + sort // + "&IncludeItemTypes=Playlist"
            };


            //localhost:8096/emby/Users/fb01ce97647f48a9ae4067b4c0adb172/Items/175211?X-Emby-Client=Emby Web&X-Emby-Device-Name=Microsoft Edge Windows&X-Emby-Device-Id=e65aab42-985c-44f6-ae8f-bd965291d929&X-Emby-Client-Version=4.7.11.0&X-Emby-Token=f589499d615448edbbf4badfb7829ef0&X-Emby-Language=en-us
            //localhost:8096/emby/Users/fb01ce97647f48a9ae4067b4c0adb172/Items?SortBy=SortName&SortOrder=Ascending&Fields=BasicSyncInfo,CanDelete,Container,PrimaryImageAspectRatio,ProductionYear,Status,EndDate,Prefix&StartIndex=0&ParentId=175211&EnableImageTypes=Primary,Backdrop,Thumb&ImageTypeLimit=1&Limit=50&X-Emby-Client=Emby Web&X-Emby-Device-Name=Microsoft Edge Windows&X-Emby-Device-Id=e65aab42-985c-44f6-ae8f-bd965291d929&X-Emby-Client-Version=4.7.11.0&X-Emby-Token=f589499d615448edbbf4badfb7829ef0&X-Emby-Language=en-us

                        
            let type_url = {
                "Playlist": "Playlists/" + item.Id + "/Items?" + more,
                "Series": "Users/" + currentUserId + "/Items?" + Recursion + "&ParentId=" + item.Id + more + sort + "&IncludeItemTypes=Season",
                "Season": "Users/" + currentUserId + "/Items?" + Recursion + "&ParentId=" + item.Id + more + sort + "&IncludeItemTypes=Episode",
                //"Audio":  "Users/" + currentUserId + "/Items?" + Recursion + "&ParentId=" + item.Id + more + sort + "&IncludeItemTypes=Audio",
                "BoxSet": "users/" + currentUserId + "/items?Parentid=" + item.Id + more + sort,
                "PhotoAlbum": "users/" + currentUserId + "/items?Parentid=" + item.Id + more + sort,
                "CollectionFolder": "Users/" + currentUserId + "/Items?" + Recursion + "&ParentId=" + item.Id + more + sort,
                "Channel": "Users/" + currentUserId + "/Items?" + Recursion + "&ParentId=" + item.Id + more + sort + "&IncludeItemTypes=Trailer",
                "Folder": "users/" + currentUserId + "/items?Parentid=" + item.Id + more + sort,
                //"MusicAlbum": "users/" + currentUserId + "/items?Parentid=" + item.Id + more + sort
                "MusicAlbum": "Users/ " + currentUserId + "/Items?ParentId=" + item.Id + "&Fields=BasicSyncInfo,CanDelete,Container,PrimaryImageAspectRatio&ImageTypeLimit=1&EnableTotalRecordCount=false"
            };


            let C_Type = item.CollectionType;   // CollectionType
            let Type = item.Type;               // Type
            let url = "";

            if (typeof C_Type == "undefined") {   // is the CollectionType undefined?
                url = type_url[Type];
                console.log("=== CollectionType is undefined ===");
            } else {
                url = collection_type_url[C_Type];
            };

            if (typeof url == "undefined") {
                console.log("=== url is undefined ===");
                url = "Users/" + currentUserId + "/Views?Fields=" + more + sort;      // default url for the home page
            };

            return url;
        };

        //==============================================================================================
        //
        //
        //
        //==============================================================================================

        function add_sideboard() {
            let sideDiv = document.createElement("DIV");
            sideDiv.id = "sideDiv";

            //alphabet = ["A", "B", "C", "D", "E", "F", "G", "H", "I", "J", "K", "L", "M", "N", "O", "P", "Q", "R", "S", "T", "U", "V", "W", "X", "Y", "Z"];

            for (let i = 0; i < alphabet.length; i++) {
                let lbl = document.createElement("LABEL");
                lbl.innerHTML = "<div id=alpha_" + alphabet[i] + " class='side_item' style='text-align:center;' >" + alphabet[i] + "</div>";
                lbl.className = "alphabet";
                sideDiv.appendChild(lbl);
            };

            sideNode = document.getElementById("side_node");
            while (sideNode.firstChild) { sideNode.firstChild.remove(); };

            sideNode.appendChild(sideDiv);



            sideNode.onclick = function (data) {
                const { nodeName, id } = data.target;    // get the node name and id from the clicked target
                let id_array = id.split("_");
                if (id_array[0] == "alpha") {

                    let clicked_char = id_array[1];
                    let search_id = sectionBreakObj[clicked_char];

                    let selected = document.getElementById(search_id);  // scroll the selected item into view
                    if (selected) selected.scrollIntoView(true);
                };
            };
        };



        async function getUser() {
            currentUserId = await ApiClient.getCurrentUserId();
            //console.log("=== User id = ", currentUserId);

            server_data = ApiClient.serverInfo();
            console.log("=== Server info = ", server_data);

            //Changed LocalAddress to ManualAddress to cater for bridged connections
            server_url = (server_data.IsLocalServer) ? server_data.ManualAddress : server_data.RemoteAddress;
            server_url += "/";
            //console.log("=== Server url = ", server_url);

            //console.log("=== Parental ratings = ", getParental() );      //    <----------<<<<< Just for fun - see method above

            accessToken = server_data.AccessToken;

            goHome();
        };



        async function getPage(url, dimensions, titleName, scrollPosition, pageType) {

            if (dashboardTimerIndex) clearTimeout(dashboardTimerIndex); // needed to guarantee only one timer

            selected_items = [];

            url += filter_string;

            console.log("=== page url = ", url);

            //console.log("=== getPage top - Scroll position = ", scrollPosition);

            while (pageNode.firstChild) { pageNode.firstChild.remove(); };


            //===========================================================
            let page = await ApiClient.getJSON(ApiClient.getUrl(url));
            //===========================================================


            console.log("=== page = ", page);

            currentItems = page.Items;

            let cnt = page.Items.length;

            topPageTitleArea.innerHTML = titleName + " (" + cnt + ") "; // + pageType;

            //.................................

            let testChar = "@";
            alphabet = ["#"];
            sectionBreakObj = { "#": "I_0", };

            //.................................

            for (let i = 0; i < cnt; i++) {

                //console.log("=== i");

                let item = page.Items[i];

                //console.log(">>> item = ", item);




                //
                // get the item's image tag
                //
                if (item.ImageTags["Primary"]) {
                    var image_url = server_url + "Items/" + item.Id + "/Images/Primary?maxHeight=300&maxWidth=200&tag=" + item.ImageTags.Primary + "&quality=90";
                } else if (item.SeriesPrimaryImageTag) {
                    var image_url = server_url + "Items/" + item.SeriesId + "/Images/Primary?tag=" + item.SeriesPrimaryImageTag + "&maxWidth=200&maxHeight=300&quality=90";
                } else if (item.ImageTags["Thumb"]) {
                    var image_url = server_url + "Items/" + item.Id + "/Images/Thumb?maxWidth=200&maxHeight=300";
                } else if (item.ImageTags["LogoLight"]) {
                    var image_url = server_url + "Items/" + item.Id + "/Images/LogoLight?maxHeight=300&maxWidth=200&tag=" + item.ImageTags.LogoLight + "&quality=90";
                } else if (item.ImageTags["LogoLightColor"]) {
                    var image_url = server_url + "Items/" + item.Id + "/Images/LogoLightColor?maxHeight=300&maxWidth=200&tag=" + item.ImageTags.LogoLightColor + "&quality=90";
                } else {
                    var image_url = getDefaultImage();
                };




                let iNode = document.createElement("img");
                iNode.src = image_url;
                iNode.id = "I_" + i;
                iNode.loading = "lazy";
                iNode.className = "notSelected";
                iNode.style.width  = (dimensions.width - 8) + "px";   //  "200px";
                iNode.style.height = dimensions.height + "px";        //  "300px";
                //
                //   text node
                //
                let tNode = document.createElement("DIV"); // note label does not have a 'width' attribute, set width with CSS
                let fav = (item.UserData) ? item.UserData["IsFavorite"] : false;
                let fav_str = (fav) ? "<span style='color:red'> ♥</span>" : "";

                tNode.innerHTML = "<b>" + item.Name + fav_str + "</b>";

                tNode.style.backgroundColor = "lightGray";
                tNode.style.color = "black";

                if (item.UserData && item.UserData["Played"]) { tNode.style.backgroundColor = "yellow"; tNode.style.color = "black"; }
                if (item["IsFolder"]) { tNode.style.backgroundColor = "brown"; tNode.style.color = "white"; };
                //tNode.className = "tNode";

                tNode.style.textAlign = "center";
                tNode.style.width = "200px";
                // -----------------------------------------------------------------------------------------------
                //
                //   add tags
                //
                let tag_str = "";
                if (item.TagItems) {
                    //console.log("=== tag 1 = ", item.TagItems);
                    let tag_array = tagsToArray(item.TagItems, "Name");
                    //console.log("=== tag 2 = ", tag_array);
                    tag_str = tag_array.toString();
                };
                // -----------------------------------------------------------------------------------------------
                //
                //   add genres
                //
                let genres_str = "";
                if (item.Genres) {
                    genres_str = item.Genres.toString();
                };
                // -----------------------------------------------------------------------------------------------
                //
                //   s Node
                //
                let sNode = document.createElement("DIV");
                //sNode.className = "sNode";
                sNode.innerHTML = "<div class='tags' style='background-color:red; color:white; text-align:center; word-break:break-all; word-wrap:break-word;'>" +
                    tag_str + "</div><div class='genres' style='background-color:green; color:white; text-align:center; word-break:break-all; word-wrap:break-word;'>" +
                    genres_str + "</div>";
                sNode.style.width = "200px";
                // -----------------------------------------------------------------------------------------------
                // 
                //   d Node
                //
                var dNode = document.createElement("DIV");
                dNode.style.display = "inline-block";
                dNode.style.marginRight = "10px";
                dNode.style.marginBottom = "10px";
                dNode.style.verticalAlign = "top";
                //dNode.style.border = "1px solid black";

                dNode.style.width = dimensions.width + "px"; //"200px";
                //dNode.style.height = "300px";

                //dNode.className = "dNode";
                dNode.append(iNode);
                dNode.append(tNode);
                dNode.append(sNode);

                // -----------------------------------------------------------------------------------------------
                //
                // apply custom filter
                //
                if (applyCustomFilter) {
                    if (testResults[i]) {
                        iNode.className = "selected";
                        selected_items.push("" + i);
                    } else continue;
                };
                // -----------------------------------------------------------------------------------------------
                //
                //  tag filter
                //
                if (showWithTag != 0) {
                    if (showWithTag == 1) {        //  1 = has no tags, 2 = has tag
                        if (tag_str != "") continue;
                    } else {                       //  show item if item has tags
                        if (tag_str == "") continue;
                    };

                    iNode.className = "selected";
                    selected_items.push("" + i);

                    edit_button.style.display = "inline-block";
                    if (selected_items.length > 1) bulk_button.style.display = "inline-block";
                    clear_button.style.display = "inline-block";
                    collection_button.style.display = "inline-block";
                    playlist_button.style.display = "inline-block";
                    
                };
                // -----------------------------------------------------------------------------------------------
                //
                // genre filter
                //
                if (showWithGenre != 0) {
                    if (showWithGenre == 1) {        //  1 = has no genre, 2 = has genre
                        if (genre_str != "") continue;
                    } else {                         //  show item if item has genres
                        if (genre_str == "") continue;
                    };

                    iNode.className = "selected";
                    selected_items.push("" + i);

                    edit_button.style.display = "inline-block";
                    if (selected_items.length > 1) bulk_button.style.display = "inline-block";
                    clear_button.style.display = "inline-block";
                    collection_button.style.display = "inline-block";
                    playlist_button.style.display = "inline-block";
                };
                // -----------------------------------------------------------------------------------------------

                pageNode.appendChild(dNode);  // add the item to the DOM

                // -----------------------------------------------------------------------------------------------
                //
                //  build side bar alphabet array and index obj
                //
                if (item.Type != "Audio" && item.Type != "Episode") {   // Audio and Episode are not listed alphabetically
                    let search_name = item.Name.toUpperCase();

                    if (search_name.startsWith("THE ")) search_name = search_name.slice(4);
                    else
                        if (search_name.startsWith("A ")) search_name = search_name.slice(2);

                    //console.log("=== Search Name = ", search_name,", testChar = ",testChar);


                    //
                    // build the alpha array for the side panel
                    //
                    let search_char = search_name[0];
                    if ((search_char < "A") || (search_char > "Z")) { search_char = "@"; };

                    if (search_char > testChar) {
                        testChar = search_name[0];
                        alphabet.push(testChar);
                        sectionBreakObj[testChar] = iNode.id;
                    };
                };
                // -----------------------------------------------------------------------------------------------
            };
            //console.log("=== Done");



            loader.classList.add("loader-hidden");  // turn spinner off


            //console.log("=== alphabet = ", alphabet, ", sectionBreakObj = ", sectionBreakObj);

            add_sideboard();

            if (scrollPosition) scrollNode.scrollTop = scrollPosition;

            if (applyCustomFilter) {
                //console.log("=== done");

                edit_button.style.display = "inline-block";
                if (selected_items.length > 1) bulk_button.style.display = "inline-block";
                clear_button.style.display = "inline-block";
                collection_button.style.display = "inline-block";
                playlist_button.style.display = "inline-block";

                applyCustomFilter = false;
            };



            //......................................................................
            //
            //                CLICK
            //
            //......................................................................
            pageNode.onclick = function (data) {
                //console.log("=== Click = ", data)

                let id = data.target.id;
                let id_array = id.split("_");

                if (id_array[0] != "I") return;

                let index = id_array[1];
                let item = page.Items[index];

                if (!item) return;

                //console.log("=== click page = ",page);

                //
                // select all
                //
                if (data["shiftKey"]) {
                    let sel = document.querySelectorAll(".selected");
                    let sel_cnt = sel.length;
                    //console.log("=== sel 1 = ", sel);

                    if (sel_cnt == 0) {
                        selected_items = [];
                        let not_selected = document.querySelectorAll(".notSelected");
                        let cnt = not_selected.length;
                        for (let i = 0; i < cnt; i++) {
                            let item = not_selected[i];
                            item.className = "selected";
                            selected_items.push("" + i);
                        };
                        show_buttons();
                        return;
                    };

                    // get min and max of currently selected items
                    let i1 = sel[0].id;
                    //console.log("=== i1 = ", i1);
                    let a1 = i1.split("_");
                    //console.log("=== a1 = ", a1);
                    let min = a1[1];

                    let i2 = sel[sel_cnt - 1].id;
                    //console.log("=== i2 = ", i2);
                    let a2 = i2.split("_");
                    //console.log("=== a2 = ", a2);
                    let max = a2[1];

                    //console.log("=== min_1 = ", min, ", max = ", max);

                    // the second click point is index
                    if (index <  min) min = index; else
                    if (index >= min) max = index; 

                    //console.log("=== min_2 = ", min, ", max = ", max);

                    for (let i = 0; i < sel_cnt; i++) {
                        let item = sel[i];
                        item.className = "notSelected";
                    };

                    sel = document.querySelectorAll(".notSelected");
                    //console.log("=== sel 2 = ", sel);

                    for (let i = min; i <= max; i++) {
                        let item = sel[i];
                        item.className = "selected";
                    };

                    show_buttons();
                    return;
                };


                //
                //  control key click on a folder - to select the folder
                //
                if (item.IsFolder && data["ctrlKey"]) {
                    //console.log("=== ctl-key selected item is a folder ====");
                    //
                    //   if the clicked item is not a folder then slect it
                    //
                    if (data.target.className == "notSelected") {
                        document.getElementById(id).className = "selected"
                    } else {
                        document.getElementById(id).className = "notSelected"
                    };

                    show_buttons();
                    return;
                };

                //console.log("=== id = ", id, ", index = ", index, ", item = ", item);

                //
                //   if the clicked item is a folder then get the folders content
                //
                if (item.IsFolder) {

                    let url = get_next_url(item);

                    console.log("=== url from get_next_url = ", url);

                    prev_button.style.display = "inline-block";

                    let dimensions = get_dimensions(item);   // get the dimensions from the table

                    pageStack.push([url, dimensions, item, scrollNode.scrollTop]);

                    //console.log("=== Click Folder - Scrollnode = ", scrollNode.scrollTop);

                    loader.classList.remove("loader-hidden");  // show the spinner

                    hide_and_show_buttons(3);

                    getPage(url, dimensions, item.Name, 0, getType(item) );

                    return;

                } else {
                    //
                    //   if the clicked item is not a folder then select it
                    //
                    if (data.target.className == "notSelected") {
                        document.getElementById(id).className = "selected"
                    } else {
                        document.getElementById(id).className = "notSelected"
                    };

                    show_buttons();
                    return;
                };

                function show_buttons() {

                    let selected = document.querySelectorAll(".selected");
                    //console.log("=== Selected = ",selected);

                    if (selected.length == 0) {
                        edit_button.style.display = "none";
                        bulk_button.style.display = "none";
                        clear_button.style.display = "none";
                        collection_button.style.display = "none";
                        playlist_button.style.display = "none";
                        collection_remove_button.style.display = "none";
                        playlist_remove_button.style.display = "none";
                    } else
                        if (selected.length == 1) {
                            edit_button.style.display = "inline-block";
                            bulk_button.style.display = "none";
                            clear_button.style.display = "inline-block";
                            if (pageType != "Live TV") collection_button.style.display = "inline-block";
                            if (pageType != "Live TV") playlist_button.style.display = "inline-block";
                            if (pageType == "collection_remove") { collection_remove_button.style.display = "inline-block"; };
                            if (pageType == "playlist_remove") { playlist_remove_button.style.display = "inline-block"; };
                        } else
                            if (selected.length > 1) {
                                edit_button.style.display = "inline-block";
                                bulk_button.style.display = "inline-block";
                                clear_button.style.display = "inline-block";
                                if (pageType != "Live TV") collection_button.style.display = "inline-block";
                                if (pageType != "Live TV") playlist_button.style.display = "inline-block";
                                if (pageType == "collection_remove") { collection_remove_button.style.display = "inline-block"; };
                                if (pageType == "playlist_remove") { playlist_remove_button.style.display = "inline-block"; };
                            };
                };
            };
        };

        //-------------------------------------------------------------------------------------

        function goHome() {
            hide_and_show_buttons(0);
            //
            // get the home screen
            //
            let url = 'Users/' + currentUserId + '/Views?IncludeExternalContent=false&Fields=Genres,Overview,Tags,Path'
            getPage(url, { 'width': 200, 'height': 100 }, "Libraries", 0, "Libraries");   // (url, dimensions, titleName, scrollPosition, pageType)
        };

        //-------------------------------------------------------------------------------------

        function hide_and_show_buttons(sel) {

            custom_test_btn.style.display = "none";
            custom_apply_btn.style.display = "none";

            prev_btn.style.display = "none";
            next_btn.style.display = "none";
            save_btn.style.display = "none";
            view_btn.style.display = "none";
            return_btn.style.display = "none";

            apply_btn.style.display = "none";
            reset_btn.style.display = "none";

            prev_button.style.display = "none";     // rpevious page button
            filter_button.style.display = "none";   // execute filter method
            custom_button.style.display = "none";   // execute custom method

            edit_button.style.display = "none";     // execute edit item method
            bulk_button.style.display = "none";     // execute bulk edit method
            clear_button.style.display = "none";    // clear all selections

            radio_buttons.style.display = "none";    // hide the radio buttons

            collection_button.style.display = "none";
            playlist_button.style.display = "none";
            collection_remove_button.style.display = "none";
            playlist_remove_button.style.display = "none";


            //console.log("=== hid and show = ",sel);
            if (sel == 0) {
                color_key.style.display = "block";       // show the color key on the views screen (home screen)
                return;
            } else {
                color_key.style.display = "none";        // hide the color key on all other screens
            };

            if ((sel == 1) || (sel == 4)) {
                // edit item and bulk edit buttons
                prev_btn.style.display = "inline-block";    // previous item in edit/bulk
                next_btn.style.display = "inline-block";    // next item in edit/bulk
                save_btn.style.display = "inline-block";    // save edit/bulk 
                view_btn.style.display = "inline-block";    // view edit/bulk 
                return_btn.style.display = "inline-block";  // return from edit/bulk 
            } else if (sel == 2) {
                // emby filter buttons
                apply_btn.style.display = "inline-block";   // apply the selected filters
                reset_btn.style.display = "inline-block";   // reset all of the filters
            } else if (sel == 3) {
                //
                prev_button.style.display   = "inline-block";   // rpevious page button
                filter_button.style.display = "inline-block";   // execute filter method
                custom_button.style.display = "inline-block";   // execute custom method
            };

            if (sel == 4) {
                custom_test_btn.style.display  = "inline-block";
                custom_apply_btn.style.display = "inline-block";
                save_btn.style.display = "none";
            };
            if (sel == 7) {
                prev_btn.style.display = "inline-block";    // previous item in edit/bulk
                next_btn.style.display = "inline-block";    // next item in edit/bulk
                save_btn.style.display = "inline-block";
                return_btn.style.display = "inline-block";  // return from edit/bulk 
            };
        };

        //-------------------------------------------------------------------------------------
        //
        //   remove items from collections and playlists   (type=true for collections, false for playlists)
        //
        function remove_collection_items(indexArray, currentItems, type) {

            let len = indexArray.length;
            if (len == 0) return;

            //.................................
            let collectionId;   // for both collections and playlists

            if (pageStack.length > 0) {
                let temp1 = pageStack[pageStack.length - 1];
                console.log("=== get prev page = ", temp1);
                collectionId = temp1[2].Id
            } else {
                return;
            };
            //.................................

            let itemsIdStr = "";

            for (let i = 0; i < len; i++) {
                let item = currentItems[indexArray[i]];
                itemsIdStr += (type) ? item.Id + "," : item.PlaylistItemId + ",";
            };
            itemsIdStr = itemsIdStr.slice(0, -1);

            console.log("=== remove item ids = ", itemsIdStr);

            //...............................................................................................
            //  this is a simple way that's supported by all browsers to POST a URL without a body
            //...............................................................................................
            var url = (type) ? "Collections/" + collectionId + "/Items?Ids=" + itemsIdStr + "&api_key=" + accessToken :
                               "Playlists/"   + collectionId + "/Items?EntryIds=" + itemsIdStr + "&api_key=" + accessToken;  // the collectionId is the same for Collections and Playlists
            console.log("=== remove url = ", url);
            //...............................................................................................
            var Http = new XMLHttpRequest();
            Http.onreadystatechange = function () {
                console.log("=== finished === status = ", this.status, ", readyState = ", this.readyState);

                if (this.readyState == 4 && this.status == 204) {
                    console.log("=== finished ===");
                    finished();
                };
            };
            Http.open('Delete', ApiClient.getUrl(url));   // post a delete
            Http.send();
            //...............................................................................................
        };
        //-------------------------------------------------------------------------------------
        //
        //
        //
        //
        //
        //
        //
        //-------------------------------------------------------------------------------------
        return function (view) {
            //console.log("=== Starting 1 ===");

            view.addEventListener('viewshow', async () => {

                //console.log("=== Starting 2 ===");
                console.log("=== view = ", view);
                console.log("=== loading = ", loading);
                console.log("=== dialogueHelper = ", dialogHelper);
                console.log("=== mainTabsManager = ", mainTabsManager);








                loading.show();

                pageStack = [];

                showWithTag = 0;
                showWithGenre = 0;
                filter_selectedIndex = [];  // used to save and restore filter selections
                filter_string = "";         // clear the filter string that gets added to all urls

                //============================================================================

                topDiv = document.getElementById("topDiv");
                topDiv.innerHTML = topHTML();                   // load the HTML into the DOM

                //============================================================================

                loader = document.querySelector(".loader");  // spinner
                loader.classList.add("loader-hidden");       // hid the spinner

                prev_btn = document.getElementById("prev_btn");
                next_btn = document.getElementById("next_btn");
                save_btn = document.getElementById("save_btn");
                view_btn = document.getElementById("view_btn");
                return_btn = document.getElementById("return_btn");

                apply_btn = document.getElementById("apply_button");
                reset_btn = document.getElementById("reset_button");

                custom_test_btn = document.getElementById("custom_test_btn");
                custom_apply_btn = document.getElementById("custom_apply_btn");

                radio_buttons = document.getElementById("radio_buttons");

                color_key = document.getElementById("color_key");


                //============================================================================
                //============================================================================

                getUser();  // get the user and system data and display the Library page

                //============================================================================
                //============================================================================


                //-------------------------------------------------------------
                // playlist button
                //
                playlist_button = document.getElementById("playlist_button");
                playlist_button.onclick = function (data) {
                    //console.log("=== Playlist Button Clicked ");

                    let selected = document.querySelectorAll(".selected");
                    //
                    // for each selected item put it's index into the indexArray
                    //
                    let indexArray = [];
                    selected.forEach((item) => {
                        let temp = item.id.split("_");
                        indexArray.push(parseInt(temp[1]));
                    });

                    if (pageStack.length > 0) {
                        let temp = pageStack.pop();
                        temp[3] = scrollNode.scrollTop;
                        pageStack.push(temp);
                    };

                    collections_and_playlists(indexArray, currentItems, false);

                    return;
                };
                //-------------------------------------------------------------
                // playlist remove button
                //
                playlist_remove_button = document.getElementById("playlist_remove_button");
                playlist_remove_button.onclick = function (data) {
                    //console.log("=== Collection Button Clicked ");

                    let selected = document.querySelectorAll(".selected");
                    //
                    // for each selected item put it's index into the indexArray
                    //
                    let indexArray = [];
                    selected.forEach((item) => {
                        let temp = item.id.split("_");
                        indexArray.push(parseInt(temp[1]));
                    });

                    if (pageStack.length > 0) {
                        let temp = pageStack.pop();
                        temp[3] = scrollNode.scrollTop;
                        pageStack.push(temp);
                    };

                    remove_collection_items(indexArray, currentItems, false);

                    return;
                };
                //-------------------------------------------------------------
                // collection button
                //
                collection_button = document.getElementById("collection_button");
                collection_button.onclick = function (data) {
                    //console.log("=== Collection Button Clicked ");

                    let selected = document.querySelectorAll(".selected");
                    //
                    // for each selected item put it's index into the indexArray
                    //
                    let indexArray = [];
                    selected.forEach((item) => {
                        let temp = item.id.split("_");
                        indexArray.push(parseInt(temp[1]));
                    });

                    if (pageStack.length > 0) {
                        let temp = pageStack.pop();
                        temp[3] = scrollNode.scrollTop;
                        pageStack.push(temp);
                    };

                    collections_and_playlists(indexArray, currentItems, true);

                    return;
                };
                //-------------------------------------------------------------
                // collection remove button
                //
                collection_remove_button = document.getElementById("collection_remove_button");
                collection_remove_button.onclick = function (data) {
                    //console.log("=== Collection Button Clicked ");

                    let selected = document.querySelectorAll(".selected");
                    //
                    // for each selected item put it's index into the indexArray
                    //
                    let indexArray = [];
                    selected.forEach((item) => {
                        let temp = item.id.split("_");
                        indexArray.push(parseInt(temp[1]));
                    });

                    if (pageStack.length > 0) {
                        let temp = pageStack.pop();
                        temp[3] = scrollNode.scrollTop;
                        pageStack.push(temp);
                    };

                    remove_collection_items(indexArray, currentItems, true);

                    return;
                };
                //-------------------------------------------------------------
                // custom button
                //
                custom_button = document.getElementById("custom_button");
                custom_button.onclick = function (data) {
                    //console.log("=== Custom Button Clicked ");
                                       
                    let selected = document.querySelectorAll(".selected");
                    //
                    // for each selected item put it's index into the indexArray
                    //
                    let indexArray = [];
                    selected.forEach((item) => {
                        let temp = item.id.split("_");
                        indexArray.push(parseInt(temp[1]));
                    });

                    if (pageStack.length > 0) {
                        let temp = pageStack.pop();
                        temp[3] = scrollNode.scrollTop;
                        pageStack.push(temp);
                    };

                    edit(indexArray, currentItems, false, true);

                    return;
                };

                //-------------------------------------------------------------
                // filter button
                //
                filter_button = document.getElementById("filter_button");
                filter_button.onclick = function (data) {
                    //console.log("=== Filter Button Clicked ");

                    emby_filters();
                    return;
                };

                //-------------------------------------------------------------
                // prev page button
                //
                prev_button = document.getElementById("prev_page_btn");
                prev_button.onclick = function (data) {
                    let scrollPosition = 0;
                    showWithTag = 0;
                    showWithGenre = 0;
                    filter_selectedIndex = [];  // used to save and restore filter selections
                    filter_string = "";

                    loader.classList.remove("loader-hidden");  // show the spinner

                    if (pageStack.length > 0) {
                        let temp = pageStack[pageStack.length - 1];
                        //console.log("=== prev page btn = ", temp);
                        scrollPosition = temp[3];
                    };

                    if (pageStack.length > 0) pageStack.pop();

                    if (pageStack.length > 0) {
                        let temp = pageStack.pop();
                        let url            = temp[0];
                        let dimensions     = temp[1];
                        let name           = temp[2].Name;
                      //let scrollPosition = temp[3];
                        let pageType       = getType(temp[2]);

                        //console.log("=== prev page btn - url = " + url + ", ScrollPosition = ", scrollPosition);

                        hide_and_show_buttons(3);
                        getPage(url, dimensions, name, scrollPosition, pageType);
                        return;
                    } else {
                        //console.log("=== go home");
                        goHome();
                        return;
                    };
                };

                //-------------------------------------------------------------
                // edit button
                //
                edit_button = document.getElementById("edit_btn");
                edit_button.onclick = function (data) {
                    //console.log("=== Edit Button Clicked ");

                    let selected = document.querySelectorAll(".selected");
                    //
                    // for each selected item put it's index into the indexArray
                    //
                    let indexArray = [];
                    selected.forEach((item) => {
                        let temp = item.id.split("_");
                        indexArray.push( parseInt( temp[1] ) );
                    });
                    if (pageStack.length > 0) {
                        let temp = pageStack.pop();
                        temp[3] = scrollNode.scrollTop;
                        pageStack.push(temp);
                    };
                    //..............................................
                    if (indexArray.length == 0) return;

                    let t = currentItems[indexArray[0]];
                    //console.log("=== t = ", t);
                    if (t.Type == "TvChannel") {
                        console.log("=== Edit Tv Channel ===");
                        editTvChannel(indexArray, currentItems, false);
                        return;
                    };
                    //..............................................
                    edit(indexArray, currentItems, false, false);
                };

                //-------------------------------------------------------------
                // bulk button
                //
                bulk_button = document.getElementById("bulk_btn");
                bulk_button.onclick = function (data) {
                    //console.log("=== Bulk Button Clicked ");

                    let selected = document.querySelectorAll(".selected");
                    //
                    // for each selected item put it's index into the indexArray
                    //
                    let indexArray = [];
                    selected.forEach((item) => {
                        let temp = item.id.split("_");
                        indexArray.push( parseInt( temp[1] ) );
                    });
                    if (pageStack.length > 0) {
                        let temp = pageStack.pop();
                        temp[3] = scrollNode.scrollTop;
                        pageStack.push(temp);
                    };
                    //..............................................
                    if (indexArray.length == 0) return;

                    let t = currentItems[indexArray[0]];
                    //console.log("=== t = ", t);
                    if (t.Type == "TvChannel") {
                        console.log("=== Bulk Tv Channel ===");
                        editTvChannel(indexArray, currentItems, true);
                        return;
                    };
                    //..............................................
                    edit(indexArray, currentItems, true, false);
                };

                //-------------------------------------------------------------
                // clear button
                //
                clear_button = document.getElementById("clear_btn");
                clear_button.onclick = function (data) {
                    selected_items = [];
                    selected = [];

                    hide_and_show_buttons(3);

                    if (pageStack.length > 0) {
                        let temp = pageStack[pageStack.length - 1];
                        let url            = temp[0];
                        let dimensions     = temp[1];
                        let name           = temp[2].Name;
                        let scrollPosition = temp[3];
                        let pageType       = getType(temp[2]);

                        getPage(url, dimensions, name, scrollPosition, pageType);
                    } else {
                        goHome();
                    };
                };
                //-------------------------------------------------------------

                pageNode   = document.getElementById("page_node");
                scrollNode = document.getElementById("scroll_div");

                topPageTitleArea = document.getElementById("topPageTitleArea");


                //---------------------------------------------------------------------
                // this code demonstrates how methods in another JS file can be
                // accessed. The other file was assigned the name "customFiltersPageJS"
                //---------------------------------------------------------------------
                require([Dashboard.getConfigurationResourceUrl('customFiltersPageJS')], (customFilters) => {

                    //use "Custom Filters JS" code to access methods.

                    //console.log("=== customFilters = ", customFilters);
                    //console.log("=== type of customFilters = ", typeof customFilters);

                    var t = customFilters();

                    //console.log("=== t = ", t);
                    //console.log("=== type of t = ", typeof t);

                    t(100);      // run this method from 'customFiltersPageJS'
                });
                //---------------------------------------------------------------------
                //---------------------------------------------------------------------

                loading.hide();  // hide the emby spinner
            });
        };
    });

    //
    // some useful apiClient methods
    //
    // updateItem(item)
    // updateFavoriteStatus(userId, itemId, isFavorite)
    // markPlayed(userId,itemId, date)
    // markUnplayed(userId,itemId)
    // getItemImageInfos(itemId)
    // uploadItemImage(itemId,imageType,file)
    // deleteItemImage(itemId, imageType, imageIndex)
    // getParentalRatings() 
    //

    //
    //async function getUsers() {
    //    return await ApiClient.getJSON(ApiClient.getUrl('Users'));
    //}

    //async function getUser(id) {
    //    return await ApiClient.getJSON(ApiClient.getUrl('Users/' + id));
    //}

    //let isAdmin = false;
    //async function getCurrentUserId() {
    //    let myPromise = new Promise(function (resolve) {
    //        resolve(ApiClient.getCurrentUserId());
    //    });
    //    currentId = await myPromise;
    //    console.log("Current User Id:", currentId);
    //    getCurrentUserDto(currentId);
    //}

    //async function getCurrentUserDto(id) {
    //    await getUser(id)
    //        .then(UserPolicy)
    //        .catch((error) => {
    //            console.log('ERROR: ', error);
    //        });
    //}

    //async function UserPolicy(data) {
    //    let currentUserInfo = data.Policy;
    //    userPolicy = data.Policy;
    //    console.log("IsAdmin: ", currentUserInfo.IsAdministrator);
    //    if (currentUserInfo.IsAdministrator === true) {
    //        isAdmin = true;
    //    }
    //}
    //
